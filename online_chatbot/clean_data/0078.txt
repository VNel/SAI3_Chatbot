1 Real-Time Detection of Hybrid and Stealthy Cyber-Attacks in Smart Grid Mehmet Necip Kurt, Yasin YÄ±lmaz, Member, IEEE, and Xiaodong Wang, Fellow, IEEE Abstract For a safe and reliable operation of the smart grid, timely detection of cyber-attacks is of critical importance. Moreover, considering smarter and more capable attackers, robust detection mechanisms are needed against a diverse range of cyber-attacks. With these purposes, we propose a robust online detection algorithm for (possibly combined) false data injection (FDI) and jamming attacks, that also provides online estimates of the unknown and time-varying attack parameters and recovered state estimates. Further, considering smarter attackers that are capable of designing stealthy attacks to prevent the detection or to increase the detection delay of the proposed algorithm, we propose additional countermeasures. Numerical studies illustrate the quick and reliable response of the proposed detection mechanisms against hybrid and stealthy cyber-attacks. Index Terms Smart grid, Kalman ï¬lter, quickest detection, cumulative sum (CUSUM), online estimation, state recovery, false data injection attack, jamming attack, hybrid attack, stealthy attack, Shewhart test, chi-squared test. I. INTRODUCTION A. A Brief Overview of Cyber-Attacks and Countermeasures in Smart Grid Due to the integration of advanced signal processing, communication, and control technologies, smart grid relies on a critical cyber infrastructure that is subject to adversarial cyber threats [1]â€“[4]. The smart grid is regulated based on estimated system states and the main aim of attackers is to damage/mislead the state estimation mechanism and thereby to cause wrong/manipulated decisions in the energy management system of the smart grid. Some potential consequences of a successful cyber-attack are regional power blackouts, manipulated electricity market prices [5], [6], and destabilization of the power grid [7]. Such cyber-attacks are also seen in practice. For instance, on December 23, 2015, the Ukrainian power system was attacked and the resulting power blackout affected around 200,000 people for several hours [8]. The Ukraine attack has demonstrated that attackers have more capabilities than predicted [8]. Namely, (i) attackers can access and monitor the power system over long periods of time without being detected, (ii) attackers are able to perform cyber-attacks by hacking smart grid components (smart meters, control centers, etc.), manipulating/jamming the network communication channels, and accessing and manipulating the database of the control center [2], [8], [9]. Hence, cyber-attacks signiï¬cantly This work was supported in part by the U.S. National Science Foundation (NSF) under Grant ECCS-1405327, and in part by the U.S. Ofï¬ce of Naval Research under Grant N000141410667. The work of Y. YÄ±lmaz was supported in part by the NSF under Grant CNS-1737598 and in part by the Southeastern Center for Electrical Engineering Education. M. N. Kurt and X. Wang are with the Department of Electrical Engineering, Columbia University, New York, NY 10027, USA (e-mail: m.n.kurt@columbia.edu; wangx@ee.columbia.edu). Y. YÄ±lmaz is with the Department of Electrical Engineering, University of South Florida, Tampa, FL 33620, USA (e-mail: yasiny@usf.edu). arXiv:1803.00128v2 [cs.IT] 28 Jun 2018 2 threaten the safe and reliable operation of the power grid in practice. Effective countermeasures need to be developed considering the worst-case scenarios where the attackers are fully capable of performing a diverse range of cyber-attacks. The ï¬rst step in a defense mechanism is early detection of cyber-attacks. After detecting an attack, effective mitigation schemes should then be implemented. Recently, the false data injection (FDI) attacks [2], [10]â€“[12] and the jamming attacks [9], [13]â€“[15] against the smart grid are extensively studied in the literature and several detectors are proposed. The proposed detectors are mostly outlier detectors, i.e., they classify a sample measurement as either normal or anomalous. Conventional detectors classify a measurement as anomalous if the measurement residual exceeds a certain threshold [10], [16]â€“[19]. More advanced machine learning techniques are also considered for classiï¬cation of anomalous measurements [20], [21]. Moreover, in [12], ï¬rstly a Markov graph model for system states is learned under normal system operation and then attacks/anomalies are detected based on the consistency of new measurements compared to the learned nominal model. Further, in [22], based on the least squares (LS) state estimator, a multi-step procedure is presented to detect and classify cyber-attacks on meter measurements, network line parameters, and network topology, and then to make corrections for attack mitigation. In [23]â€“[25], robust extended Kalman ï¬lters have been proposed where the main aim is to bound the effects of outliers on the state estimation mechanism. No speciï¬c attack types are considered so that using such schemes, it is not possible to distinguish a real attack from random outliers, e.g., due to heavy-tailed non-Gaussian noise processes. Moreover, such schemes have breakdown points such that if outliers, signiï¬cantly far away from the nominal measurements, are observed, then the proposed ï¬lters fail to keep track of the system state. In order to improve the time resolution and also to detect cyber-attacks more reliably, several online detectors based on the quickest detection theory are proposed. For instance, in [26] and [27], cumulative sum (CUSUM)-based schemes are considered to detect FDI attacks where the state estimation is based on the conventional LS methods. More recently, in [28], CUSUM-based detection schemes are proposed to detect FDI and denial of service (DoS) attacks (separately) in a dynamic setting and their advantages over the outlier detectors and the LS-based detectors are demonstrated. Further, in [29], a nonparametric CUSUM detector is proposed that do not assume any attack model and only evaluates the deviation of meter measurements from the baseline statistics, i.e., normal system operation. In [30], a window-based CUSUM detector is proposed for detection of FDI attacks where the attack parameters of interest are estimated based on the most recent sliding window of measurements. B. Contributions In this paper, we propose robust mechanisms for timely detection of potentially combined and stealthily designed FDI and jamming attacks. The proposed mechanisms are tightly connected to an estimation mechanism, which makes both the detection and state estimation schemes robust against unknown and time-varying attack variables. In particular, online maximum likelihood estimates (MLEs) of the attack types, set of attacked meters, and the attack magnitudes are used in attack detection. Moreover, recovered state estimates are computed based on the online MLE estimates of the attack variables. No restrictive assumptions are made about an attackerâ€™s strategy, i.e., an attacker can design and perform arbitrarily combined FDI and jamming attacks, targeting any subset of meters in any magnitude and can also change its attack parameters over time. Further, considering the 3 possibility of smarter and more capable attackers, additional countermeasures are proposed against stealthily designed cyber- attacks. These make the proposed detection schemes highly robust against a signiï¬cantly wide range of potential cyber-attacks targeting the smart grid. Since the smart grid is a highly complex network, any anomaly/failure in a part of the system can quickly spread over the network and lead to new unpredicted failures. Hence, timely attack detection and mitigation is crucial. In this paper, for timely detection, we present real-time detection mechanisms. Moreover, to help for timely attack mitigation and quick system recovery, we provide online estimates of the attack types, set of attacked meters and attack magnitudes. Note that having an estimate for the attack type can be useful since different countermeasures may need to be employed against different types of attacks. Further, considering that the real power grid is a huge network consisting of many meters, an estimate of the attacked meters can be critical for a timely and effective attack mitigation, e.g., via isolating the attacked meters during the recovery procedure. Moreover, estimates of attack magnitudes are needed to recover attack-free states. We list our main contributions as follows: â€¢ A novel low-complexity online detection and estimation algorithm is proposed against (possibly) combined FDI and jamming attacks. The proposed algorithm is robust to unknown and time-varying attack types, magnitudes, and set of attacked meters. Further, recovered state estimates and closed-form online MLE estimates of the attack variables are presented. â€¢ Stealthy attacks against CUSUM-based detectors and particularly against the proposed algorithm are introduced and analyzed. â€¢ Several countermeasures are proposed against the considered stealthy attacks. C. Organization The remainder of the paper is organized as follows. In Sec. II, the system model, attack models, state estimation mechanism, and the problem formulation are presented. In Sec. III, an online cyber-attack detection and estimation algorithm is presented. In Sec. IV, stealthy attacks against CUSUM-based detectors are introduced and analyzed. Also, countermeasures against the considered stealthy attacks are presented. In Sec. V, the proposed detection schemes are evaluated extensively via simulations. Finally, the paper is concluded in Sec. VI. Boldface letters denote vectors and matrices, and all vectors are column vectors. II. SYSTEM MODEL AND PROBLEM FORMULATION A. System Model The actual power grid is regulated based on a nonlinear AC power ï¬‚ow model [2]. On the other hand, the approximate linearized (around an operating point) DC power ï¬‚ow model is a good approximation that is widely used in the literature to describe the operation of the power grid [10], [16], [31]. Furthermore, static system model and consequently conventional static (LS) state estimation are not effective in capturing the dynamics of a power system due to time-varying load and power generation [11]. In addition, attack detection mechanisms based on static estimators are not effective in detecting time-varying 4 cyber-attacks and structured â€œstealthâ€ FDI attacks [10], for which dynamic state estimator-based detectors are known to be effective [28], [32]. We then model the power grid, consisting of N + 1 buses and K meters, as a discrete-time linear dynamic system based on the commonly employed linear DC model [10], [16], [31] as follows: xt = Axtâˆ’1 + vt, (1) yt = Hxt + wt, (2) where xt = [x1,t, x2,t, . . . , xN,t]T is the state vector denoting the phase angles of N buses (one of the buses is considered as a reference bus), A âˆˆRNÃ—N is the state transition matrix, vt = [v1,t, v2,t, . . . , vN,t]T âˆ¼N(0, Ïƒ2 v IN) is the process noise vector, IN is an N Ã— N identity matrix, and Â·T is the transpose operator. Further, yt = [yT 1,t, yT 2,t, . . . , yT K,t]T is the vector consisting of meter measurements, yk,t = [yk,t,1, yk,t,2, . . . , yk,t,Î»]T is the measurement vector for meter k, H âˆˆRKÎ»Ã—N is the measurement matrix, wt = [wT 1,t, wT 2,t, . . . , wT K,t]T âˆ¼N(0, Ïƒ2 w IKÎ») is the measurement noise vector, and wk,t = [wk,t,1, wk,t,2, . . . , wk,t,Î»]T is the measurement noise vector for meter k. Note that in each time interval between t âˆ’1 and t, Î» âˆˆ{1, 2, 3, . . . } measurements are taken at each meter, where Î» is usually small, and the collected measurements between t âˆ’1 and t are processed at time t. To increase the measurement redundancy against noise and also to estimate the unknown attack parameters more reliably in case of a cyber-attack, Î» needs to be chosen higher. In general, the state transition and measurement matrices can also be dynamic. For instance, due to changes in network topology, i.e., on and off states of the switches and line breakers in the power grid, the measurement matrix may vary over time. In that case, instead of modeling the smart grid as a linear time-invariant system as in (1) and (2), we can model it as a linear time-varying system where we can replace A and H by At and Ht, respectively. The results presented in this study can be generalized to the case of linear time-varying system model as long as At and Ht are known by the system controller at each time t. B. Attack Models We assume that at an unknown time Ï„, a cyber-attack is launched to the system, where we particularly consider FDI attacks, jamming attacks, and their combination. The attack types, attack magnitudes, and the set of attacked meters can be time-varying. But, during a time interval, i.e., between t âˆ’1 and t, we assume that the attack parameters stay constant. Next, we explain the attack models under consideration. 1) FDI Attack: In case of an FDI attack, additive malicious data are injected into the measurements of a subset of meters. In practice, an FDI attack can be performed by manipulating the network communication channels or hacking meters and/or control centers in the smart grid [2], [8]. The measurement model in case of an FDI attack takes the following form: yt = Hxt + at + wt, t â‰¥Ï„, (3) where at = [aT 1,t, aT 2,t, . . . , aT K,t]T denotes the injected false data at time t. Since the attack magnitudes are assumed to be constant between t âˆ’1 and t, for meter k, ak,t = 1Î»Ã—1 ak,t, where 1Î»Ã—1 is a Î» Ã— 1 vector consisting of 1s. Note that if meter 5 k is not under an FDI attack at time t, then ak,t = 0, otherwise ak,t Ì¸= 0. 2) Jamming Attack: In case of a jamming attack, we assume that the attacker constantly emits additive white Gaussian noise (AWGN) to the network communication channels to compromise a subset of meter measurements. We consider jamming with AWGN since (i) it is a commonly employed jamming model in the literature [33], [34], (ii) it is a simple attacking strategy to perform, and (iii) in an additive noise channel with Gaussian input, for a given mean and variance, among all noise distributions, the Gaussian noise maximizes the mean squared error of estimating the channel input given the channel output [34], [35]. Hence, an attacker can jam the communication channels with AWGN to maximize its damage on the state estimation mechanism. In case of a jamming attack, the measurement model can be written as follows: yt = Hxt + wt + nt, t â‰¥Ï„, (4) where nt = [nT 1,t, nT 2,t, . . . , nT K,t]T âˆ¼N(0, diag(Ïƒt)) denotes the jamming noise, Ïƒt = [ÏƒT 1,t,ÏƒT 2,t, . . . ,ÏƒT K,t]T, and Ïƒk,t = 1Î»Ã—1 Ïƒ2 k,t where Ïƒ2 k,t is the variance of the jamming noise targeting meter k at time t. If meter k is not under a jamming attack at time t, then Ïƒ2 k,t = 0, otherwise Ïƒ2 k,t > 0. 3) Hybrid Attack: In case of a hybrid (combined) attack, FDI and jamming attacks are simultaneously launched to the system and hence the measurement model takes the following form: yt = Hxt + at + wt + nt, t â‰¥Ï„. (5) For meter k under both FDI and jamming attacks at time t, ak,t Ì¸= 0 and Ïƒ2 k,t > 0. Since the FDI and jamming attacks can be considered as special cases of hybrid attacks, we consider (5) as the measurement model under the attacking regime, i.e., for t â‰¥Ï„. Remark 1: If the noise terms in the normal system operation are AWGN (as in (1) and (2)) and the jamming noise terms are mutually independent over the meters, then the considered hybrid FDI/jamming attacks span all possible data attacks. This is due to the fact that a Gaussian random variable is deï¬ned by its mean and variance, and through the hybrid attacks, mean and variance of the density of meter measurements can be arbitrarily changed (cf. (5)). For instance, in case of a DoS attack, meter measurements are blocked and only a random or zero signal is received at the control center [9], [13], [14]. Hence, the DoS attack can be considered as a special case of the hybrid cyber-attacks, i.e., a DoS attack can either be equivalent to an FDI attack with false data being in the same magnitude of the actual signal but with an opposite sign or a jamming attack with high level noise variances such that the actual signal can be neglected compared to the noise signal [28]. On the other hand, if the jamming noise is correlated over the meters or it is not normally distributed, then such an attack does not comply with the considered jamming attack model in (4) and nor with (5). For such cases, we consider a non-parametric goodness-of-ï¬t test as a countermeasure (see Sec. IV-C.2). 6 C. Pre- and Post-Attack Measurement Densities Let H = [HT 1 , HT 2 , . . . , HT K]T where Hk âˆˆRÎ»Ã—N is the measurement matrix for meter k. Since the measurement matrix is determined based on the system topology, the rows of Hk are identical, i.e., Hk = 1Î»Ã—1 hT k , where hT k is a row of Hk. Based on the considered post-attack model in (5), a measurement obtained at meter k during the time interval between t âˆ’1 and t, i.e., yk,t,i, k âˆˆ{1, 2, . . . , K}, i âˆˆ{1, 2, . . . , Î»} can be written as yk,t,i = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ hT k xt + wk,t,i, if k âˆˆS0 t hT k xt + ak,t + wk,t,i, if k âˆˆSf t hT k xt + wk,t,i + nk,t,i, if k âˆˆSj t hT k xt + ak,t + wk,t,i + nk,t,i, if k âˆˆSf,j t , t â‰¥Ï„, (6) where S0 t is the set of non-attacked meters, Sf t is the set of meters under only FDI attack, Sj t is the set of meters under only jamming attack, and Sf,j t is the set of meters under both FDI and jamming attacks at time t â‰¥Ï„. Note that S0 t , Sf t , Sj t , and Sf,j t are disjoint sets and S0 t âˆªSf t âˆªSj t âˆªSf,j t = {1, 2, . . . , K}. Then, the probability density functions (pdfs) of the measurements in the pre- and post-attack regimes take respectively the following forms âˆ€i âˆˆ{1, 2, . . . , Î»}: yk,t,i âˆ¼N(hT k xt, Ïƒ2 w), âˆ€k âˆˆ{1, 2, . . . , K}, t < Ï„, (7) and yk,t,i âˆ¼ ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ N(hT k xt, Ïƒ2 w), âˆ€k âˆˆS0 t N(hT k xt + ak,t, Ïƒ2 w), âˆ€k âˆˆSf t N(hT k xt, Ïƒ2 w + Ïƒ2 k,t), âˆ€k âˆˆSj t N(hT k xt + ak,t, Ïƒ2 w + Ïƒ2 k,t), âˆ€k âˆˆSf,j t , t â‰¥Ï„. (8) D. State Estimation Since the smart grid is modeled as a discrete-time linear dynamic system with the Gaussian noise terms (cf. (1) and (2)), the Kalman ï¬lter is the optimal linear estimator in minimizing the mean squared state estimation error [36]. Further, since the measurement models for the pre- and post-attack periods are different (cf. (7) and (8)), two Kalman ï¬lters need to be simultaneously employed: one for assuming no attack occurs at all and one for assuming an attack occurs at an unknown time Ï„. Since the latter involves the unknown change-point Ï„ and the unknown attack parameters at and Ïƒt, estimates of these unknowns are needed to employ the corresponding Kalman ï¬lter. As we will explain later, Ï„ is estimated by the detection algorithm, at and Ïƒt are estimated via the maximum likelihood (ML) estimation. The Kalman ï¬lter is an iterative real-time estimator composed of prediction and measurement update steps at each iteration. Let the Kalman ï¬lter estimates for the pre- and post-attack cases be denoted with Ë†x0 t|tâ€² and Ë†x1 t|tâ€², respectively where tâ€² = t âˆ’1 7 and tâ€² = t for the prediction and measurement update steps at time t, respectively. The Kalman ï¬lter equations at time t are then given as follows: Pre-attack â€“ Prediction: Ë†x0 t|tâˆ’1 = AË†x0 tâˆ’1|tâˆ’1, P0 t|tâˆ’1 = AP0 tâˆ’1|tâˆ’1AT + Ïƒ2 v IN, (9) Pre-attack â€“ Measurement update: G0 t = P0 t|tâˆ’1HT(HP0 t|tâˆ’1HT + Ïƒ2 w IKÎ»)âˆ’1, Ë†x0 t|t = Ë†x0 t|tâˆ’1 + G0 t(yt âˆ’HË†x0 t|tâˆ’1), P0 t|t = P0 t|tâˆ’1 âˆ’G0 tHP0 t|tâˆ’1, (10) Post-attack â€“ Prediction: Ë†x1 t|tâˆ’1 = AË†x1 tâˆ’1|tâˆ’1, P1 t|tâˆ’1 = AP1 tâˆ’1|tâˆ’1AT + Ïƒ2 v IN, (11) Post-attack â€“ Measurement update: G1 t = P1 t|tâˆ’1HT(HP1 t|tâˆ’1HT + Ïƒ2 w IKÎ» + diag(Ë†Ïƒt))âˆ’1, Ë†x1 t|t = Ë†x1 t|tâˆ’1 + G1 t(yt âˆ’HË†x1 t|tâˆ’1 âˆ’Ë†at), P1 t|t = P1 t|tâˆ’1 âˆ’G1 tHP1 t|tâˆ’1, (12) where P0 t|tâ€² and P1 t|tâ€² denote the estimates of the state covariance matrix at time t, and G0 t and G1 t denote the Kalman gain matrices at time t for the pre- and post-attack cases, respectively. Note that the MLE estimates of the attack parameters are used in the measurement update step of the Kalman ï¬lter for the post-attack case, where Ë†at is the MLE of at (cf. (26)) and Ë†Ïƒt is the MLE of Ïƒt (cf. (27)). Hence, Ë†x1 t|tâˆ’1 and Ë†x1 t|t are, in fact, recovered state estimates in case of a cyber-attack. Note, however, that ML estimation errors may lead to errors in computing the recovered state estimates. E. Problem Formulation Our objective is detecting cyber-attacks in a timely and reliable manner and the quickest detection theory [37]â€“[39] is well suited to this objective. In the quickest change detection problems, measurements become available sequentially over time and at each time, either a change is declared or further measurements are taken in the next time interval, where the aim is to optimally balance the detection delay and the false alarm rate. There are two main approaches in the quickest detection theory, namely Bayesian and non-Bayesian. In a Bayesian setting, the change point Ï„ is considered as a random variable with a known a priori distribution whereas in a non-Bayesian setting, the change point is considered as non-random and unknown. Our problem better ï¬ts to the non-Bayesian setting since we do not assume any a priori knowledge about the change-point Ï„. 8 Then, we consider the following objective function, proposed by Lorden [40]: d(T) = sup Ï„ ess sup FÏ„ EÏ„  (T âˆ’Ï„)+ |FÏ„  , (13) where T is the stopping time at which an attack is declared, FÏ„ denotes all measurements obtained up to time Ï„, and Ej is the expectation under Pj, that is the probability measure if the change occurs at time j. Note that d(T) is called the worst- case average detection delay since it is maximized over the change point and also over all measurements obtained up to the change-point. We then consider the following minimax optimization problem: inf T d(T) subject to Eâˆ[T] â‰¥Î±, (14) where Eâˆ[T] is called the average false alarm period, i.e., average stopping time when no change occurs at all (Ï„ = âˆ), and Î± is a prespeciï¬ed lower bound for Eâˆ[T]. Let the pre- and post-attack measurement pdfs given in (7) and (8) be denoted with p0(yt|xt) and p1(yt|xt, at,Ïƒt), respectively. Since the dynamic system state xt is not directly observed and the attack parameters at and Ïƒt are completely determined by an attacker and hence unknown, both pdfs are unknown and time-varying. If the pre- and post-attack pdfs would be exactly known, then the well-known CUSUM algorithm would be the optimal solution to (14) [41]. Nonetheless, the system state can be inferred using the Kalman ï¬lters and the MLEs of the unknown attack parameters can be computed. Then, following a generalized likelihood ratio approach [38, Sec. 5.3], [26], [28] and replacing the unknowns with their estimates, a generalized CUSUM algorithm can be used as a solution to (14). In this paper, in addition to early attack detection, we also aim to recover the attack-free system states. Notice that in case of no attack, i.e., for t < Ï„, the Kalman ï¬lter for the pre-attack case (assuming no attack at all) is the optimal state estimator. However, after an attack occurs, the measurement model assumed in the pre-attack period (cf. (2)) is no longer true. Hence, the state estimates for the pre-attack case, i.e., Ë†x0 t|tâˆ’1 and Ë†x0 t|t, deviate from the actual system state xt for t â‰¥Ï„. Recalling that an attack occurs at an unknown time Ï„ and the measurements follow the post-attack measurement model (cf. (5)) for t â‰¥Ï„, if the attack launch time Ï„ and the attack magnitudes at and Ïƒt would be exactly known, then the system state would be perfectly recovered for t â‰¥Ï„. Nonetheless, as we will explain more clearly in the next section, the (generalized) CUSUM algorithm always keeps a change-point estimate Ë†Ï„ in its memory and updates this estimate as the measurements become sequentially available over time [38, Sec. 2.2]. When an attack is declared at the stopping time T, Ë†Ï„ becomes the ï¬nal change-point estimate of the (generalized) CUSUM algorithm. Furthermore, the MLEs of the attack magnitudes, i.e., Ë†at and Ë†Ïƒt, can be computed at each time t. Then, employing a Kalman ï¬lter for the post-attack case (cf. (11) and (12)) and computing the state estimates using the MLEs of the attack parameters in the measurement update step, recovered state estimates, i.e., Ë†x1 t|tâˆ’1 and Ë†x1 t|t, can be obtained for Ë†Ï„ â‰¤t â‰¤T. III. ONLINE ATTACK DETECTION AND ESTIMATION Since it is hard to distinguish noise from FDI/jamming attacks with small magnitudes, some minimum levels for the attack magnitudes need to be deï¬ned in order to control the false alarm level of a detection algorithm. We then deï¬ne the change 9 event of interest as follows: |ak,t| â‰¥Î³, âˆ€k âˆˆSf t , t â‰¥Ï„, Ïƒ2 k,t â‰¥Ïƒ2, âˆ€k âˆˆSj t , t â‰¥Ï„, |ak,t| â‰¥Î³ & Ïƒ2 k,t â‰¥Ïƒ2, âˆ€k âˆˆSf,j t , t â‰¥Ï„, (15) where Î³ and Ïƒ2 are the smallest attack magnitudes of interest for |ak,t| and Ïƒ2 k,t, respectively. Note that, in general, an attacker can arbitrarily choose its attack parameters, i.e., Î³ and Ïƒ2 do not restrict an attackerâ€™s strategy. In fact, attackers usually do not know such parameters. On the other hand, smarter attackers may exploit such lower bounds on the attack magnitudes in order to perform stealthy attacks with small attack magnitudes (see Sec. IV-B). The generalized CUSUM algorithm can then be written as follows: T = inf  m âˆˆN : max 1â‰¤jâ‰¤m m X t=j sup S0 t ,Sf t ,Sj t ,Sf,j t log sup|ak,t|â‰¥Î³, k âˆˆSf t âˆªSf,j t supÏƒ2 k,tâ‰¥Ïƒ2, k âˆˆSj t âˆªSf,j t p1(yt | Ë†x1 t, at,Ïƒt) p0(yt|Ë†x0 t) | {z } Î²t | {z } gm â‰¥h  , (16) where Ë†x0 t and Ë†x1 t denote the state estimates for the pre- and post-attack cases, respectively, gm is the decision statistic at time m, h is the test threshold, and Î²t is the generalized log-likelihood ratio (GLLR) calculated at time t. Based on (16), the decision statistic can be recursively updated at each time t as gt â†max{0, gtâˆ’1 + Î²t}, where g0 = 0 [38, Sec. 2.2]. Note that whenever gt reaches zero, the (generalized) CUSUM algorithm updates its change-point estimate Ë†Ï„ to the current time t, where the initial change-point estimate is Ë†Ï„ = 1 [38, Sec. 2.2]. That is, when gt â†0, we have Ë†Ï„ â†t. Recall that the Kalman ï¬lter for the post-attack case is employed assuming the normal measurement model (cf. (2)) up to the unknown change-point Ï„. We then propose to employ the Kalman ï¬lter for the post-attack case based on the estimated change-point Ë†Ï„. Hence, whenever the change-point estimate is updated, the Kalman ï¬lter for the post-attack case needs also to be updated. Recall further that the Kalman ï¬lter for the pre-attack case is always employed based on the normal measurement model. Hence, whenever gt â†0, the Kalman ï¬lter estimates for the post-attack case are updated by setting them to the Kalman ï¬lter estimates for the pre-attack case, i.e., P1 t|t â†P0 t|t and Ë†x1 t|t â†Ë†x0 t|t. Assuming no attack, Ë†x0 t|t is the optimal state estimate at time t. Thus, we estimate xt by Ë†x0 t|t for the pre-attack case, i.e., Ë†x0 t â‰œË†x0 t|t. On the other hand, we estimate xt by Ë†x1 t|tâˆ’1 for the post-attack case, i.e., Ë†x1 t â‰œË†x1 t|tâˆ’1. This is because the measurement update step of the Kalman ï¬lter for the post-attack case and hence Ë†x1 t|t depends on estimates of the unknown attack variables (cf. (12)), and effects of the attack parameters at and Ïƒt at time t on Ë†x1 t need to be blocked to be able to compute the MLEs of the attack parameters in closed form (cf. numerator in (16)). Note that Ë†x1 t|tâˆ’1 is computed based on the measurements up to time t âˆ’1, thus Ë†x1 t|tâˆ’1 is independent of the attack parameters at time t. At ï¬rst, it may seem unfair that we use the state estimate of the measurement update step, i.e., Ë†x0 t|t, for the pre-attack case, and the state prediction, i.e., Ë†x1 t|tâˆ’1, for the post-attack case. However, it essentially improves the performance of the proposed detection scheme due to the following reasons: (i) in case of no attack, we favor p0(yt|Ë†x0 t) over p1(yt | Ë†x1 t, at,Ïƒt) and hence 10 decrease the false alarm level of the proposed detection scheme, (ii) in case of an attack, since the state estimates for the post-attack case are recovered whereas the state estimates for the pre-attack case do not have a recovery mechanism, detection delays are not expected to increase. Furthermore, based on (16), the following proposition presents the GLLR at time t and the MLEs of the attack variables for the time interval between t âˆ’1 and t. Proposition 1: Let ek,t,i â‰œyk,t,i âˆ’hT k Ë†x1 t and ek,t â‰œ[ek,t,1, ek,t,2, . . . , ek,t,Î»]T. Moreover, let Î´k,t â‰œPÎ» i=1 ek,t,i, Î¶k,t â‰œ PÎ» i=1 e2 k,t,i, Ï±k,t â‰œPÎ» i=1(ek,t,i + Î³)2, and Ï–k,t â‰œPÎ» i=1(ek,t,i âˆ’Î³)2, âˆ€k âˆˆ{1, 2, . . . , K}, âˆ€t > 0. The most likely subset of meters under no attack, under only FDI attack, under only jamming attack, and under both FDI and jamming attacks during the time interval between t âˆ’1 and t are classiï¬ed, respectively as Ë†S0 t = n k : u0(ek,t) â‰¤uf(ek,t), u0(ek,t) â‰¤uj(ek,t), u0(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o , (17) Ë†Sf t = n k : uf(ek,t) < u0(ek,t), uf(ek,t) â‰¤uj(ek,t), uf(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o , (18) Ë†Sj t = n k : uj(ek,t) < u0(ek,t), uj(ek,t) < uf(ek,t), uj(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o , (19) Ë†Sf,j t = n k : uf,j(ek,t) < u0(ek,t), uf,j(ek,t) < uf(ek,t), uf,j(ek,t) < uj(ek,t), k = 1, 2, . . . , K o , (20) and the GLLR at time t is computed as Î²t = KÎ» 2 log(Ïƒ2 w) + 1 2Ïƒ2w K X k=1 Î» X i=1 (yk,t,i âˆ’hT k Ë†x0 t)2 âˆ’1 2  X kâˆˆË† S0 t u0(ek,t) + X kâˆˆË† Sf t uf(ek,t) + X kâˆˆË† Sj t uj(ek,t) + X kâˆˆË† Sf,j t uf,j(ek,t)  , (21) where u0(ek,t) â‰œÎ» log(Ïƒ2 w) + Î¶k,t Ïƒ2w , (22) uf(ek,t) â‰œ ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ Î» log(Ïƒ2 w) + 1 Ïƒ2w PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2, if | Î´k,t Î» | â‰¥Î³ Î» log(Ïƒ2 w) + Ï–k,t Ïƒ2 w , if 0 â‰¤Î´k,t Î» < Î³ Î» log(Ïƒ2 w) + Ï±k,t Ïƒ2 w , if âˆ’Î³ < Î´k,t Î» < 0, (23) uj(ek,t) â‰œ ï£± ï£´ ï£´ ï£² ï£´ ï£´ ï£³ Î» log( Î¶k,t Î» ) + Î», if Î¶k,t Î» â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + Î¶k,t Ïƒ2w+Ïƒ2 , if Î¶k,t Î» < Ïƒ2 w + Ïƒ2, (24) 11 and uf,j(ek,t) â‰œ ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ Î» log( 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2) + Î», if | Î´k,t Î» | â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2 â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + 1 Ïƒ2w+Ïƒ2 PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2, if | Î´k,t Î» | â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2 < Ïƒ2 w + Ïƒ2 Î» log( Ï–k,t Î» ) + Î», if 0 â‰¤Î´k,t Î» < Î³ and Ï–k,t Î» â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + Ï–k,t Ïƒ2w+Ïƒ2 , if 0 â‰¤Î´k,t Î» < Î³ and Ï–k,t Î» < Ïƒ2 w + Ïƒ2 Î» log( Ï±k,t Î» ) + Î», if âˆ’Î³ < Î´k,t Î» < 0 and Ï±k,t Î» â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + Ï±k,t Ïƒ2w+Ïƒ2 , if âˆ’Î³ < Î´k,t Î» < 0 and Ï±k,t Î» < Ïƒ2 w + Ïƒ2. (25) Furthermore, the MLEs of the attack magnitudes for meter k âˆˆ{1, 2, . . . , K} and for the interval between t âˆ’1 and t are determined as follows: Ë†ak,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ Î´k,t Î» , if | Î´k,t Î» | â‰¥Î³ and k âˆˆË†Sf t âˆªË†Sf,j t Î³, if 0 â‰¤Î´k,t Î» < Î³ and k âˆˆË†Sf t âˆªË†Sf,j t âˆ’Î³, if âˆ’Î³ < Î´k,t Î» < 0 and k âˆˆË†Sf t âˆªË†Sf,j t 0, if k âˆˆË†S0 t âˆªË†Sj t (26) and Ë†Ïƒ2 k,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ âˆ’Ïƒ2 w + Î¶k,t Î» , if Î¶k,t Î» â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sj t Ïƒ2, if Î¶k,t Î» < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sj t âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2, if | Î´k,t Î» | â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2 â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if | Î´k,t Î» | â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î´k,t Î» )2 < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t âˆ’Ïƒ2 w + Ï–k,t Î» , if 0 â‰¤Î´k,t Î» < Î³ and Ï–k,t Î» â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if 0 â‰¤Î´k,t Î» < Î³ and Ï–k,t Î» < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t âˆ’Ïƒ2 w + Ï±k,t Î» , if âˆ’Î³ < Î´k,t Î» < 0 and Ï±k,t Î» â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if âˆ’Î³ < Î´k,t Î» < 0 and Ï±k,t Î» < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t 0, if k âˆˆË†S0 t âˆªË†Sf t . (27) Proof: See Appendix A. The proposed online detection and estimation algorithm is summarized in Algorithm 1. At each time t, ï¬rstly the prediction step of the Kalman ï¬lters is implemented. Then, the most likely attack type (or no attack) and the attack parameters for each meter are determined. Based on the estimates of the attack variables, the measurement update step of the Kalman ï¬lters is implemented. Then, the GLLR is computed and the decision statistic is updated. If the decision statistic crosses the predetermined test threshold, then an attack is declared. Otherwise, it proceeds to the next time interval and further measurements are collected. Moreover, if the decision statistic reaches zero, the Kalman ï¬lter estimates for the post-attack 12 Algorithm 1 Real-time attack detection and estimation 1: Initialization: t â†0, g0 â†0, Ë†Ï„ â†1 2: while gt < h do 3: t â†t + 1 4: Implement the prediction step of the Kalman ï¬lters using (9) and (11). 5: Compute u0(ek,t), uf(ek,t), uj(ek,t), and uf,j(ek,t), âˆ€k âˆˆ{1, 2, . . . , K} using (22), (23), (24), and (25), respectively. 6: Classiï¬cation: compute Ë†S0 t , Ë†Sf t , Ë†Sj t , and Ë†Sf,j t using (17), (18), (19), and (20), respectively. 7: Compute Ë†at and Ë†Ïƒt using (26) and (27), respectively. 8: Implement the measurement update step of the Kalman ï¬lters using (10) and (12). 9: Compute Î²t using (21). 10: Update the decision statistic: gt â†max{0, gtâˆ’1 + Î²t} 11: if gt = 0 then 12: Ë†Ï„ â†t 13: Ë†x1 t|t â†Ë†x0 t|t 14: P1 t|t â†P0 t|t 15: end if 16: end while 17: T â†t, declare a cyber-attack. case are updated before proceeding to the next time interval. Recall that Algorithm 1 keeps a change point estimate Ë†Ï„. Hence, after an attack is declared at time T, to help for a quick system recovery, {Ë†x1 t|t : Ë†Ï„ â‰¤t â‰¤T} can be reported as the recovered state estimates and further, estimates of the attack types and the set of attacked meters can be reported for the time interval between Ë†Ï„ and T. Remark 2: The detector parameters Î³ and Ïƒ2 can be determined by the system designer based on the system requirements, i.e., the desired level of false alarm rate. The system designer ï¬rstly determines the desired minimum level of average false alarm period, i.e., Î±. If the frequency of false alarms needs to be decreased, then Î± is chosen higher. After choosing Î±, the system designer chooses the values of Î³, Ïƒ2, and the test threshold h in order to achieve an average false alarm period that is larger than or equal to Î±. For a higher level of Î±, higher values of Î³, Ïƒ2, and h need to be chosen. On the other hand, higher values of Î³, Ïƒ2, and h lead to larger detection delays. Hence, the system designer can choose such parameters to strike a desired balance between false alarm rate and the detection delays. IV. STEALTHY ATTACKS AND COUNTERMEASURES We ï¬rstly discuss stealthy attacks against a CUSUM detector, which can be employed in a simple case where the pre- and post-attack pdfs are known. Discussion on the stealthy attacks against a CUSUM detector is useful since similar forms of stealthy attacks can be performed against all CUSUM-based detectors. We then particularly discuss stealthy attacks against the proposed detector, i.e., Algorithm 1, where the pre- and post-attack pdfs are unknown and time-varying, as explained in Sec. III. Finally, we present some countermeasures against the considered stealthy attacks. A. Stealthy Attacks Against a CUSUM Detector Suppose the pre- and post-attack measurement pdfs are known and denoted with f0 and f1, respectively such that yt âˆ¼f0 for t < Ï„ and yt âˆ¼f1 for t â‰¥Ï„. In this case, the CUSUM algorithm is the optimum solution to (14) [41], given by TCUSUM = inf{t : gt â‰¥h}, gt = max{0, gtâˆ’1 + â„“t}, (28) 13 where TCUSUM denotes the stopping time, h is the test threshold, gt is the decision statistic at time t, and â„“t â‰œlog   f1(yt) f0(yt)  is the log-likelihood ratio (LLR) at time t. 1) Non-persistent attacks: The CUSUM algorithm is mainly designed for detecting persistent changes, i.e., it is assumed that an attack is launched at an unknown time Ï„ and continued thereafter. It accumulates evidence (LLR) over time and declares a change (attack/anomaly) only if the accumulated evidence is reliably high (cf. (28)). Hence, with the purpose of increasing the detection delay of the CUSUM algorithm, a smart attacker can design an on-off attacking strategy to perform an intermittent (non-persistent) attack. That is, it can attack for a period of time, then wait for a period of time and repeat this procedure over its attacking period with the aim of keeping the decision statistic of the CUSUM algorithm, i.e., gt, below the decision threshold h for t â‰¥Ï„ so that the attack can be continued without being noticed. Since the measurements yt are essentially random variables, an attacker cannot control the decision statistic deterministically; it can control it only on average. Note that attackers usually need simple and effective attacking strategies that require the minimum possible knowledge. Let KL(f1, f0) â‰œ R f1(y) log( f1(y) f0(y))dy denote the Kullback-Leibler (KL) divergence between f1 and f0. The following proposition presents a simple necessary condition for an attacker, having the knowledge of f0 and f1, to determine the on and off periods of a non-persistent stealthy attack against the CUSUM detector. Proposition 2: Let hâ€² â‰¥KL(f1, f0) be a threshold chosen by the attacker. The on and off periods have to be chosen as Ton â‰¤ hâ€² KL(f1, f0) and Toff > hâ€² KL(f0, f1) in order to satisfy E[gt] â‰¤hâ€² for t â‰¥Ï„, where Ton and Toff are positive integers denoting the on and off periods, respectively. Proof. We have E[gt] = E[max{0, gtâˆ’1 + â„“t}] â‰¥max{0, E[gtâˆ’1 + â„“t]} = max{0, E[gtâˆ’1] + E[â„“t]}, (29) where the inequality is due to the fact that gtâˆ’1 + â„“t can take negative values in general (âˆ’âˆ< â„“t < âˆ). If yt âˆ¼f1, then E[â„“t] = Z f1(y) log(f1(y) f0(y))dy = KL(f1, f0) > 0, and if yt âˆ¼f0, then E[â„“t] = Z f0(y) log(f1(y) f0(y))dy = âˆ’KL(f0, f1) < 0. Let Ït â‰œmax{0, E[gtâˆ’1] + E[â„“t]} (30) be a lower bound on E[gt] (cf. (29)). Since (i) gt = 0 at t = 0 (hence, E[g0] = 0) and (ii) for t â‰¤Ï„âˆ’1, E[â„“t] = âˆ’KL(f0, f1) < 0, based on (30), we have Ït = 0 for t â‰¤Ï„ âˆ’1. Further, based on (30), with an on period of Ton = hâ€²/KL(f1, f0) (when yt âˆ¼f1) 14 and an off period of Toff = hâ€²/KL(f0, f1) (when yt âˆ¼f0), we have 0 â‰¤Ït â‰¤hâ€² for t â‰¥Ï„. Since Ït is a lower bound for E[gt] for t > 0, in order to satisfy E[gt] â‰¤hâ€² for t â‰¥Ï„, the on period needs to be chosen smaller than hâ€²/KL(f1, f0) and/or the off period needs to be chosen larger than hâ€²/KL(f0, f1). For a stealthy attack, the attacker needs to choose hâ€² such that hâ€² < h. Further, âˆ†â‰œh âˆ’hâ€² can be considered as a margin for non-detectability. That is, as âˆ†increases, gt, t â‰¥Ï„ takes smaller values on average, that increases the average detection delay of the CUSUM algorithm. Based on Proposition 2, the average on (attacking) period is upper bounded with Â¯Ton â‰œ Ton Ton + Toff < KL(f0, f1) KL(f1, f0) + KL(f0, f1). Note that the upper bound on Â¯Ton is independent of hâ€² and hence of âˆ†. However, for a higher Â¯Ton, either Ton needs to be increased or Toff needs to be decreased, that both increases E[gt], t â‰¥Ï„ and hence decreases the average detection delay. Further, note that a stealthy attack can especially be effective if the system has strict false alarm constraints, i.e., requiring high level of false alarm periods and equivalently a high threshold h. 2) Persistent attacks: The CUSUM algorithm may not be effective in attack detection if the attack does not comply with the presumed attack model. If an attacker knows that the CUSUM detector is employed based on the post-attack pdf f1, then it can perform a stealthy persistent attack with a post-attack density f â€² 1 Ì¸= f1. The design goal can be keeping f â€² 1 as closest as possible to the post-attack pdf f1 for a strong attack while limiting the risk of being detected. Since the attack is of persistent nature, f â€² 1 needs to be designed such that the decision statistic of the CUSUM algorithm does not increase on average over time. Since the CUSUM algorithm accumulates the LLRs over time (cf. (28)), the LLR can be designed such that it takes non-positive values on the average, i.e., E[â„“t] â‰¤0, t > 0. Then, since E[â„“t] = âˆ’KL(f0, f1) < 0 for t â‰¤Ï„ âˆ’1, the condition E[â„“t] â‰¤0, t â‰¥Ï„ needs to be satisï¬ed. Considering the KL divergence KL(f â€² 1, f1) as the information distance between f â€² 1 and f1, the following optimization problem can be considered: min f â€² 1 KL(f â€² 1, f1) subject to E[â„“t] â‰¤0, t â‰¥Ï„, (31) where the solution is presented in the following proposition. Proposition 3: The solution of (31) is given by {f â€² 1 : KL(f â€² 1, f0) = KL(f â€² 1, f1)}. (32) 15 Proof. Let yt âˆ¼f â€² 1 for t â‰¥Ï„. Then, E[â„“t] = Z f â€² 1(y) log f1(y) f0(y)  dy = Z f â€² 1(y) log(f1(y))dy âˆ’ Z f â€² 1(y) log(f0(y))dy = Z f â€² 1(y) log(f1(y))dy âˆ’ Z f â€² 1(y) log(f â€² 1(y))dy + Z f â€² 1(y) log(f â€² 1(y))dy âˆ’ Z f â€² 1(y) log(f0(y))dy = Z f â€² 1(y) log f1(y) f â€² 1(y)  dy + Z f â€² 1(y) log f â€² 1(y) f0(y)  dy = âˆ’KL(f â€² 1, f1) + KL(f â€² 1, f0). Then, the constraint in (31), i.e., E[â„“t] â‰¤0, implies that âˆ’KL(f â€² 1, f1) + KL(f â€² 1, f0) â‰¤0, which is equivalent to KL(f â€² 1, f1) â‰¥ KL(f â€² 1, f0). Hence, the minimum value of KL(f â€² 1, f1) is KL(f â€² 1, f0). Proposition 3 presents a simple strategy for an attacker to perform a persistent stealthy attack against a CUSUM detector. As an example, let f0 âˆ¼N([Âµ0 Âµ0]T, Ïƒ2 I2) and f1 âˆ¼N([Âµ1 Âµ1]T, Ïƒ2 I2). If f â€² 1 âˆ¼N h 1 2 (Âµ0+Âµ1) 1 2 (Âµ0+Âµ1) i , h Ïƒ2 Ï• Ï• Ïƒ2 i , then it can be checked that KL(f â€² 1, f0) = KL(f â€² 1, f1) = 1 4Ïƒ2 (Âµ1 âˆ’Âµ0)2 + 1 2 log  Ïƒ4 Ïƒ4 âˆ’Ï•2  , where the correlation term Ï• can be chosen such that Ïƒ4 âˆ’Ï•2 > 0. B. Stealthy Attacks Against Algorithm 1 In the actual problem under consideration, the pre- and post-attack measurement pdfs, i.e., p0(yt|xt) and p1(yt|xt, at,Ïƒt), are based on some unknown and time-varying variables and hence the results in the previous subsection do not directly apply. The proposed algorithm estimates the pre- and post-attack pdfs at time t as p0(yt|Ë†x0 t) and p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt), respectively where Ë†x0 t and Ë†x1 t are computed via the Kalman ï¬lters, Ë†at is given in (26), and Ë†Ïƒt is given in (27). Then, the GLLR at time t is computed as follows (cf. (16)): Î²t = log p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt) p0(yt|Ë†x0 t)  . (33) Note that computing Ë†x0 t and Ë†x1 t requires the knowledge of all previously taken measurements, i.e., {yj, j â‰¤t}. Hence, for an attacker, estimating the pre- and post-attack pdfs and hence computing Î²t and gt requires monitoring all the system-wide measurements at all times, which is practically infeasible. Although determining the online attack parameters for a stealthy attack is difï¬cult in general, we provide below a brief analysis of the proposed algorithm and discuss possible stealthy attacks against it based on this analysis and the intuitions gained in Sec. IV-A. As before, since the measurements are random, an attacker can control the decision statistic only on the average. 16 Firstly, based on (33), Î²t depends on how close (relatively) the state estimates Ë†x0 t and Ë†x1 t to the actual system state xt and how accurate the MLEs of the attack magnitudes Ë†at and Ë†Ïƒt compared to the actual attack magnitudes at and Ïƒt are. During the pre-attack period, the measurements yt follow the normal measurement model (2) and hence at = 0 and Ïƒt = 0. Since Ë†x0 t is computed assuming no attack, for t â‰¤Ï„ âˆ’1, Ë†x0 t is usually a better estimate of the actual system state xt compared to Ë†x1 t due to the possible ML estimation errors in computing Ë†at, Ë†Ïƒt, and Ë†x1 t (recall that (cf. (12)) Ë†x1 t is computed based on Ë†at and Ë†Ïƒt). Then, p0(yt|Ë†x0 t) is expected to ï¬t better to yt compared to p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt), i.e., we usually have p0(yt|Ë†x0 t) â‰¥p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt) for t â‰¤Ï„ âˆ’1. Then, based on (33), Î²t is expected to take nonpositive values in general, that makes gt â‰ˆ0 a good approximation for t â‰¤Ï„ âˆ’1. The main aim of an attacker against the smart grid is deviating the state estimates from the actual system state as much as possible without being detected. Hence, it needs to keep gt below the level of h as long as possible for t â‰¥Ï„ (cf. (16)). Similar to the stealthy attacks against the CUSUM algorithm discussed in Sec. IV-A, an attacker can either follow an on-off attacking strategy or perform persistent attacks that do not comply with the presumed attack magnitudes (cf. (15)). Note that in case of an attack, i.e., for t â‰¥Ï„, Ë†x0 t deviates from xt since it is computed assuming no attack. On the other hand, Ë†x1 t is a recovered state estimate, but it is subject to possible ML estimation errors. 1) Non-persistent attacks: Since Algorithm 1 is a CUSUM-based detector, stealthy intermittent (on-off) attacking can be performed against it. Speciï¬cally, during the on periods, an attacker can choose its attack magnitudes comparable to or larger than the presumed lower bounds on the attack magnitudes, i.e., Î³ and Ïƒ2, with the purpose of a strong attack. However, as explained before, analytically deriving the on-off periods and the online attack magnitudes seems infeasible for an attacker. Hence, a smart attacker, having the knowledge of system and detector parameters, can determine its attack parameters based on an ofï¬‚ine simulation. When the attack complies with the presumed attack magnitudes, during an on period, Ë†x0 t usually deviates from the actual system state more than Ë†x1 t due to the recovery mechanism in computing Ë†x1 t (cf. (12)). That makes p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt) a better ï¬t to yt compared to p0(yt|Ë†x0 t) on the average. Then, if an on-off attack is performed, during the on periods, based on (33), usually Î²t takes non-negative values and gt increases. Further, at the beginning of an off period after an on period, although the attack magnitudes are zero, i.e., at = Ïƒt = 0, since Ë†x1 t is still a better (recovered) state estimate compared to Ë†x0 t, p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt) can still be a better ï¬t to yt and gt may further increase. Note that during an off period, Ë†x0 t is not expected to deviate further since yt now follows the normal measurement model. On the other hand, Ë†at, Ë†Ïƒt, and Ë†x1 t are still subject to possible ML estimation errors. That may make p0(yt|Ë†x0 t) a better ï¬t to yt over time and as the off period is continued, Î²t may start to take nonpositive values on the average. Since gt is expected to increase in an on period as well as in the beginning of an off period, the level of attack magnitudes during the on periods needs to be carefully chosen in accordance with the aim of keeping the highest value of gt below the decision threshold h, for t â‰¥Ï„. 2) Persistent attacks: Since Algorithm 1 relies on the lower bounds Î³ and Ïƒ2 deï¬ned on the attack magnitudes (cf. (15)), an attacker can perform persistent stealthy attacks using signiï¬cantly small attack magnitudes compared to Î³ and Ïƒ2 so that Algorithm 1 becomes ineffective to detect such attacks. In case of such small-magnitude stealthy attacks, the attack magnitudes at and Ïƒt are close to zero for t â‰¥Ï„ and due to the possible ML estimation errors in computing Ë†at and Ë†Ïƒt, Ë†x1 t usually 17 deviates more compared to Ë†x0 t, similarly to the pre-attack period discussed before. Then, p0(yt|Ë†x0 t) ï¬ts better to yt compared to p1(yt|Ë†x1 t, Ë†at, Ë†Ïƒt) on the average. Hence, in case of a persistent small-magnitude attack, based on (33), Î²t usually takes nonpositive values and the approximation gt â‰ˆ0 can still be valid. Note that even if an attacker has an incomplete knowledge about the system and detector parameters, it can still perform stealthy attacks with small attack magnitudes. Although such small-magnitude attacks have minimal effects on the system performance in the short run, they can be effective over long periods of time. Hence, they need to be detected with reasonable detection delays. C. Countermeasures Against Stealthy Attacks We ï¬rstly discuss countermeasures against the on-off attacking strategy, i.e., the non-persistent stealthy attacks. We then discuss a countermeasure against the persistent stealthy attacks where the attacks may not comply with the presumed attack model/magnitudes. Finally, we propose a new detection scheme, i.e., Algorithm 2, that simultaneously employs Algorithm 1 and the proposed countermeasures with the aim of being effective against a diverse range of potential cyber-attacks. 1) Countermeasures against the non-persistent stealthy attacks: Timely detection of cyber-attacks against the smart grid is crucial since any failure may quickly spread over the network. Hence, in practice, detection delays cannot be allowed to be arbitrarily large. Note that the optimization problem stated in (14) does not impose any constraints on the maximum tolerable detection delay. In an alternative quickest detection problem considered in [42], the objective is maximizing the probability of detection in at most Î· time units after an attack occurs, where Ï„ â‰¤T < Ï„ + Î· needs to be satisï¬ed for a successful detection. In the extreme case of the considered non-persistent stealthy attacks, the attacker can choose its on period as Ton = 1. In such a case, the attack needs to be detected using the measurements obtained during a single time interval in the attacking regime and hence Î· = 1 needs to be chosen. Then, we consider the following optimization problem, proposed in [42]: sup T p(T) subject to Eâˆ[T] â‰¥Î±, (34) where p(T) = inf Ï„ ess inf FÏ„ PÏ„  T = Ï„ |FÏ„, T â‰¥Ï„  is the worst-case (in the Lordenâ€™s sense) detection probability after obtaining the ï¬rst measurements in the attacking regime. Shewhart Test: In case the pre- and post-attack pdfs are known as in Sec. IV-A, the optimum solution to (34) is the Shewhart test [42, Theorem 2.3], given by TS = inf{t : â„“t â‰¥Î½}, (35) where TS denotes the stopping time and the threshold Î½ is determined such that Pâˆ(â„“1 â‰¥Î½) = 1/Î±. Note that the Shewhart test in (35) is, in fact, the repeated log-likelihood ratio test (LLRT), i.e., at each time, the LLR is compared with a certain threshold and an alarm is triggered at the ï¬rst time the LLR crosses the threshold. We then propose the Shewhart test as a countermeasure to the non-persistent stealthy attacks against the CUSUM detector. Note that Î½ needs to be chosen sufï¬ciently high to prevent frequent false alarms. 18 Generalized Shewhart Test: In case the pre- and post-attack pdfs are unknown and time-varying, we can only compute the GLLR Î²t. Hence, as a countermeasure, we propose to employ the generalized Shewhart test, i.e., the repeated generalized LLRT (GLLRT), given by T â€² = inf{t : Î²t â‰¥Ï†}, (36) where T â€² is the stopping time and Ï† is the test threshold. Again, a sufï¬ciently high threshold needs to be chosen to prevent frequent false alarms. Moreover, similar to Algorithm 1, by choosing higher Î³ and/or Ïƒ2, false alarm rate of the generalized Shewhart test can be reduced (see Remark 2). Note that the generalized Shewhart test is expected to be mainly effective in detecting signiï¬cant instantaneous increases in the level of GLLR and hence in detecting non-persistent stealthy attacks during the on periods. That is, even if an attack may be missed by Algorithm 1 since the decision statistic gt may not achieve reliably high values for t â‰¥Ï„ due to the subsequent off period after an on period, the generalized Shewhart test can detect such non-persistent increases during the on periods. 2) A countermeasure against the persistent stealthy attacks: Non-parametric detection techniques do not assume any attack models and only evaluate the deviation of measurement statistics from the baseline (no attack) statistics. However, they are usually less effective if the attacks comply with the presumed attack models. As explained before, a persistent stealthy attack can be performed if an attack does not match the considered attack models or magnitudes. For such cases, parametric detectors such as Algorithm 1 and the generalized Shewhart test become ineffective and the non-parametric detection techniques become more appropriate. In case of no attack, i.e., for t < Ï„, ct â‰œrtT Qt âˆ’1rt is a chi-square random variable with KÎ» degrees of freedom [18], where rt denotes the measurement innovation signal at time t, given as rt â‰œyt âˆ’HË†x0 t|tâˆ’1, and Qt is the measurement prediction covariance matrix at time t, calculated as follows: Qt â‰œHPt|tâˆ’1HT + Ïƒ2 w IKÎ». Notice that although the distribution of the measurements yt is time-varying and unknown due to the dynamic system state xt, the distribution of ct is time-invariant and known in case of no attack, i.e., for t < Ï„. Hence, whether the sequence {ct} ï¬ts to the chi-squared distribution or not can be evaluated via a goodness-of-ï¬t test and if not, an attack/anomaly is declared. Sliding-Window Chi-Squared Test: We partition the range of ct, i.e., [0, âˆ), into M mutually exclusive and disjoint intervals Ij, j = 1, 2, . . . , M such that p1 = P(ct âˆˆI1), p2 = P(ct âˆˆI2), ..., pM = P(ct âˆˆIM). Hence, p1, p2, . . . , pM denote the probabilities that ct belongs to the intervals I1, I2, . . . , IM, respectively for t < Ï„, where PM j=1 pj = 1. The intervals I1, I2, . . . , IM can be determined using the cumulative distribution function (cdf) of a chi-squared random variable with KÎ» degrees of freedom. Then, the null hypothesis is that ct belongs to the intervals I1, I2, . . . , IM with probabilities p1, p2, . . . , pM, respectively. 19 We propose to employ an online test to evaluate whether the most recent sliding window of ctâ€™s ï¬ts to the null hypothesis. Let the size of the sliding window be L. Then, the sliding window at time t, denoted with Wt, consists of {cj : tâˆ’L+1 â‰¤j â‰¤t}. Let the number of samples in Wt belonging to the predetermined disjoint intervals be denoted with N1,t, N2,t, . . . , NM,t, respectively where PM i=1 Ni,t = L, âˆ€t. Since we have a multinomial distribution where the expected number of samples in the disjoint intervals are Lp1, Lp2, . . . , LpM, respectively, the Pearsonâ€™s chi-squared test can be used to evaluate the goodness of ï¬t, that can be written as T â€²â€² = inf{t : Ï‡t â‰¥Ï•}, (37) where Ï‡t = M X i=1 (Ni,t âˆ’Lpi)2 Lpi (38) is the asymptotically (as L â†’âˆ) chi-squared distributed test statistic with M âˆ’1 degrees of freedom under the null hypothesis, Ï• is the test threshold that can be determined using the cdf of a chi-squared random variable for a desired signiï¬cance level, and T â€²â€² denotes the stopping time. To improve the accuracy of the detector, M can be chosen higher. Note, however, that as M is increased, the window size L needs also to be increased to improve the reliability of the goodness-of-ï¬t test, that will cause larger detection delays. The chi-squared test does not assume any attack model a priori and it only evaluates deviation of observed measurements from the baseline statistics corresponding to the normal system operation. We propose to use the chi-squared test to have a detection scheme that is robust against (i) low-magnitude stealthy attacks that corresponds to small deviations from the baseline for which our proposed parametric detectors (Algorithm 1 and the generalized Shewhart test) become ineffective to detect, and (ii) attacks that do not comply with the presumed hybrid attack model, e.g., non-Gaussian or correlated jamming noise. Remark 3: The proposed chi-squared test is a sequential version of the Pearsonâ€™s chi-squared test since the most recent sliding window of samples is used in the test. Furthermore, the proposed test is different from the outlier detector in [18], that makes sample by sample decisions, i.e., it declares a single sample as either normal and anomalous. The proposed test is thus more reliable and more sensitive to small deviations from the baseline since it considers long-term deviations by evaluating a sliding window of samples. 3) Proposed ï¬nal detection scheme: Our aim is to obtain a detection mechanism that is effective against a signiï¬cantly wide range of cyber-attacks. Hence, we propose to simultaneously employ Algorithm 1, the generalized Shewhart test, and the sliding-window chi-squared test and declare an attack at the ï¬rst time instant one of the detectors declares an attack (if any). Hence, ËœT = inf{T, T â€², T â€²â€²} is the proposed stopping time. We summarize the proposed detector in Algorithm 2. Note that the average false alarm period of Algorithm 2 is less than the minimum of the (individual) average false alarm periods of Algorithm 1, the generalized Shewhart 20 Algorithm 2 Real-time detection of hybrid and stealthy attacks 1: Initialization: t â†0, g0 â†0, Ë†Ï„ â†1, choose the entries of the initial sliding window of the chi-squared test, i.e., W0, as realizations of a chi-squared random variable with KÎ» degrees of freedom. 2: while gt < h and Î²t < Ï† and Ï‡t < Ï• do 3: t â†t + 1 4: Implement the lines 4â€“15 in Algorithm 1. 5: rt â†yt âˆ’HË†x0 t|tâˆ’1 6: Qt â†HPt|tâˆ’1HT + Ïƒ2 w IKÎ» 7: ct â†rt T Qt âˆ’1rt 8: Update Wt with the most recent entry ct. 9: Update N1,t, N2,t, . . . , NM,t and compute Ï‡t using (38). 10: end while 11: ËœT â†t, declare a cyber-attack. test, and the sliding-window chi-squared test. Hence, sufï¬ciently high thresholds, i.e., h, Ï† and Ï•, need to be chosen to prevent frequent false alarms. Furthermore, to have the same average false alarm periods Î± for Algorithms 1 and 2, the threshold h needs to be chosen higher in Algorithm 2 and the thresholds Ï† and Ï• need to be chosen such that the individual average false alarm periods of the generalized Shewhart test and the sliding-window chi-squared tests are greater than Î±. V. SIMULATION RESULTS In this section, we evaluate the performance of the proposed detection schemes via simple case studies in an IEEE-14 bus power system, where K = 23 and N = 13. The system matrix A is chosen to be an identity matrix, the measurement matrix H is determined based on the IEEE-14 bus power system, and Î» = 5 is chosen. The initial state variables are obtained through the DC optimal power ï¬‚ow algorithm for case-14 in MATPOWER [43]. The system noise variances are chosen as Ïƒ2 v = Ïƒ2 w = 10âˆ’4. Furthermore, the parameters of Algorithm 1 are chosen as Î³ = 0.022 and Ïƒ2 = 10âˆ’2. In Algorithm 2, the threshold of the generalized Shewhart test is chosen as Ï† = 10. Moreover, for the chi-squared test, the window size is chosen as L = 80, number of disjoint intervals are chosen as M = 5, the probabilities are chosen as p1 = p2 = Â· Â· Â· = p5 = 0.2, and the intervals I1, I2, . . . , I5 are determined accordingly as I1 = [0, 102.081), I2 = [102.081, 110.5475), I3 = [110.5475, 118.2061), I4 = [118.2061, 127.531), and I5 = [127.531, âˆ) based on the cdf of a chi-squared random variable with KÎ» = 115 degrees of freedom. The threshold of the Pearsonâ€™s chi-squared test, i.e., Ï• = 25.0133, is chosen based on the signiï¬cance level of 5 Ã— 10âˆ’5 for a chi-squared random variable with M âˆ’1 = 4 degrees of freedom. The thresholds of the generalized Shewhart and the chi-squared tests are chosen such that the (individual) average false alarm periods of these tests are in the order of 104. The cyber-attacks are launched at t = 100. Firstly, we evaluate the performance of the proposed schemes in case of an FDI-only attack, a jamming-only attack, and a hybrid attack. We then evaluate the performance in case of stealthy hybrid attacks. Particularly, we consider a non-persistent stealthy attack and a small-magnitude persistent stealthy attack, and illustrate the performance improvement obtained with the proposed countermeasures against such stealthy attacks. Next, we illustrate the mean squared error (MSE) vs. time plot for the recovered and non-recovered state estimates in case of a hybrid cyber-attack. Finally, we evaluate the performance of the proposed schemes in case of a network topology attack/failure. 21 A. Case 1: FDI Attack We ï¬rstly consider a random and time-varying persistent FDI attack where at each time the attacker chooses the magnitudes of the injected false data and the set of attacked meters randomly. In particular, at each time, the attacker compromises the measurements of each meter with probability 0.5 and injects the realizations of the uniform random variable U[âˆ’0.02, 0.02] to the attacked meters. Fig. 1 illustrates the tradeoff between the average detection delay and the average false alarm period for the proposed algorithms and also three benchmark tests, namely the nonparametric CUSUM test in [29], the Euclidean detector [17] and the cosine-similarity metric based detector [19] that both check the dissimilarity between the actual and the predicted measurements (by the Kalman ï¬lter) and declare an anomaly if the dissimilarity metric is greater than certain thresholds. Since a nonlinear power system model is studied in [29] and we use a linear system model, we include a modiï¬ed version of the nonparametric CUSUM detector for the linear case. The stopping time and the update of the decision statistic over time for the modiï¬ed nonparametric CUSUM detector are given as follows: Â¯T â‰œinf {t : St â‰¥q} , St = Stâˆ’1 + Î´t, Î´t â‰œâˆ¥yt âˆ’HË†x0 t|tâˆ’1âˆ¥âˆ’E0  âˆ¥yt âˆ’HË†x0 t|tâˆ’1âˆ¥  , where Â¯T denotes the corresponding stopping time, St is the decision statistic at time t where S0 = 0, q is the test threshold that controls the false alarm rate of the detector, and E0[âˆ¥yt âˆ’HË†x0 t|tâˆ’1âˆ¥] denotes the expectation of the L2 norm of the measurement innovation signal in the pre-change case, computed via a Monte Carlo simulation. The nonparametric CUSUM detector accumulates the difference between magnitude of the measurement innovation signal and its expected value in the pre-change case (normal system operation). We observe that the proposed algorithms signiï¬cantly outperform the benchmark tests. Moreover, Algorithm 1 slightly outperforms Algorithm 2. This is because the countermeasures introduced in Algorithm 2 slightly increase the false alarm rate of Algorithm 2. Note that in obtaining the tradeoff curve for Algorithm 2, we keep the thresholds Ï† and Ï• constant and only vary h. We then illustrate the performance of the proposed algorithms as the magnitude of the injected false data varies while keeping the false alarm rate constant. We again consider the random and time-varying persistent FDI attack described above, but this time the magnitudes of the injected data are realizations of U[âˆ’Î¸, Î¸], where Î¸ varies between 0.009 and 0.03. Through Fig. 2, we see the advantage of the proposed countermeasures as the magnitude of the false data takes very small values. For instance, when Î¸ = 0.009, the average detection delays of Algorithm 1 and Algorithm 2 are 48.02 and 39.45, respectively. B. Case 2: Jamming Attack Next, we consider a random and time-varying persistent jamming attack. At each time, an attacker jams the measurements of each meter with probability 0.5 where the variances of the jamming noise are the realizations of the uniform random variable U[2 Ã— 10âˆ’4, 4 Ã— 10âˆ’4]. Fig. 3 presents the delay to false alarm curve for the proposed algorithms and the benchmark tests. Further, we evaluate the performance as the magnitude of the jamming noise variance varies by keeping the false alarm rate 22 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 50 100 150 200 250 Average Detection Delay Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM 0.5 1 1.5 2 104 1 1.2 1.4 Fig. 1: Average detection delay vs. average false alarm period for the proposed detectors and the benchmark tests in case of a random FDI attack. 0.005 0.01 0.015 0.02 0.025 0.03 0 5 10 15 20 25 30 35 40 45 50 Average Detection Delay Algorithm 1 Algorithm 2 Fig. 2: Average detection delay vs. magnitude of the injected false data for the proposed detectors in case of a random FDI attack, where the average false alarm period is approximately 1.5 Ã— 104. constant. In particular, jamming noise variances are chosen as realizations of U[Ï‘, 2Ï‘], where Ï‘ is varied between 0.75Ïƒ2 w and 3Ïƒ2 w. Through Fig. 4, we again observe smaller detection delays in Algorithm 2 compared to Algorithm 1 in case of very small attack magnitudes. C. Case 3: Hybrid FDI/Jamming Attack Next, we consider a random and time-varying persistent hybrid attack. The attack is combined over the system and it may also be combined over a subset of meters. In particular, we consider the attacks described in Sec. V-A and Sec. V-B altogether. Hence, the attacker chooses a random subset of meters for FDI attack and another random subset of meters for jamming attack, where these subsets might overlap with each other. The attack magnitudes for FDI and jamming attacks are realizations of U[âˆ’0.02, 0.02] and U[2 Ã— 10âˆ’4, 4 Ã— 10âˆ’4], respectively. In Fig. 5, for the same levels of false alarm rate, we observe smaller detection delays compared to Figures 1 and 3, as expected. 23 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 50 100 150 200 250 300 Average Detection Delay Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM 0.5 1 1.5 2 104 0.6 0.7 0.8 0.9 1 Fig. 3: Average detection delay vs. average false alarm period for the proposed detectors and the benchmark tests in case of a random jamming attack. 0.5 1 1.5 2 2.5 3 0 10 20 30 40 50 60 Average Detection Delay Algorithm 1 Algorithm 2 Fig. 4: Average detection delay vs. variance of the jamming noise for the proposed detectors in case of a random jamming attack, where the average false alarm period is approximately 1.5 Ã— 104. 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 50 100 150 200 250 Average Detection Delay Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM 0.5 1 1.5 2 104 0.1 0.15 0.2 Fig. 5: Average detection delay vs. average false alarm period for the proposed detectors and the benchmark tests in case of a hybrid attack. 24 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Missed Detection Ratio Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM Fig. 6: Missed detection ratio vs. average false alarm period for the proposed detectors and the benchmark tests in case of a stealthy non-persistent attack, where the attack is assumed to be missed if it is not detected within 50 time units. D. Case 4: Non-persistent Stealthy Attack Next, we consider a stealthily designed on-off attack. Particularly, after the attack is launched at t = 100, the attacker performs a hybrid attack as described in Sec. V-C where the magnitudes of the FDI and jamming attacks are realizations of U[âˆ’0.01, 0.01] and U[10âˆ’4, 2 Ã— 10âˆ’4], respectively and the on and off periods are Ton = 1 and Toff = 3, respectively. As an example, we choose the maximum tolerable detection delay as 50 time units and if the attack cannot be detected within this period, we assume that the attack is missed. In Fig. 6, we present the missed detection ratio versus average false alarm period for the proposed algorithms and the benchmark tests. As discussed in Sec. IV-C.1, against the non-persistent attacks, mainly the generalized Shewhart test is expected to perform well. That is, due to the off periods, even though the accumulated evidence supporting change may not become reliably high to declare an attack in Algorithm 1, the GLLR may take high values during the on periods. On the other hand, since the threshold of the generalized Shewhart test is chosen very high (Ï† = 10) to reduce the false alarm level of Algorithm 2, the missed detection ratios in Algorithms 1 and 2 are almost the same for the small levels of average false alarm period, i.e., for the small test thresholds. However, for higher levels of average false alarm period, the missed detection ratio of Algorithm 2 signiï¬cantly decreases compared to Algorithm 1 and the advantage of introducing the generalized Shewhart test in Algorithm 2 becomes visible in detecting the non-persistent stealthy attacks. E. Case 5: Persistent Stealthy Attack Although the considered lower bounds Î³ and Ïƒ2 on the attack magnitudes are already very small, an attacker may still perform a persistent stealthy attack using even lower attack magnitudes. Recall that we have previously showed in Figures 2 and 4 the advantage of Algorithm 2 over Algorithm 1 as the attack magnitudes get smaller for the FDI and jamming attacks, respectively. This time, we consider a hybrid attack with even smaller attack magnitudes where the magnitudes of FDI and jamming attacks are chosen as realizations of U[âˆ’0.005, 0.005] and U[0.5 Ã— 10âˆ’4, 10âˆ’4], respectively. We present the missed detection ratio versus the average false alarm period curve for the proposed algorithms and the benchmark tests in Fig. 7. We observe that Algorithm 2 signiï¬cantly outperforms Algorithm 1 due to the introduced non-parametric chi-squared test in Algorithm 2. Since the attack magnitudes are very small, the proposed parametric tests become ineffective to detect 25 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Missed Detection Ratio Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM Fig. 7: Missed detection ratio vs. average false alarm period for the proposed detectors and the benchmark tests in case of a stealthy small-magnitude persistent attack, where the attack is assumed to be missed if it is not detected within 50 time units. such stealthy attacks. Note that although the non-parametric goodness-of-ï¬t tests such as the chi-squared test becomes more successful in detecting such small-magnitude stealthy attacks, they in general lead to longer detection delays compared to the considered parametric tests since they usually require more samples for a reliable decision, mainly because they ignore all the prior knowledge about the post-attack case. F. Algorithm 1 vs. Countermeasures Against Stealthy Attacks With the purpose of illustrating the advantages of additional countermeasures employed in Algorithm 2 more clearly, Fig. 8 shows a comparison between Algorithm 1 and the countermeasures in case of stealthy attacks described in Sec. V-D and Sec. V-E. Here, the individual average false alarm periods of Algorithm 1, the generalized Shewhart test, and the sliding- window chi-squared test are nearly equal to each other and for the non-persistent and persistent stealthy attacks, the ï¬gure shows the ratios over all trials at which each algorithm detects the attack ï¬rst (with the minimum delay), where more than one test may simultaneously declare an attack with the minimum delay. Through the ï¬gure, we observe that the generalized Shewhart and the sliding-window chi-squared tests outperform Algorithm 1 in case of non-persistent and persistent stealthy attacks, respectively. Hence, together with the results obtained through Figures 6 and 7, we can conclude that in case of stealthy attacks, the countermeasures improve the detection performance of Algorithm 2 compared to Algorithm 1. G. Recovered State Estimates Fig. 9 presents the MSE versus time curve for the recovered, i.e., Ë†x1 t|t, and the non-recovered, i.e., Ë†x0 t|t, state estimates during the pre-change period, i.e., for t < 100, and the ï¬rst 50 time units after a hybrid FDI/jamming attack is launched to the system at Ï„ = 100. The FDI and jamming attacks are both of persistent nature as described in Sec. V-C and the attack magnitudes are realizations of U[âˆ’0.1, 0.1] and U[1, 2], respectively. Through the ï¬gure, we observe that the MSE of the recovered state estimates is signiï¬cantly smaller than the MSE of the non-recovered state estimates. Further, we observe that the recovered state estimates slightly deviate from the actual system state xt over the attacking period. This is due to the fact that the MLEs of the attack variables are computed based on the recovered state estimates (cf. (26) and (27)) and also the 26 Non-Persistent Attack Persistent Attack 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Alg. 1 G. Shewhart Chi-Squared Fig. 8: Ratio of trials at which Algorithm 1, the generalized Shewhart test, and the sliding-window chi-squared test detect the stealthy attacks ï¬rst (with the minimum delay), where the individual average false alarm periods of the algorithms are approximately 1.5 Ã— 104. 0 50 100 150 0 0.2 0.4 0.6 0.8 1 1.2 1.4 Fig. 9: MSE vs. time for the recovered (Ë†x1 t|t) and non-recovered (Ë†x0 t|t) state estimates in case of a hybrid attack. recovered state estimates are computed based on the MLEs of the attack variables (cf. (12)). Hence, the ML estimation errors accumulate over time during the attacking period. However, since the attacks can be quickly detected with the proposed real- time detection schemes, the deviation of the recovered state estimates is not expected to be signiï¬cantly high at the detection time. Furthermore, recall that during the pre-attack period, whenever the decision statistic of Algorithm 1 reaches zero, the state estimates for the post-attack case are updated as being equal to the state estimates for the pre-attack case. Since the decision statistic frequently reaches zero during the pre-attack period, the ML estimation errors in computing the recovered state estimates do not accumulate in the pre-attack period. H. Case 6: Topology Attack/Fault Except the proposed nonparametric chi-squared test, the proposed methods are prone to the errors in the measurement matrix H due to either cyber-attacks or faults. This is because Algorithm 1 and the generalized Shewhart test are designed for a given H (see the hybrid attack model in (5)), whereas the chi-squared test does not depend on attack model assumptions. On the other hand, the speciï¬c version of topology attack/failure in which some rows of H seem zero to the control center (although they are not) corresponds to DoS attacks, which is covered by the considered hybrid attack model (see Remark 1). For 27 0 0.5 1 1.5 2 2.5 Average False Alarm Period 104 0 2 4 6 8 10 12 Average Detection Delay Algorithm 1 Algorithm 2 Euclidean Detector Cos-Sim Detector Nonpar. CUSUM Fig. 10: Average detection delay vs. average false alarm period for the proposed detectors and the benchmark tests in case of a network topology attack/fault. instance, if the link between two buses in a power grid breaks down due to an attack or fault, then the row in H corresponding to the power-ï¬‚ow measurement between these buses is changed accordingly such that the corresponding measurement signal becomes unavailable to the control center. Since the hybrid attack model covers DoS attacks as a special case, such topology attacks/faults can be detected by the proposed detectors. In Fig. 10, we illustrate the performance of the proposed and the benchmark algorithms in detecting a line break between buses 9 and 10 in the IEEE-14 bus power system. VI. CONCLUSIONS In this paper, we have studied the real-time detection of hybrid FDI/jamming attacks in the smart grid. For a given network topology, we have modeled the smart grid as a linear dynamic system and employed Kalman ï¬lters for state estimation. We have proposed an online CUSUM-based attack detection and estimation algorithm that is robust to unknown and time-varying attack parameters. We have also presented online estimates of the attack parameters in closed form and recovered state estimates in case of a cyber-attack. Furthermore, we have introduced and analyzed stealthy attacks against CUSUM-based detectors and speciï¬cally against the proposed algorithm, where the main aim of stealthy attacks is to prevent the detection or at least to increase the detection delays. We have presented the generalized Shewhart test and the sliding-window chi-squared test as countermeasures against non-persistent and persistent stealthy attacks, respectively. Through extensive simulations, we have illustrated that the proposed algorithms can timely and reliably detect hybrid FDI/jamming attacks and stealthy attacks against CUSUM-based detectors, that correspond to a signiï¬cantly diverse range of potential cyber-attacks targeting the smart grid. Moreover, the simulations illustrate the effectiveness of the proposed state recovery mechanism to mitigate the effects of cyber-attacks on the state estimation mechanism. The proposed hybrid attack model does not cover network topology attacks as a special case. As a future work, the generalized state estimation mechanism [44] can be considered where both the system state and the network topology are estimated based on power ï¬‚ow/injection measurements and measurements regarding the status of network switches and line breakers, and countermeasures can be developed against advanced topology attacks where attackers simultaneously perform hybrid FDI/jamming and network topology attacks. 28 APPENDIX A. Proof of Proposition 1 Based on (7) and (8), Î²t in (16) can be written as follows: Î²t = KÎ» 2 log(Ïƒ2 w) + 1 2Ïƒ2w K X k=1 Î» X i=1 (yk,t,i âˆ’hT k Ë†x0 t)2 + sup S0 t ,Sf t ,Sj t ,Sf,j t ( sup |ak,t|â‰¥Î³, k âˆˆSf t âˆªSf,j t sup Ïƒ2 k,tâ‰¥Ïƒ2, k âˆˆSj t âˆªSf,j t  X kâˆˆS0 t Î» X i=1 âˆ’1 2 log(Ïƒ2 w) âˆ’ 1 2Ïƒ2w (yk,t,i âˆ’hT k Ë†x1 t)2 + X kâˆˆSf t Î» X i=1 âˆ’1 2 log(Ïƒ2 w) âˆ’ 1 2Ïƒ2w (yk,t,i âˆ’hT k Ë†x1 t âˆ’ak,t)2 + X kâˆˆSj t Î» X i=1 âˆ’1 2 log(Ïƒ2 w + Ïƒ2 k,t) âˆ’ 1 2(Ïƒ2w + Ïƒ2 k,t)(yk,t,i âˆ’hT k Ë†x1 t)2 + X kâˆˆSf,j t Î» X i=1 âˆ’1 2 log(Ïƒ2 w + Ïƒ2 k,t) âˆ’ 1 2(Ïƒ2w + Ïƒ2 k,t)(yk,t,i âˆ’hT k Ë†x1 t âˆ’ak,t)2 ) . (39) Let ek,t,i â‰œyk,t,i âˆ’hT k Ë†x1 t and ek,t â‰œ[ek,t,1, ek,t,2, . . . , ek,t,Î»]T. Using the fact that taking supremum of a quantity is equivalent to taking inï¬mum of the negative of the quantity, (39) can be rewritten as Î²t = KÎ» 2 log(Ïƒ2 w) + 1 2Ïƒ2w K X k=1 Î» X i=1 (yk,t,i âˆ’hT k Ë†x0 t)2 âˆ’1 2 inf S0 t ,Sf t ,Sj t ,Sf,j t  X kâˆˆS0 t Î» log(Ïƒ2 w) + PÎ» i=1 e2 k,t,i Ïƒ2w | {z } u0(ek,t) + X kâˆˆSf t Î» log(Ïƒ2 w) + inf|ak,t|â‰¥Î³  PÎ» i=1(ek,t,i âˆ’ak,t)2 Ïƒ2w | {z } uf (ek,t) + X kâˆˆSj t inf Ïƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + PÎ» i=1 e2 k,t,i (Ïƒ2w + Ïƒ2 k,t) o | {z } uj(ek,t) + X kâˆˆSf,j t inf Ïƒ2 k,tâ‰¥Ïƒ2 inf |ak,t|â‰¥Î³ n Î» log(Ïƒ2 w + Ïƒ2 k,t) + PÎ» i=1(ek,t,i âˆ’ak,t)2 (Ïƒ2w + Ïƒ2 k,t) o | {z } uf,j(ek,t) ! (40) = KÎ» 2 log(Ïƒ2 w) + 1 2Ïƒ2w K X k=1 Î» X i=1 (yk,t,i âˆ’hT k Ë†x0 t)2 âˆ’1 2 inf S0 t ,Sf t ,Sj t ,Sf,j t  X kâˆˆS0 t u0(ek,t) + X kâˆˆSf t uf(ek,t) + X kâˆˆSj t uj(ek,t) + X kâˆˆSf,j t uf,j(ek,t) ! . The MLE estimates of S0 t , Sf t , Sj t , and Sf,j t are then determined as follows: Ë†S0 t = n k : u0(ek,t) â‰¤uf(ek,t), u0(ek,t) â‰¤uj(ek,t), u0(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o Ë†Sf t = n k : uf(ek,t) < u0(ek,t), uf(ek,t) â‰¤uj(ek,t), uf(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o Ë†Sj t = n k : uj(ek,t) < u0(ek,t), uj(ek,t) < uf(ek,t), uj(ek,t) â‰¤uf,j(ek,t), k = 1, 2, . . . , K o Ë†Sf,j t = n k : uf,j(ek,t) < u0(ek,t), uf,j(ek,t) < uf(ek,t), uf,j(ek,t) < uj(ek,t), k = 1, 2, . . . , K o . 29 Then, Î²t can be computed as Î²t = KÎ» 2 log(Ïƒ2 w) + 1 2Ïƒ2w K X k=1 Î» X i=1 (yk,t,i âˆ’hT k Ë†x0 t)2 âˆ’1 2  X kâˆˆË† S0 t u0(ek,t) + X kâˆˆË† Sf t uf(ek,t) + X kâˆˆË† Sj t uj(ek,t) + X kâˆˆË† Sf,j t uf,j(ek,t)  , where u0(ek,t) is given by (cf. (40)) u0(ek,t) = Î» log(Ïƒ2 w) + PÎ» i=1 e2 k,t,i Ïƒ2w . Next, we determine uf(ek,t), uj(ek,t), uf,j(ek,t), respectively and the MLEs of ak,t and Ïƒ2 k,t. Firstly, uf(ek,t) = Î» log(Ïƒ2 w) + inf|ak,t|â‰¥Î³  PÎ» i=1(ek,t,i âˆ’ak,t)2 Ïƒ2w = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ Î» log(Ïƒ2 w) + 1 Ïƒ2w PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ Î» log(Ïƒ2 w) + 1 Ïƒ2w PÎ» i=1(ek,t,i âˆ’Î³)2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ Î» log(Ïƒ2 w) + 1 Ïƒ2w PÎ» i=1(ek,t,i + Î³)2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0, where the MLE of ak,t, k âˆˆSf t is obtained as follows: Ë†ak,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ 1 Î» PÎ» i=1 ek,t,i, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³, k âˆˆSf t Î³, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³, k âˆˆSf t âˆ’Î³, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0, k âˆˆSf t . (41) Secondly, uj(ek,t) = inf Ïƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + PÎ» i=1 e2 k,t,i Ïƒ2w + Ïƒ2 k,t o . We have âˆ‚uj(ek,t) âˆ‚Ïƒ2 k,t = Î» Ïƒ2w+Ïƒ2 k,t âˆ’ PÎ» i=1 e2 k,t,i (Ïƒ2w+Ïƒ2 k,t)2 = 0 if Ïƒ2 k,t = âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i. Moreover, for Ïƒ2 k,t < âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i, âˆ‚uj(ek,t) âˆ‚Ïƒ2 k,t < 0 and for Ïƒ2 k,t > âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i, âˆ‚uj(ek,t) âˆ‚Ïƒ2 k,t > 0. Hence, if 1 Î» PÎ» i=1 e2 k,t,i â‰¥Ïƒ2 w + Ïƒ2, uj(ek,t) takes it minimum at Ïƒ2 k,t = âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i. On the other hand, if 1 Î» PÎ» i=1 e2 k,t,i < Ïƒ2 w + Ïƒ2, uj(ek,t) is monotone increasing function of Ïƒ2 k,t in the range of Ïƒ2 k,t â‰¥Ïƒ2. Hence, uj(ek,t) takes its minimum at Ïƒ2 k,t = Ïƒ2. Then, uj(ek,t) = ï£± ï£´ ï£´ ï£² ï£´ ï£´ ï£³ Î» log( 1 Î» PÎ» i=1 e2 k,t,i) + Î», if 1 Î» PÎ» i=1 e2 k,t,i â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + 1 Ïƒ2w+Ïƒ2 PÎ» i=1 e2 k,t,i, if 1 Î» PÎ» i=1 e2 k,t,i < Ïƒ2 w + Ïƒ2, where the MLE of Ïƒ2 k,t, k âˆˆSj t is obtained as follows: Ë†Ïƒ2 k,t = ï£± ï£´ ï£´ ï£² ï£´ ï£´ ï£³ âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i, if 1 Î» PÎ» i=1 e2 k,t,i â‰¥Ïƒ2 w + Ïƒ2, k âˆˆSj t Ïƒ2, if 1 Î» PÎ» i=1 e2 k,t,i < Ïƒ2 w + Ïƒ2, k âˆˆSj t . (42) 30 Further, uf,j(ek,t) = inf Ïƒ2 k,tâ‰¥Ïƒ2 inf |ak,t|â‰¥Î³ n Î» log(Ïƒ2 w + Ïƒ2 k,t) + PÎ» i=1(ek,t,i âˆ’ak,t)2 (Ïƒ2w + Ïƒ2 k,t) o = inf Ïƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + inf|ak,t|â‰¥Î³  PÎ» i=1(ek,t,i âˆ’ak,t)2 (Ïƒ2w + Ïƒ2 k,t) o = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ infÏƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + 1 (Ïƒ2w+Ïƒ2 k,t) PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2o , if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ infÏƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + 1 (Ïƒ2w+Ïƒ2 k,t) PÎ» i=1(ek,t,i âˆ’Î³)2o , if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ infÏƒ2 k,tâ‰¥Ïƒ2 n Î» log(Ïƒ2 w + Ïƒ2 k,t) + 1 (Ïƒ2w+Ïƒ2 k,t) PÎ» i=1(ek,t,i + Î³)2o , if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ Î» log( 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2) + Î», if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + 1 Ïƒ2w+Ïƒ2 PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 < Ïƒ2 w + Ïƒ2 Î» log( 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2) + Î», if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + 1 Ïƒ2w+Ïƒ2 PÎ» i=1(ek,t,i âˆ’Î³)2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 < Ïƒ2 w + Ïƒ2 Î» log( 1 Î» PÎ» i=1(ek,t,i + Î³)2) + Î», if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 â‰¥Ïƒ2 w + Ïƒ2 Î» log(Ïƒ2 w + Ïƒ2) + 1 Ïƒ2w+Ïƒ2 PÎ» i=1(ek,t,i + Î³)2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 < Ïƒ2 w + Ïƒ2, where the MLE of ak,t, k âˆˆSf,j t is obtained as Ë†ak,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ 1 Î» PÎ» i=1 ek,t,i, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³, k âˆˆSf,j t Î³, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³, k âˆˆSf,j t âˆ’Î³, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0, k âˆˆSf,j t , (43) and the MLE of Ïƒ2 k,t, k âˆˆSf,j t is obtained as follows: Ë†Ïƒ2 k,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 â‰¥Ïƒ2 w + Ïƒ2 Ïƒ2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 < Ïƒ2 w + Ïƒ2 âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 â‰¥Ïƒ2 w + Ïƒ2 Ïƒ2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 < Ïƒ2 w + Ïƒ2 âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i + Î³)2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 â‰¥Ïƒ2 w + Ïƒ2 Ïƒ2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 < Ïƒ2 w + Ïƒ2. (44) 31 Using (41), (43), and the MLEs of S0 t , Sf t , Sj t , and Sf,j t , the MLE of ak,t, k âˆˆ{1, 2, . . . , K} is then determined as follows: Ë†ak,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ 1 Î» PÎ» i=1 ek,t,i, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and k âˆˆË†Sf t âˆªË†Sf,j t Î³, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and k âˆˆË†Sf t âˆªË†Sf,j t âˆ’Î³, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and k âˆˆË†Sf t âˆªË†Sf,j t 0, if k âˆˆË†S0 t âˆªË†Sj t . Furthermore, using (42), (44), and the MLEs of S0 t , Sf t , Sj t , and Sf,j t , the MLE of Ïƒ2 k,t, k âˆˆ{1, 2, . . . , K} is obtained as follows: Ë†Ïƒ2 k,t = ï£± ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£² ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£´ ï£³ âˆ’Ïƒ2 w + 1 Î» PÎ» i=1 e2 k,t,i, if 1 Î» PÎ» i=1 e2 k,t,i â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sj t Ïƒ2, if 1 Î» PÎ» i=1 e2 k,t,i < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sj t âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if | 1 Î» PÎ» i=1 ek,t,i| â‰¥Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’1 Î» PÎ» i=1 ek,t,i)2 < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if 0 â‰¤1 Î» PÎ» i=1 ek,t,i < Î³ and 1 Î» PÎ» i=1(ek,t,i âˆ’Î³)2 < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t âˆ’Ïƒ2 w + 1 Î» PÎ» i=1(ek,t,i + Î³)2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 â‰¥Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t Ïƒ2, if âˆ’Î³ < 1 Î» PÎ» i=1 ek,t,i < 0 and 1 Î» PÎ» i=1(ek,t,i + Î³)2 < Ïƒ2 w + Ïƒ2 and k âˆˆË†Sf,j t 0, if k âˆˆË†S0 t âˆªË†Sf t . Finally, deï¬ning Î´k,t â‰œPÎ» i=1 ek,t,i, Î¶k,t â‰œPÎ» i=1 e2 k,t,i, Ï±k,t â‰œPÎ» i=1(ek,t,i + Î³)2, and Ï–k,t â‰œPÎ» i=1(ek,t,i âˆ’Î³)2, âˆ€k âˆˆ {1, 2, . . . , K} and âˆ€t > 0, we obtain the simpliï¬ed expressions as given in Proposition 1. REFERENCES [1] H. He and J. Yan, â€œCyber-physical attacks and defences in the smart grid: a survey,â€ IET Cyber-Physical Systems: Theory Applications, vol. 1, no. 1, pp. 13â€“27, 2016. [2] G. Liang, J. Zhao, F. Luo, S. Weller, and Z. Y. Dong, â€œA review of false data injection attacks against modern power systems,â€ IEEE Transactions on Smart Grid, vol. PP, no. 99, pp. 1â€“1, 2016. [3] W. Wang and Z. Lu, â€œCyber security in the smart grid: Survey and challenges,â€ Computer Networks, vol. 57, no. 5, pp. 1344â€“1371, 2013. [4] Y. Yan, Y. Qian, H. Sharif, and D. Tipper, â€œA survey on cyber security for smart grid communications,â€ IEEE Communications Surveys & Tutorials, 2012. [5] L. Xie, Y. Mo, and B. Sinopoli, â€œFalse data injection attacks in electricity markets,â€ in 2010 First IEEE International Conference on Smart Grid Communications, Oct 2010, pp. 226â€“231. [6] R. Moslemi, A. Mesbahi, and J. Mohammadpour, â€œDesign of robust proï¬table false data injection attacks in multi-settlement electricity markets,â€ IET Generation, Transmission & Distribution, 2017. 32 [7] M. Ayar, S. Obuz, R. D. Trevizan, A. S. Bretas, and H. A. Latchman, â€œA distributed control approach for enhancing smart grid transient stability and resilience,â€ IEEE Transactions on Smart Grid, vol. 8, no. 6, pp. 3035â€“3044, 2017. [8] G. Liang, S. R. Weller, J. Zhao, F. Luo, and Z. Y. Dong, â€œThe 2015 ukraine blackout: Implications for false data injection attacks,â€ IEEE Transactions on Power Systems, vol. 32, no. 4, pp. 3317â€“3318, July 2017. [9] S. Amin, A. A. CÃ¡rdenas, and S. S. Sastry, Safe and Secure Networked Control Systems under Denial-of-Service Attacks. Berlin, Heidelberg: Springer Berlin Heidelberg, 2009, pp. 31â€“45. [10] Y. Liu, P. Ning, and M. K. Reiter, â€œFalse data injection attacks against state estimation in electric power grids,â€ in Proceedings of the 16th ACM Conference on Computer and Communications Security, ser. CCS â€™09. New York, NY, USA: ACM, 2009, pp. 21â€“32. [11] S. Tan, D. De, W. Z. Song, J. Yang, and S. K. Das, â€œSurvey of security advances in smart grid: A data driven approach,â€ IEEE Communications Surveys Tutorials, vol. 19, no. 1, pp. 397â€“422, Firstquarter 2017. [12] R. Moslemi, A. Mesbahi, and J. M. Velni, â€œA fast, decentralized covariance selection-based approach to detect cyber attacks in smart grids,â€ IEEE Transactions on Smart Grid, 2017. [13] A. Sargolzaei, K. Yen, M. Abdelghani, A. Abbaspour, and S. Sargolzaei, â€œGeneralized attack model for networked control systems, evaluation of control methods,â€ Intelligent Control and Automation, vol. 08, pp. 164â€“174, 2017. [14] Y. Li, L. Shi, P. Cheng, J. Chen, and D. E. Quevedo, â€œJamming attacks on remote state estimation in cyber-physical systems: A game-theoretic approach,â€ IEEE Transactions on Automatic Control, vol. 60, no. 10, pp. 2831â€“2836, Oct 2015. [15] D. Deka, R. Baldick, and S. Vishwanath, â€œOptimal data attacks on power grids: Leveraging detection measurement jamming,â€ in 2015 IEEE International Conference on Smart Grid Communications (SmartGridComm), Nov 2015, pp. 392â€“397. [16] A. Abur and A. Gomez-Exposito, Power System State Estimation: Theory and Implementation, 01 2004, vol. 24. [17] K. Manandhar, X. Cao, F. Hu, and Y. Liu, â€œDetection of faults and attacks including false data injection attack in smart grid using kalman ï¬lter,â€ IEEE Transactions on Control of Network Systems, vol. 1, no. 4, pp. 370â€“379, Dec 2014. [18] B. Brumback and M. Srinath, â€œA chi-square test for fault-detection in kalman ï¬lters,â€ IEEE Transactions on Automatic Control, vol. 32, no. 6, pp. 552â€“554, Jun 1987. [19] D. B. Rawat and C. Bajracharya, â€œDetection of false data injection attacks in smart grid communication systems,â€ IEEE Signal Processing Letters, vol. 22, no. 10, pp. 1652â€“1656, Oct 2015. [20] M. Esmalifalak, L. Liu, N. Nguyen, R. Zheng, and Z. Han, â€œDetecting stealthy false data injection using machine learning in smart grid,â€ IEEE Systems Journal, vol. 11, no. 3, pp. 1644â€“1652, Sept 2017. [21] M. Ozay, I. Esnaola, F. T. Y. Vural, S. R. Kulkarni, and H. V. Poor, â€œMachine learning methods for attack detection in the smart grid,â€ IEEE Transactions on Neural Networks and Learning Systems, vol. 27, no. 8, pp. 1773â€“1786, Aug 2016. [22] A. S. Bretas, N. G. Bretas, B. Carvalho, E. Baeyens, and P. P. Khargonekar, â€œSmart grids cyber-physical security as a malicious data attack: An innovation approach,â€ Electric Power Systems Research, vol. 149, pp. 210â€“219, 2017. [23] J. Zhao, M. Netto, and L. Mili, â€œA robust iterated extended kalman ï¬lter for power system dynamic state estimation,â€ IEEE Transactions on Power Systems, vol. 32, no. 4, pp. 3205â€“3216, 2017. [24] J. Zhao, L. Mili, and A. Abdelhadi, â€œRobust dynamic state estimator to outliers and cyber attacks,â€ in Power & Energy Society General Meeting, 2017 IEEE. IEEE, 2017, pp. 1â€“5. [25] M. A. Gandhi and L. Mili, â€œRobust kalman ï¬lter based on a generalized maximum-likelihood-type estimator,â€ IEEE Transactions on Signal Processing, vol. 58, no. 5, pp. 2509â€“2520, 2010. [26] S. Li, Y. Yilmaz, and X. Wang, â€œQuickest detection of false data injection attack in wide-area smart grids,â€ IEEE Transactions on Smart Grid, vol. 6, no. 6, pp. 2725â€“2735, Nov 2015. [27] Y. Huang, J. Tang, Y. Cheng, H. Li, K. A. Campbell, and Z. Han, â€œReal-time detection of false data injection in smart grid networks: An adaptive cusum method and analysis,â€ IEEE Systems Journal, vol. 10, no. 2, pp. 532â€“543, June 2016. [28] M. N. Kurt, Y. Yilmaz, and X. Wang, â€œDistributed quickest detection of cyber-attacks in smart grid,â€ IEEE Transactions on Information Forensics and Security, vol. 13, no. 8, pp. 2015â€“2030, Aug 2018. [29] Q. Yang, L. Chang, and W. Yu, â€œOn false data injection attacks against kalman ï¬ltering in power system dynamic state estimation,â€ Security and Communication Networks, vol. 9, no. 9, pp. 833â€“849, 2016. 33 [30] B. Sun, X. Shan, K. Wu, and Y. Xiao, â€œAnomaly detection based secure in-network aggregation for wireless sensor networks,â€ IEEE Systems Journal, vol. 7, no. 1, pp. 13â€“25, 2013. [31] S. Cui, Z. Han, S. Kar, T. T. Kim, H. V. Poor, and A. Tajer, â€œCoordinated data-injection attack and detection in the smart grid: A detailed look at enriching detection solutions,â€ IEEE Signal Processing Magazine, vol. 29, no. 5, pp. 106â€“115, Sept 2012. [32] J. Zhao, G. Zhang, M. L. Scala, Z. Y. Dong, C. Chen, and J. Wang, â€œShort-term state forecasting-aided method for detection of smart grid general false data injection attacks,â€ IEEE Transactions on Smart Grid, vol. 8, no. 4, pp. 1580â€“1590, July 2017. [33] J. Gao, S. A. Vorobyov, H. Jiang, and H. V. Poor, â€œWorst-case jamming on mimo gaussian channels,â€ IEEE Transactions on Signal Processing, vol. 63, no. 21, pp. 5821â€“5836, Nov 2015. [34] S. Gezici, S. Bayram, M. N. Kurt, and M. R. Gholami, â€œOptimal jammer placement in wireless localization systems,â€ IEEE Transactions on Signal Processing, vol. 64, no. 17, pp. 4534â€“4549, Sept 2016. [35] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory. Upper Saddle River, NJ, USA: Prentice-Hall, Inc., 1993. [36] R. E. Kalman, â€œA new approach to linear ï¬ltering and prediction problems,â€ Transactions of the ASMEâ€“Journal of Basic Engineering, vol. 82, no. Series D, pp. 35â€“45, 1960. [37] H. V. Poor and O. Hadjiliadis, Quickest Detection. Cambridge University Press, 2008. [38] M. Basseville and I. V. Nikiforov, Detection of Abrupt Changes: Theory and Application. Upper Saddle River, NJ, USA: Prentice-Hall, Inc., 1993. [39] V. V. Veeravalli and T. Banerjee, â€œChapter 6 - quickest change detection,â€ in Academic Press Library in Signal Processing: Volume 3 Array and Statistical Signal Processing, ser. Academic Press Library in Signal Processing, R. C. Abdelhak M. Zoubir, Mats Viberg and S. Theodoridis, Eds. Elsevier, 2014, vol. 3, pp. 209 â€“ 255. [40] G. Lorden, â€œProcedures for reacting to a change in distribution,â€ Ann. Math. Statist., vol. 42, no. 6, pp. 1897â€“1908, 1971. [41] G. V. Moustakides, â€œOptimal stopping times for detecting changes in distributions,â€ Ann. Statist., vol. 14, no. 4, pp. 1379â€“1387, 1986. [42] â€”â€”, â€œMultiple optimality properties of the shewhart test,â€ Sequential Analysis, vol. 33, no. 3, pp. 318â€“344, 2014. [43] R. Zimmerman, C. Murillo-Sanchez, and R. Thomas, â€œMatpower: Steady-state operations, planning, and analysis tools for power systems research and education,â€ IEEE Transactions on Power Systems, vol. 26, no. 1, pp. 12â€“19, Feb 2011. [44] O. Alsac, N. Vempati, B. Stott, and A. Monticelli, â€œGeneralized state estimation,â€ IEEE Transactions on power systems, vol. 13, no. 3, pp. 1069â€“1075, 1998.