A Cyber Security Study of a SCADA Energy Management System: Stealthy Deception Attacks on the State Estimator ⋆ Andr´e Teixeira a Gy¨orgy D´an b Henrik Sandberg a Karl H. Johansson a aSchool of Electrical Engineering - Automatic Control, KTH Royal Institute of Technology bSchool of Electrical Engineering - Communication Networks, KTH Royal Institute of Technology Abstract The electrical power network is a critical infrastructure in today’s society, so its safe and reliable operation is of major concern. State estimators are commonly used in power networks, for example, to detect faulty equipment and to optimally route power ﬂows. The estimators are often located in control centers, to which large numbers of measurements are sent over unencrypted communication channels. Therefore cyber security for state estimators becomes an important issue. In this paper we analyze the cyber security of state estimators in supervisory control and data acquisition (SCADA) for energy management systems (EMS) operating the power network. Current EMS state estimation algorithms have bad data detection (BDD) schemes to detect outliers in the measurement data. Such schemes are based on high measurement redundancy. Although these methods may detect a set of basic cyber attacks, they may fail in the presence of an intelligent attacker. We explore the latter by considering scenarios where stealthy deception attacks are performed by sending false information to the control center. We begin by presenting a recent framework that characterizes the attack as an optimization problem with the objective speciﬁed through a security metric and constraints corresponding to the attack cost. The framework is used to conduct realistic experiments on a state-of-the-art SCADA EMS software for a power network example with 14 substations, 27 buses, and 40 branches. The results indicate how state estimators for power networks can be made more resilient to cyber security attacks. 1 Introduction Examples of critical infrastructures in our society are the power, the gas and the water supply networks. These infrastructures are operated by means of complex supervisory control and data acquisition (SCADA) systems, which transmit information through wide and local area networks to a control center. Because of this fact, critical infrastructures are vulnerable to cyber attacks, see [1,2]. For a more recent example that also received considerable media attention, see [3]. SCADA systems for power networks are complemented by a set of application speciﬁc software, usually called energy management systems (EMS). Modern EMS provide information support for a variety of applications related to power network monitoring and control. The power network state estimator (SE) is an on-line application which uses redundant measurements and a network model to provide the EMS with an accurate state estimate at all times. The SE has become an integral tool for EMS, for instance for contingency analysis (CA) which, based on the state estimate, identiﬁes the most severe consequences in case of hypothetical equipment outages. SCADA systems collect measurement data from remote terminal units (RTUs) installed in various substations, and relay aggregated measurements to the central master station located at the control center. A simple schematic picture of such a system is shown in Fig. 1, with measurements denoted by z. Several cyber attacks on SCADA systems operating power networks have been reported, and major blackouts, such as the August 2003 Northeast U.S. blackout, are due ⋆This work was supported in part by the European Commission through the VIKING project, the Swedish Research Council, the Swedish Foundation for Strategic Research, and the Knut and Alice Wallenberg Foundation. arXiv:1011.1828v1 [math.OC] 8 Nov 2010 Power Grid State Estimator + Bad Data Detection Contingency Analysis Optimal Power Flow Operator Attacker Control Center z = h(x) ˆx r = z−ˆz ˆx Alarm! u∗ u a Fig. 1. The state estimator under a cyber attack to the misuse of the SCADA systems, see [4]. As discussed in [1], there are also several vulnerabilities in the SCADA system architecture, including the direct tampering of RTUs, communication links from RTUs to the control center, and the IT software and databases in the control center. Our work analyzes the cyber security of the SE in the SCADA system of a power network. In current implementations of SE algorithms, there are bad data detection (BDD) schemes [5,6] designed to detect random outliers in the measurement data. Such schemes are based on high measurement redundancy and are performed at the end of the state estimation process. Although such methods may detect basic cyber attacks on the measurements, they may fail in the presence of a more intelligent attacker. It is well known that for so-called multiple interacting bad data, the BDD system can fail to detect and locate the faulty measurements, see [5,6]. That an attacker can exploit this fact has been pointed out in several recent papers, see [7,8,9]. For example, it has been shown that an attacker with access to a model of the network systematically can search for, and often ﬁnd, simple undetectable attacks. Returning to Fig. 1, this means it is possible to compute data corruptions a to measurements z that will not generate alarms in the control center. Such corruptions are called stealthy deception attacks. In the work [7,8,9], it is assumed that the attacker has a linear accurate model of the power grid, and undetectability of the corruption a is proven under this assumption. The real power network is nonlinear, however, and a nonlinear model is also typically implemented in the SE. Therefore, it is not clear how a real SE will react to these stealthy deception attacks. For example, how large can a be before the SE does no longer converge? In [10], we have quantiﬁed how the SE residual can be bounded based on the model error, but no tests on an actual system were performed. The main contribution of this paper is to test how sensitive a state-of-the-art SCADA system SE is to stealthy deception attacks. Maybe somewhat surprisingly, for the cases we have studied, the attacks indeed pass undetected for very large corruptions a. However, our analysis also shows that it is possible to make these attacks much more diﬃcult to perform by allocating new sensors, or by securing some of them. Secure sensor allocation has also been discussed in [9,11]. The outline of the paper is as follows. In Section 2 we present the theoretical concepts behind state estimation in power networks. Results from previous work are used in Section 3 to develop the analysis framework and some novel considerations regarding limitations of linear attack policies are also given. Section 4 contains the main contribution of this paper, the description and results of practical experiments conducted in a state-of-the-art SCADA/EMS software using the previously mentioned framework. The conclusions are presented in Section 5. 2 Preliminaries In this section we introduce the power network models and the theory behind the SE and BDD algorithms. 2.1 Measurement model For an N−bus electric power network, the n = 2N −1 dimensional state vector x is (θ⊤, V ⊤)⊤, where V = (V1, . . . , VN) is the vector of bus voltage magnitudes and θ = (θ2, . . . , θN) vector of phase angles. This state vector is the minimal information needed to characterize the operating point of the power network. Without loss of generality, we have considered bus 1 to be the reference bus, hence all phase-angles are taken relatively to this bus and θ1 = 0. The m−dimensional measurement vector z can be grouped into two categories: (1) zP , the active power 2 ﬂow measurements Pij from bus i to j and active power injection measurement Pi at bus i, and (2) zQ, the reactive power ﬂow measurements Qij from bus i to j, reactive power injection measurement Qi and Vi voltage magnitude measurement at bus i. The neighborhood set of bus i, which consists of all buses directly connected to this bus, is denoted by Ni. The power injections at bus i are described by Pi = Vi P j∈Ni Vj (Gij cos(θij) + Bij sin(θij)) Qi = Vi P j∈Ni Vj (Gij sin(θij) −Bij cos(θij)) , and the power ﬂows from bus i to bus j are described by Pij = V 2 i (gsi + gij) −ViVj (gij cos(θij) + bij sin(θij)) Qij = −V 2 i (bsi + bij) −ViVj (gij sin(θij) −bij cos(θij)) , where θij = θi −θj is the phase angle diﬀerence between bus i and j, gsi and bsi are the shunt conductance and susceptance of bus i, gij and bij are the conductance and susceptance of the branch from bus i to j, and Yij = Gij + jBij is the ijth entry of the nodal admittance matrix. More detailed formulas relating measurements z and state x may be found in [6]. Assuming that the model parameters and the network topology are exact, the nonlinear measurement model for state estimation is deﬁned by z = h(x) + ϵ, (1) where h(·) is the m−dimensional nonlinear measurement function that relates measurements to states and is assumed to be twice continuously diﬀerentiable, ϵ = (ϵ1, . . . , ϵm)⊤the zero mean measurement error vector, and usually m ≫n meaning that there is high measurement redundancy. Here ϵi are independent Gaussian variables with respective variances σ2 i indicating the relative uncertainty about the i−th measurement and thus we have ϵ ∼N(0, R) where R = diag(σ2 1, . . . , σ2 m) is the covariance matrix. 2.2 State Estimator The basic SE problem is to ﬁnd the best n-dimensional state x for the measurement model (1) in a weighted least square (WLS) sense. Deﬁning the residual vector r(x) = z −h(x), we can write the WLS problem as min x∈Rn J(x) = 1 2r(x)⊤R−1r(x) such that g(x) = 0 s(x) ≤0, (2) where the inequality constraints generally model saturation limits, while the equality constraints are used to include target setpoints and to ensure physical laws such as zero power injection transition buses, e.g., transformers, and zero power ﬂow in disconnected branches. Thus data used in the equality constraints is often seen as pseudo- measurements. For sake of simplicity, we will present the solution to the unconstrained optimization problem. More detailed information on the solution of (2) may be found in [6] and [5]. The unconstrained WLS problem is posed as min x∈Rn J(x) = 1 2r(x)⊤R−1r(x). The SE yields a state estimate ˆx as a minimizer to this problem. The solution ˆx can be found using the Gauss-Newton method which solves the so called normal equations:  H⊤(xk)R−1H(xk)  (∆xk) = H⊤(xk)R−1r(xk), (3) 3 for k = 0, 1, . . ., where H(xk) := dh(x) dx |x=xk is called the Jacobian matrix of the measurement model h(x). For an observable power network, the measurement Jacobian matrix H(xk) is full column rank. Consequently, the matrix  H⊤(xk)R−1H(xk)  in (3) is positive deﬁnite and the Gauss-Newton step generates a descent direction, i.e., for the direction ∆xk = xk+1 −xk the condition ∇J(xk)⊤∆xk < 0 is satisﬁed. Remark 1 Henceforth we consider the covariance matrix R to be the identity matrix, i.e., all measurements have unitary weights. The framework and results presented in the next sections can be easily extended to the more general case, see [10]. For notational convenience, throughout the next sections we will use H(xk) as H, ∆xk as ∆x, and r(xk) = z −h(xk) as r. 2.3 Decoupled State Estimation A useful observation in electric power networks is that of active-reactive decoupling, i.e., the active measurements zP (resp. reactive measurement zQ) predominantly aﬀect the phase angles θ (resp. the voltage magnitudes V ). In the decoupled state estimation, the approximate values of the corrections ∆θ and ∆V are then not computed simultaneously, but independently [12]. Following (3), the correction to state estimate ∆x = (∆θ⊤, ∆V ⊤)⊤at each iteration can be obtained from the weighted measurement residual r = (r⊤ P , r⊤ Q)⊤as the solution to the overdetermined system HP θ HP V HQθ HQV ! ∆θ ∆V ! = rP rQ ! , (4) where the submatrices HP θ and HP V correspond to active measurements and HQθ and HQV correspond to reactive measurements. The traditional version of fast decoupled state estimation is based on the following decoupled normal equations, where the coupling submatrices HP V and HQθ have been set to zero: ∆θk = H† P θrP (θk, V k), ∆V k = H† QV rQ(θk, V k). (5) Equations (5) are alternately solved for ∆θk and ∆V k, where the mismatches rP and rQ are evaluated at the latest estimates. The submatrices HP θ and HQV are evaluated at ﬂat start and branch series resistances are ignored in forming HP θ. By ﬂat start we mean the power network’s state in which all voltage magnitudes are 1 pu and all phase angles are 0. 2.4 Bad Data Detection The measurement residual when random bad data is present is characterized as follows. Assume there are no measurement errors, i.e. z = h(x), and that the SE has converged through the Gauss-Newton method. Recalling that r(ˆx) = z−h(ˆx), from (3) we see that the estimate sensitivity matrix is given by ∂ˆx ∂z = (H⊤H)−1H⊤. Furthermore, we conclude that the weighted residual sensitivity matrix is ∂r ∂z = I −∂h(ˆx) ∂ˆx ∂ˆx ∂z = I −H(H⊤H)−1H⊤. Thus for small measurement errors ϵ ∼N(0, I) we have the following weighted measurement residual r = Sϵ, (6) where S = I −H(H⊤H)−1H⊤. Through BDD the SE detects measurements corrupted by errors whose statistical properties exceed the presumed standard deviation or mean. This is achieved by hypothesis tests using the statistical properties of the weighted measurement residual (6). We now introduce one of the BDD hypothesis tests widely used in practice, the largest normalized residual test. 4 2.4.1 Largest normalized residual test From (6), we note that r ∼N(0, Ω) with Ω= S. Now consider the normalized residual vector rN = D−1/2r, (7) with D ∈Rm×m being a diagonal matrix deﬁned as D = diag(Ω). In the absence of bad data each element rN i , i = 1, . . . , m of the normalized residual vector then follows a normal distribution with zero mean and unit variance, rN i ∼N(0, 1), ∀i = 1, . . . , m. Thus, bad data could be detected by checking if rN i follows N(0, 1). This can be posed as a hypothesis test for each element rN i H0 : E  rN i = 0, H1 : E  |rN i |) > 0. For this particular case, as shown in [5], the largest normalized residual (LNR) test corresponds to a threshold test where the threshold τ is computed for a given false alarm rate and H0 is accepted if ∥D−1/2r∥∞≤τ, (8) and rejected otherwise. 3 Stealthy deception attacks Using the theory and models described in the previous section, we present the framework used throughout the next sections to study the cyber security of SCADA EMS software and algorithms. 3.1 Attacker Model The goal of a stealthy deception attacker is to compromise the telemetered measurements available to the SE such that: 1) The SE algorithm converges; 2) The attack remains undetected by the BDD scheme; and 3) For the targeted set of measurements, the estimated values at convergence are close to the compromised ones introduced by the attacker. Let the corrupted measurement be denoted za. We assume the following additive attack model za = z + a, (9) where a ∈Rm is the attack vector introduced by the attacker, see also Fig. 1. The vector a has zero entries for uncompromised measurements. Under attack, the normal equations (3) give the estimates ˜xk+1 = ˜xk +  H⊤(˜xk)H(˜xk) −1 H⊤(˜xk)ra(˜xk), (10) for k = 0, 1, . . . , where ˜xk is the biased estimate at iterate k, and ra(˜xk) := za −h(˜xk). If the local convergence conditions hold, then these iterations converge to ˆxa, which is the biased state estimate resulting from the use of za. Thus, the convergence behavior can be expressed as the following statement: 1) The sequence {˜x0, ˜x1, . . . } generated by (10) converges to a ﬁxed point ˆxa. We will occasionally use the notation ˆxa(za) to emphasize the dependence on za. The BDD scheme for SE is based on a threshold test. Thus the attacker’s action will be undetected by the BDD scheme provided that the following condition holds: 2) The measurement residual under attack ra := r(ˆxa) = za −h(ˆxa), satisﬁes the condition (8). 5 Finally, consider that the attacker aims at corrupting measurement i. This means the attacker would like the estimated measurement ˆza i := hi(ˆxa(za)) to be equal to the actual corrupted measurement za i . Therefore, we arrive at the following condition which will additionally govern the synthesis of attack vector a: 3) The attack vector a is chosen such that |za i −ˆza i | = 0. The aim of a stealthy deception attacker is then to ﬁnd and apply an attack a that satisﬁes conditions 1), 2), and 3). This problem can be posed as ﬁnd a s.t. a ∈G ∩C ∩U , (11) where G is the set of goals in condition 3), C the set of constraints ensuring condition 1) is met and that no protected or pseudo-measurements are corrupted, and U the set of stealthy attacks satisfying condition 2). 3.2 Security Metric In general a stealthy attack requires the corruption of more measurements than the targeted one, see [7] and [8]. Such requirement relates to the fact that a stealthy attack must have the attack vector a ﬁtting the measurement model. Considering that the system’s state is x∗and the attacks are suﬃciently small, the measurement model can be linearized around x∗, obtaining z = dh(x) dx |x=x∗(x∗+ c) = H(x∗+ c), (12) where c is the perturbation added to x∗. Previous results show that the class of stealthy attacks for this linear model is characterized by a ∈Im(H), which is equivalent to have a = Hc, for some c ̸= 0. Based on this linear model, we present a security metric αk for each measurement k. This metric corresponds to the minimum cost of a valid attack satisfying (11) and targeting to corrupt measurement k by adding it one unit, i.e., ak = 1. It is computed by solving the problem αk = min a ∥a∥0 s.t. a ∈G ∩C ∩U , (13) where here a ∈G corresponds to having ak = 1, a ∈C to ai = 0 , ∀i if measurement i is a pseudo-measurement, and a ∈U to a ∈Im(H). Note that ∥· ∥0 is a pseudo-norm corresponding to the cardinality, i.e., number of non-zero entries, of the argument. Hence the cost αk corresponds to the minimum cardinality of a valid attack a, i.e., the minimum number of sensors needed to be corrupted. This metric can also be extended to cases where by compromising a single measurement, the attacker gains access to other measurements without additional cost. For a more detailed discussion on this metric and eﬃcient algorithms to compute it, see [11]. 3.3 Limitations of Linear Policies In this section we comment on the limitations of the linear attack policies described in Section 3.2. Recall that the core of the linear policies is to have a ∈Im(H). Two main limitations arise from this policy, one related to the fact that H is obtained for given operating conditions and the other related to saturation limits not considered by the linear measurement model (12). We brieﬂy discuss about these limitations. 3.3.1 Varying operating conditions The power network is a dynamical system and its state is frequently changing. Thus it might be the case that the attacker has previously obtained a linear model ˜H for a state ˜x and the attack is performed only when the system is in a diﬀerent state x∗where the linear approximation is H. Hence for small attack vectors or for cases where x∗≈˜x, the residual will be small and the attack may pass undetected. For larger attacks, however, this might not hold. These scenarios can be analyzed using the framework presented in [10], where it is considered that the attacker has an inaccurate model ˜H. 6 One interesting fact to observe is that, under certain assumptions, the attack vector a and the security metric α will be the same, independently of the system’s state. We now present a useful lemma and the required assumptions and formulate this result. Lemma 1 Consider an optimal attack a∗that is undetectable with respect to H, i.e., a∗∈Im(H) and has minimum cardinality. Denote by U the set of measurements not aﬀected by a∗, i.e., a∗ i = 0 ∀i ∈U and a∗ i ̸= 0 ∀i ̸∈U. Let the Jacobian matrix be partitioned as H = [H⊤ U H⊤ ¯U ]⊤. Recalling that n is the number of states and that rank(H) = n, then rank(HU) = n −1, and for every i ̸∈U we have rank(HU∪{i}) = n. PROOF. See [11]. Assumption 1 For any measurement element zi we have ∂hi(x∗) ∂xj = 0 if and only if ∂hi(˜x) ∂xj = 0, for all j = 1, . . . , n. Proposition 2 Denote F as the set of power ﬂow measurements. Consider H = HP θ(θ)|θ=θ∗, ˜H = HP θ(θ)|θ=˜θ, and let a be a stealthy deception attack vector with respect to H. Denote the set of measurements not corrupted by a as U. Then for all the line parameter perturbations and state changes from θ∗to ˜θ that satisfy Assumption 1 and do not aﬀect measurements j ∈F ∩¯U, we have that a is also a stealthy attack with respect to ˜H. PROOF. In the following we consider the matrix HP Θ and use H instead to simplify the notation. We consider a perturbation in the linear model, e.g., due to varying operating conditions, such that for a measurement k ∈F corresponding to a transmission line we have ˜Hk = bHk. Let us denote the buses at the two ends of the transmission line by k1 and k2. For the power injection at bus k1 (closest to measurement k) we have ˜Hk1 = Hk1 + (b −1)Hk, for bus k2 we have ˜Hk2 = Hk2 −(b −1)Hk. In the following we show that if k ∈F ∩U, then for every a ∈Im(H) there is ˜a ∈Im( ˜H) such that a = ˜a. Since this also holds for minimum cardinality attack vectors, we have that the security metric α is the same for both linearized models. For the case when k ∈U we can prove the proposition by performing elementary row operations on ˜HU. If k1 ∈U we subtract (b −1)/b ˜Hk from ˜Hk1. We proceed similarly for k2. Finally, we divide ˜Hk by b. Clearly, after these operations we obtained HU, which, following Lemma 1, proves that rank( ˜HU) = n −1. Observe that since we used elementary row operations, the kernel of ˜HU is the same as that of HU. Consequently, the same attack vectors can be used despite the perturbation of the model, i.e., a ∈Im(H) ∩Im( ˜H). Hence we conclude that if the state or parameter perturbations do not aﬀect power ﬂow measurements compromised by the attack before the change, then the same attack vector is still valid after the parameter or state change. Note that this is ensured if the measurements aﬀected by the parameter change are far from the region of the network where the attack is performed. Thus this indicates that attacks can be performed locally in the power network. Additionally, in this case the security metric is the same for both linearized models and there is no need to recompute it again for the diﬀerent state. 3.3.2 Saturation limits The linear measurement model (12) is obtained by linearizing the nonlinear model (1) at a given state x∗and so the linear model only approximates well the nonlinear one in a region close to x∗. Furthermore, the more nonlinear the function is around x∗, the smaller is the region where the approximation is valid. This fact is particularly important when the saturation occurs. From considering (12) alone we do not have any limits on the size of a = Hc. However, the nonlinear model clearly shows that the measurements have saturation limits. For instance, disregarding the line and shunt conductances gij and gsi we have Pij = −ViVjbij sin(θij), where we see that the theoretical maximum for this power ﬂow is given by Pij = −ViVjbij. Hence for a stealthy attack it is not enough to require that a ∈Im(H) but it is also essential to impose saturation limits on the attacked measurements. These limits could be formulated as inequality constraints and included in the set of constraints C, in general reducing the set of valid attacks. 7 Fig. 2. Power network considered in the experiment, where the gray and brown colors represent unenergized and energized objects, respectively. 4 Experiments on the SCADA EMS system During the previous sections we have mentioned recent work where the authors analyzed stealthy deception attacks on SE based on linearized models. However, the results obtained so far do not clarify how sensitive the real SCADA EMS software is to these attacks or if a system operator should even care about these scenarios. In this section we present the results obtained by carrying out a stealthy deception attack on a real SCADA EMS software. We hope, by analyzing these results, to answer the previous open questions and also to provide recommendations to increase the security of SCADA EMS software against deception attacks. Before analyzing the results, we brieﬂy describe the experimental setup. 4.1 Experimental Setup The software was supplied with the virtual network presented in Fig. 2, similar to the IEEE 39 bus network. The power network in Fig. 2 consists of 14 substations and the bus-branch model has 27 buses and 40 branches. Several measurements are available at each substation, such as voltage magnitudes, active and reactive power ﬂows and injections, and transformer tap change positions. This data is kept in the software database. We have used a console- based static network simulator to carry out the data corruption by directly changing the measurement data in the database. The presented results thus relate to data corruption attacks and the consequences of such attacks on the EMS software components. Speciﬁc EMS components, such as SE and BDD, are conﬁgured with unitary weights for all the measurements. The SE solves the nonlinear weighted least-squares problem using the fast-decoupled algorithm with equality constraints, while the BDD algorithm uses the LNR test. Both approaches correspond to standard algorithms presented in Section 2. As described in previous sections, some information about the power network is needed to compute stealthy deception attacks. Here we consider a particular class of such information, namely the bus-branch model of the network. In this experiment, we exported this information to MATLAB using the MATPOWER toolbox, [13]. A simpliﬁed attack was considered in which only the DC model of the network was used. This corresponds to including only active power measurements in the set of corrupted measurement data, disregarding the reactive measurements, not taking into account the current operating state of the system, not the coupling between the active power and the voltage magnitudes, and not the line conductances or the shunt admittances. Hence all voltage magnitudes were assumed to be 1 pu and the phase-angles 0. Only a simpliﬁed version of the HP θ submatrix in (4) was used, hereby denoted HDC. The algorithm in [11] was used to compute the security metrics for each measurement. Information regarding which measurements were assumed to be tamper-proof was taken in account. Such measurements correspond to pseudo- 8 Table 1 Example: adding 100MW to target measurement 33 Measurement Normalized Correct value False value index, k attack, ¯ak (MW), z∗ k (MW), za k 4 -1 1005.7041 905.7042 21 -0.7774 157.8541 80.1103 24 0.9665 507.7171 604.3638 27 2.7439 40.0006 314.3911 33 1 -14.7971 85.2029 62 0.7774 -123.3764 -45.6327 104 -0.9665 -334.8826 -431.5293 measurements, which are considered as equality constraints in the optimization problem, and are often based on physical principles, see [5]. The result is presented in Fig. 3. Given the current conﬁguration of the SCADA EMS, speciﬁcally which measure- ments are available, we computed the security metric αk (the red full circles) as deﬁned in Section 3.2. We see that the result is very heterogeneous, since around a third of the measurements has low values between 3 and 4, another third has values between 6 and 10, and others, which are not depicted, have values greater than 20 or even αk = ∞. Recalling that αk is the minimum number of measurements needed to perform a stealthy attack on measurement k, we conclude that measurements with low αk are easily attacked while the ones with αk = ∞are fully protected. Increasing the redundancy of the system by adding more measurements to the SCADA system increases the security level, as we see by looking at how ¯αk is larger than αk. However, note that this does not guarantee full protection, as all measurements with ﬁnite αk still have ﬁnite ¯αk. 0 10 20 30 40 50 60 0 5 10 15 20 Target measurement index Security metric Fig. 3. Security metrics for each measurement k: αk (red full circles) was computed taking in account which measurements are available in the SCADA EMS, while ¯αk (blue rings) was computed assuming that all possible measurements are being taken. Both represent the minimum number of measurements needed to perform a stealthy attack on the target measurement k. 4.2 Attack Scenario To conduct our experiment we considered measurement number 33, corresponding to the active power ﬂow on the tie-line between TROY and BLOO substations, to be the target measurement. This means that the attacker’s goal is to change this power ﬂow measurement value as he/she wishes. In order to do so without being detected, the attacker needs to perform a coordinated attack in which he/she corrupts the value of other power measurements. Following the framework presented in Section 3, the set of such malicious changes is encoded in the attack vector a, which is then added to the true measurement vector z. The corrupted measurement vector za = z + a is the one used by the SE. Using HDC, we computed the additive normalized attack vector required to stealthily change the target measurement by 1 MW, presented in Table 1. As seen in Fig. 3, such attack only corrupts 7 measurements in total, which are taken from 5 substations, namely TROY, BLOO, JUNE, MONR, and CROS, all situated in the right side of Fig. 2. 9 −20 −10 0 10 20 30 40 −20 −10 0 10 20 30 40 Target measurement value (MW) Estimated value (MW) Attacks on measurement 33 naive stealthy no attack Fig. 4. Stealthy deception attack Table 2 Results from the stealthy attack for large bias Target bias, False value Estimate #BDD #CA a33 (MW), za 33 (MW), ˆza 33 Alarms Alarms 0 -14.8 -14.8 0 2 50 35.2 36.2 0 2 100 85.2 86.7 0 10 150 135.2 137.5 0 27 200 185.2 - - - Hence we see that to stealthily attack a single measurement, a local coordinated attack suﬃces, even for such a large system. Additionally, as discussed in [11], note that usually all measurements within a given substation are gathered at a single RTU. This means that by breaking into the substation’s RTU the attacker gains access to all those measurements, so we can argue that although 7 measurements need to be corrupted, only 5 RTU’s need to be compromised. 4.3 Experimental Results The normalized attack vector ¯a, whose non-zero entries are shown in Table 1, was used to corrupt the measurement data according to the attacker’s objective. For instance, in Table 1 we can see the correct value of the compromised measurements, denoted by z∗, and the false values sent to the control center, za, when the objective was to induce a bias of 100MW in the target measurement, having za = z∗+ 100¯a. In Fig. 4 we show the results obtained by performing stealthy deception attacks as described before and naive decep- tion attacks where only the target measurement is compromised. In both cases, the bias in the target measurement was sequentially increased by 10MW at each step. From these results we see that the naive attack was undetected up to a bias of 20MW, while for bias above 30MW this attack was detected and the compromised measurement removed. The coordinated stealthy attack, however, remained undetected for all the bias values showed in the ﬁgure. Furthermore we see that the naive attack did not inﬂuence the estimate as much as the stealthy one, for which the relationship between the false and the estimated values is an almost unitary slope. Table 2 shows the results obtained for large bias, where the attacks were performed sequentially with steps of 50MW. We observe that the stealthy attacks were successful with no BDD alarm triggered up to a bias of 150MW, beyond which the SE no longer converged. Although the SE did not converge for attacks above 200MW, it is still surprising to see that attacks based on the linearized model as large as 150MW are successful. To better understand what such quantity indicates, note that 10 the nominal value of the targeted tie-line is 260MW. Thus the attack was able to induce a bias of more than 50% of the nominal value, which reveals that the SCADA EMS software is indeed sensitive to stealthy deception attacks. Furthermore, notice that the number of warnings given by the CA component increase with the size of the attack. Whether or not this trend is related to the fact that the coupling terms have been neglected is still a matter for future analysis. Nevertheless, note that the increased number of CA warnings could lead the operator to take corrective actions. Therefore, we conclude that operators and utilities should care about these scenarios. We also want to highlight that these results were achieved with a simpliﬁed linear model where several parameters, including the correct operating conditions and cross-coupling eﬀects between active and reactive measurements, were disregarded. However in these scenarios we assumed the attacker had a large amount of resources such as a rather detailed knowledge regarding the network model, the available measurements, and the pseudo-measurements, and access to several RTUs. Most likely, an attacker with such resources could perform more devastating attacks on the power network than the ones considered here. 5 Conclusions In this paper we presented a comprehensive framework to analyze and study a class of stealthy deception attacks speciﬁcally targeting the SE component of SCADA EMS software through measurement data corruption. This framework provides attacker and attack cost models, possible attack synthesis policies, and system security metrics. The system security metric can be used by the utility to strengthen the security of the system by allocation of new sensors. Some limitations of the linear attack policies were brieﬂy discussed. To validate this framework, we conducted a set of deception attacks to a state-of-the-art SCADA EMS software. The results obtained by this experiment show that computations based on linear models of the system provide valid attacks that successfully corrupt the target measurements without triggering any BDD alarms. The results also indicate that linear models can be used for large attacks as well, although otherwise expected. Additionally, we showed that besides the measurement model, information concerning pseudo-measurements and saturation limits is needed for a successful stealthy attack. This study also shows that improved BDD schemes and methods to ensure measurement and data protection are desirable. Acknowledgements The authors would like to thank Mr. Moustafa Chenine and Mr. Nicholas Honeth for their helpful technical support. References [1] A. Giani, S. Sastry, K. H. Johansson, and H. Sandberg, “The VIKING project: an initiative on resilient control of power networks,” in Proc. 2nd Int. Symp. on Resilient Control Systems, (Idaho Falls, ID, USA), pp. 31–35, Aug. 2009. [2] A. C´ardenas, S. Amin, and S. Sastry, “Research challenges for the security of control systems.,” in Proc. 3rd USENIX Workshop on Hot topics in security, July 2008. [3] Symantech, “Stuxnet introduces the ﬁrst known rootkit for industrial control systems,” August 6th 2010. [4] U.S.-Canada Power System Outage Task Force, “Final report on the August 14th blackout in the United States and Canada,” tech. rep., April 2004. [5] A. Monticelli, State Estimation in Electric Power Systems: A Generalized Approach. Kluwer Academic Publishers, 1999. [6] A. Abur and A. Exposito, Power System State Estimation: Theory and Implementation. Marcel-Dekker, 2004. [7] Y. Liu, M. K. Reiter, and P. Ning, “False data injection attacks against state estimation in electric power grids,” in Proc. 16th ACM Conf. on Computer and Communications Security, (New York, NY, USA), pp. 21–32, 2009. [8] H. Sandberg, A. Teixeira, and K. H. Johansson, “On security indices for state estimators in power networks,” in Preprints of the First Workshop on Secure Control Systems, CPSWEEK 2010, Apr. 2010. [9] R. Bobba, K. M. Rogers, Q. Wang, H. Khurana, K. Nahrstedt, and T. Overbye, “Detecting false data injection attacks on DC state estimation,” in Preprints of the First Workshop on Secure Control Systems, CPSWEEK 2010, Apr. 2010. [10] A. Teixeira, S. Amin, H. Sandberg, K. H. Johansson, and S. S. Sastry, “Cyber security analysis of state estimators in electric power systems,” in Proc. of 49th IEEE Conf. on Decision and Control, Dec. 2010. To appear. [11] G. D´an and H. Sandberg, “Stealth attacks and protection schemes for state estimators in power systems,” in Proc. of IEEE SmartGridComm, Oct. 2010. [12] F. F. Wu, “Power system state estimation: a survey,” Int. J. Elec. Power and Energy Systems, Apr. 1990. [13] R. D. Zimmerman, C. E. Murillo-S´anchez, and R. J. Thomas, “MATPOWER’s extensible optimal power ﬂow architecture,” in Power and Energy Society General Meeting, pp. 1–7, IEEE, July 2009. 11