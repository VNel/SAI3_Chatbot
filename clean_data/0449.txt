Smart Grid Security: A Verified Deep Reinforcement Learning Framework to Counter Cyber-Physical Attacks Suman Maiti, Soumyajit Dey Department of Computer Science and Engineering, Indian Institute of Technology, Kharagpur, India Abstract—The distributed nature of smart grids, combined with sophisticated sensors, control algorithms, and data col- lection facilities at Supervisory Control and Data Acquisition (SCADA) centers, makes them vulnerable to strategically crafted cyber-physical attacks. These malicious attacks can manipulate power demands using high-wattage Internet of Things (IoT) botnet devices, such as refrigerators and air conditioners, or introduce false values into transmission line power flow sensor readings. Consequently, grids experience blackouts and high power flow oscillations. Existing grid pro- tection mechanisms, originally designed to tackle natural faults in transmission lines and generator outages, are ineffective against such intelligently crafted attacks. This is because grid operators overlook potential scenarios of cyber-physical attacks during their design phase. In this work, we propose a safe Deep Reinforcement Learn- ing (DRL)-based framework for mitigating attacks on smart grids. The DRL agent effectively neutralizes cyber-physical attacks on grid surfaces by triggering appropriate sequences of existing protection schemes. The safety of the DRL agent is formally verified through a reachability analysis method. Additionally, our framework is designed for deployment on CUDA-enabled GPU systems, which enables faster execution of these protection sequences and their real-time validation. Our framework establishes a new set of protection rules for grid models, successfully thwarting existing cyber-physical attacks. 1. Introduction Modern smart grids utilize advanced sensors spread across vast regions and real-time communication methods to distribute electricity efficiently [1], [2]. These grids utilize software controls, intelligent sensing, and connectivity to ensure sustainable operations. However, their distributed nature also renders them susceptible to malicious attacks. Attackers can manipulate sensors or remote components in specific regions to distort power flow measurements. Such attacks can lead to unfair power scheduling, creating imbal- ances in power supply and demand and resulting in black- outs for critical facilities [3], [4]. Incidents of such attacks have caused significant damage to consumer appliances and infrastructure. For example, in 2015, a coordinated Load Alteration Attack (LAA) on Ukrainian Load Dispatch Centers (LDCs) led to widespread outages affecting thou- sands of customers. Additionally, sudden shifts in power de- mand, caused by the simultaneous on-off sequences of high- wattage IoT devices [5], [6], can disrupt system frequency and lead to cascading failures. Coordinated cyber-physical attacks pose a major threat to modern power grids, targeting sensors, actuators, and communication channels used for control and monitoring. Common types of cyber-physical attacks include False Data Injection Attacks (FDIAs) and LAAs, which involve falsifying sensor data and manipulat- ing grid-connected loads. Such attacks can disrupt Automatic Generation Control (AGC) units and have been extensively studied for their impact on grid stability in [7], [8], [9], [10], [11]. Existing research on grid security [9], [12], [13] suggests incorporating Bad Data Detectors (BDDs) into grid models to detect attack vectors that lead to anomalous grid behavior. However, these BDD units consider only a single state of the grid (operational frequency) and neglect transient dynamics during their design phase, rendering them ineffective against carefully crafted False Data Injection Attacks (FDIAs) [14]. Researchers of [15], [16] claim that existing grid protection mechanisms can mitigate Load Altering Attacks (LAAs), re- quiring adversaries to access a vast number of high-wattage IoT botnets to compromise grid behavior. The work in [17] suggests that the grid models used in existing research on grid vulnerability analysis have design flaws due to the absence of crucial control and protection scheme imple- mentations, making the synthesis of attack vectors easier. Contradicting the claims made in [15], [16], and [17], re- searchers in [6] demonstrated that strategically selecting grid buses with the lowest voltage stability index requires signif- icantly fewer botnets to render the grid unsafe, even with protection schemes. In [18], a Deep Reinforcement Learning (DRL) agent was utilized to craft FDIA vectors on power flow sensor measurements, successfully compromising stan- dard IEEE bus models despite the presence of AGCs and protection mechanisms. Notably, the attack vectors in this case remained undetected by the BDD units incorporated into the grid model. These findings imply that existing grid protection strategies [15] are ineffective against state-of-the- art intelligent attack synthesis frameworks that strategically launch attacks on grid surfaces. This underperformance can be attributed to three main reasons. (i) Existing protection mechanisms entail significant delays before activation. This delay arises from a hard-bound predefined threshold based on the grid’s operating frequency, beyond which protection schemes are triggered with a fixed time delay [15]. (ii) The arXiv:2409.15757v1 [cs.CR] 24 Sep 2024 action space of the protection schemes is limited; they can only shed a preset amount of load or trip all the generators. (iii) Grid protection mechanisms are not formulated with sophisticated cyber-physical attacks in mind. Our work addresses the limitations of existing protection mechanisms by adaptively adjusting their activation time and action space according to the attack scenarios. This is accomplished by utilizing a trained DRL defender agent which generates effective activation sequences for the exist- ing protection schemes and prevents the grid from blackout and damage to customer equipment [15]. However, due to the Reinforcement Learning model’s black-box nature, the defender agent’s actions can be somewhat unpredictable. To address this, it is crucial to formally validate the agent to ensure that it operates safely on deployment in smart grid environments. Therefore, we conduct a reachability analysis on the trained neural network for the agent to check whether there is any overlap with conditions that could lead to unsafe grid operations. Furthermore, our work introduces transient-sensitive anomaly detection units, which are in- tegrated with the generator units within the grid model. These detection units are designed to consider all the grid states. The defender agent also incorporates the responses of these detector units to plan its action sequences, aiming to mitigate the attack’s impact quickly. An overview of our grid protection framework is depicted in Fig. 1. In summary, Grid Simulation Model Opal-RT HIL setup Anomaly Detector: ||r||∞ > Th States States Attack scenarios Adversary Observations Defender NN Verification GPU- deployment Residue readings Protection scheme Activation sequences 1 1 Generator Transformer Load1 Load2 Figure 1: Integrated framework to mitigate cyber-physical attacks against smart grids with real-time visualization and evaluation our contributions are as follows: (1) We develop novel anomaly detection units for low level monitoring and attack detection in smart grids. Our generalized norm-based detection units take into account all system states and are sensitive to transient dynamics, unlike those in [9], [12], [18], [19], rendering them more suitable for monitoring grid attacks. (2) We synthesize a DRL based defender agent capable of mitigating any cyber-physical attack on smart grids by run time activation of suitable protection scheme action sequences. The agent is trained using a vast library of attack scenarios across different grid models. Additionally, residue readings from detection units are fed as observations to the defender agent, enhancing its performance in attack scenarios. (3) As smart grids are safety-critical Cyber-Physical Sys- tems (CPS), it is essential to ensure that the DRL induced run time grid protection actions are safe. Hence, we formally verify the safety of the defender agent by conducting a suitable formal reachability analysis before deployment. (4) We demonstrate the practical effectiveness of our methodology through real time hardware-in-the-loop (HIL) emulation of standard IEEE (14, 37, and 39) bus models popularly used in smart grid architectures. The grid models are simulated in-the-loop with our defender agent running on a GPU system for real time validation. The system demonstrates impressive mitigation ability in presence of well known grid attack [6], [18]. Organization: The organization of this paper is as fol- lows: Section 2 provides essential background information on power grid systems. Section 3 discusses the state-of- the-art attack models against grid systems. In Section 4, we present the mathematical model of the anomaly detec- tion unit. Section 5 describes our attack mitigation frame- work. Section 6 outlines our methodology, while Section 7 presents the experimental results. The related works are discussed in Section 8, and the limitations of our framework are explored in Section 9. Finally, Section 10 concludes the paper and discusses future work. 2. Preliminaries In this section we provide an overview of the fundamen- tal components of smart grids, focusing on their structure, management, and real-time control mechanisms. 2.1. Grid Model Smart grids primarily consist of three components: (i) Generation, which encompasses generator units converting mechanical power input into electrical power output to meet users’ electricity demands; (ii) Transmission, where the electrical power produced is transferred to the Load Dis- patch Centre (LDC) within each grid region through high- voltage transmission lines; and (iii) Distribution, whereby the transmitted power at the LDC is disseminated to indus- trial and domestic loads via distribution lines. Generation units typically produce power ranging in the hundreds of megawatts. Standard power grid models such as the IEEE 14, 37, and 39 bus configurations feature buses categorized into three types: slack bus, PQ bus, and PV bus. The slack bus establishes an angular reference for all other buses, while the PQ bus determines the voltage magnitude and phase angle of all buses. PV buses are connected to the generators and maintain constant power and voltage gener- ation [20]. 2.2. Grid Operation In smart grids, each generator unit is connected to an Automatic Generation Control (AGC) unit. These AGCs play a vital role in real-time by adjusting the mechanical power set-points of the generators according to the power demand in the grid [20]. This adjustment is crucial for maintaining the grid frequency at its designated value within acceptable boundaries. Furthermore, AGCs are responsible for managing the power exchange between grid areas, en- suring that the total power transmitted over tie lines stays at a predetermined level with the help of a metric named Area Control Error (ACE). G10 G8 G2 G1 G3 G4 G6 G7 G9 10 12 11 2 19 18 17 14 15 16 32 31 20 3 33 34 35 36 27 26 37 38 13 8 25 28 9 29 24 21 22 23 7 30 4 39 5 Tie line Transformer Generator Load Area1 Area2 Area3 Area4 Area5 Area6 Figure 2: IEEE 39 bus power grid with generators, trans- mission and distribution lines [18]. A tie-line connects two buses in separate areas, as il- lustrated in Fig.2, which shows a grid with six areas and 39 buses, with tie-lines indicated by red dotted lines. To calculate the ACE for the nth tie-line at time t, the AGC measures deviations of the grid frequency and power export from their nominal values as ∆f n(t) and ∆pen(t), respec- tively. Using these measurements, AGC calculates ACE as ACEn(t) = αn(t)∆pen(t) + βn(t)∆fn(t), where αn(t) and βn(t) are time-varying constants. The ACE value is updated once every AGC cycle (generally of length six to ten seconds) [21], and accordingly, the mechanical input power set points of the generators are updated to keep the ACE value near zero [22]. To ensure safe grid operation, the grid frequency deviation ∆f from its nominal value should always remain within specific safety limit S = [−0.5, 0.5]Hz ( [22]). 2.3. Protection Schemes During natural events such as short circuits in trans- formers or sudden transmission line outages due to storms and rain, grids rely on power system protection schemes to maintain safe operation. These schemes aim to swiftly isolate the affected area and minimize damage to grid com- ponents. By implementing localized outages, these protec- tion schemes facilitate repairs while ensuring the majority of the transmission network remains functional. However, these existing strategies are triggered by some time delays by the operators at the LDCs. For clarity, Table 1 depicts the existing protection schemes considered in our grid models, which are also widely utilized in bulk power systems [5], [6], [15], [18]. The unit specified in the table denotes the Name of protection scheme Activation criteria Distance Short circuit fault Overcurrent Current = 2 [pu] Under Voltage (UV) Voltage = 0.8 [pu] Under Frequency Load Shedding (UFLS) Frequency threshold System load relief Time delay 59.3 Hz 5% 0 Sec 58.9 Hz 15% 0 Sec 58.3 Hz 25% 0 Sec Over Frequency Generator Tripping (OFGT) Frequency threshold Generation trip Time delay 60.6 Hz 100% 9 min 61.6 Hz 100% 30 Sec >= 61.8 Hz 100% 0 Sec Under Frequency Generator Tripping (UFGT) Frequency threshold Generation trip Time delay 59.4 Hz 100% 9 min 58.4 Hz 100% 30 Sec 58.0 Hz 100% 2 Sec 57.5 Hz 100% 0 Sec Differential Symmetrical/asymmetrical fault in transmission line TABLE 1: Traditional protection schemes used in power grids [15], [18]. per-unit value of the grid quantity, where a value of 1 pu indicates that the quantity is at its nominal value [20]. 3. Attack models In this section, we discuss various types of cyber- physical attack models designed in existing literature to compromise the safety of smart grid operations. We cate- gorize these models according to their target components, the grid quantities they manipulate, their required resources, and their action space. We detail the features of these attack models in Table 2, along with the indication of whether protection mechanisms and detector units were incorporated into the grid models in these works. The term NA indicates the absence of a detector in the grid model. In this work, we focus on attack models that directly affect power flow distribution within the grids. Other threat models, such as market manipulation [24], are beyond the scope of this paper. Below are the attack models considered in this work. Black IoT [5]: In this attack framework an adversary first gains control of high-wattage IoT-based devices such as heaters, air conditioners, and refrigerators. It then syn- chronously switches these botnet devices on and off until the grid frequency deviates greatly from its safe range (S) of [59.5 60.5] Hz. It was claimed in [5] that only a 1% increase in load demand with the help of botnets can cause a blackout in the Polish grid. These attacks are also known as Manipulation of Demand via IoT (MaD IoT 1) attacks. MaD IoT 2.0 [6]: This is a modified version of the MaD IoT 1 attack where the attacker first computes the voltage stability index of each bus node in a grid model by per- forming a modal analysis [20] of the grid. The attacker subsequently alters the loads connected to the buses with the least voltage stability index using high-wattage IoT botnet devices to make grid operation unsafe. For clarity purposes, we will refer to the MaD IoT 1 attack as Black IoT and MaD IoT 2.0 as MaD IoT for the rest of the paper. Attack Model Attacker Objective Attacker Capabilities Presence of Protection Scheme # States in Detectors Target Components Grid quantity manipulated Attack Resources Action Space Black IoT [5] Consumer Loads Power Flow High-wattage IoT devices Switching on-off devices synchronously ✓ NA MaD IoT [6] Consumer Loads Power Flow High-wattage IoT devices Switching on-off devices synchronously ✓ NA FDIA [9], [12] AGC control signal Generator output electrical power Grid topology or state information Sensors ✗ 1 Scaling Attack [18] Tie-line power flow measurements Power Flow Grid topology or state information Sensors ✓ 5 CBT [23] Transmission/Distribution ines Power Flow LDC circuit breakers Open/close circuit breakers synchronously ✓ NA TABLE 2: Cyber-physical attacks on smart grids Sl.No State Name State Symbol 1 Rotor angle θ 2 Flux at phase a ϕa 3 Flux at phase b ϕb 4 Flux at phase c ϕc 5 Direct - axis flux ϕd 6 Quadrature - axis flux ϕq 7 Current at phase a Ia 8 Current at phase b Ib 9 Current at phase c Ic 10 Direct - axis current Id 11 Quadrature - axis current Iq 12 Field Current Ifd 13 Time delay for rotor to respond to mechanical power dωdelay 14 Predicted rotor speed delay dωpredict 15 Voltage at phase a Va 16 Voltage at phase b Vb 17 Voltage at phase c Vc 18 Generator operation frequency f 19 Saturated inductance at d-axis Lmdsat TABLE 3: Grid states False Data Injection Attack (FDIA) [9], [12]: In these types of attacks, the adversary introduces false readings to the generators’ reference power measurements without triggering the BDD units. The aim of the attacker in these works is to create a mismatch between power supply and demand. Scaling Attacks [18]: In this attack model, the adversary first identifies the most vulnerable operating instances of a grid with the help of formal analysis [25]. It then subse- quently scales the power flow sensor measurements of the tie lines during the identified intervals, which leads to increased ACE values and makes grid operation unsafe. Such a type of attack also manages to remain undetected by sophisticated transient-sensitive anomaly detectors. Circuit Breaker Takeover (CBT) [23]: An attacker com- promises the LDCs by social engineering [9] and discon- nects loads, generators, and transmission lines from the grid using relay/circuit break-on-off sequences. This action leads to power flow oscillations within the grid. We implemented the discussed attack scenarios in our grid models to effectively train the DRL defender agent. We assume that these adversaries have read/write access to three types of resources: (i) power flow sensor measurements of the tie lines (TP F ) [18], (ii) circuit breaker control signals (CB) [23], and (iii) generator reference power Pref measurements. We consider that the ultimate objective of the attack models is to inflict maximum damage on consumer equipment by pushing the grid frequency (f) beyond the safe equipment operation zone, defined here as D ∈[58, 62] Hz [5] across various grid topologies. 4. Anomaly Detection in Smart Grid In this work, we develop novel anomaly detection units that are attached to each generator unit in the grid for discovering deviations in their behavior from nominal op- erations. The operational framework of the anomaly de- tector is demonstrated in Fig. 3. These detectors utilize an Extended Kalman Filter (EKF) [26] based state esti- mator to estimate generator system state ˆx as given by, ˆxk+1 = g(ˆxk, uk) + L(yk −h(ˆxk)) where g represents the state transition function [27], h is the measurement function [27], L is the Kalman gain, uk is the control input (mechanical input power set point of generator), and yk is the output power measurement of the generator at the k-th time step. Generator Power flow sensor Current sensor Frequency Sensor EKF AGC Detector: All sensor measurements (𝑥𝑘), and power output (𝑦𝑘) ො𝑥𝑘 ො𝑥𝑘 𝑢𝑘 𝑢𝑘 Actuator 𝑢𝑘 Generator side Detector side 𝑥𝑘, 𝑦𝑘 𝑟𝑘= 𝑦𝑘−ℎ(ො𝑥); |𝑟𝑘|p>Th Figure 3: Anomaly detection frame- work Thereafter, the residue (rk), defined by, rk = yk−h(ˆxk) is utilized to detect deviations of the generator system states from their nominal behavior. As an anomaly condition, we check if the norm of the system residue exceeds a predetermined threshold (Th). Let |rk|p denote the p-th norm of the residue at the k-th time stamp. Considering that residue rk has dimension nr, let rk = [r1 k T , · · · , rnr k T ]T . The residue is calculated over a w length window as follows. |rk|p ∆= Pw i=1 Pnr j=1 |rj i |p1/p > Th. Previous research works [9], [12], [13] have focused primarily on using grid frequency (f) as the sole state parameter for designing anomaly detectors. This approach often renders the detectors insensitive to the transient dynamics of the grid. The work in, [18] extends the state estimation by considering five state variables, employing the Kalman Filter (KF) as the estimator. However, the use of KF often acts as a bottleneck when estimating the nonlinear dynamics of the grid, thus failing to effectively detect anomalous grid behavior. In contrast, our anomaly detector incorporates a broader spectrum of grid states, specifically nineteen states as detailed in Table 3. By utilizing the Extended Kalman Filter (EKF) for state estimation, our system is finely attuned to the transient dynamics of the grid, significantly enhancing its efficacy in detecting grid anomalies. 5. Attack Mitigation Framework Overview We incorporate all existing protection mechanisms listed in Table 1 within our grid models. Fig.4 illustrates the locations of different protection schemes within an IEEE 14- bus grid model utilized in our work. Our attack-mitigation framework is capable of sequentially triggering these pro- tection schemes based on various attack scenarios, as it has read/write access to the following: (i) all the transmission line power flow sensor measurements (PF), (ii) the residue readings from the anomaly detection units (r), (iii) relay and circuit breaker control signals (CB), and (iv) the ability to control the power output of each generator unit (Pe). We represent these access points in the form of a tuple ⟨PF, rad, CB, Pe⟩, as depicted in Fig.4. Utilizing these ac- cess points, our mitigation framework can adaptively adjust the activation of the existing protection schemes instantly ac- cording to the specific attack scenarios. For example, using CB signals, our framework can trigger Under Frequency Load Shedding (UFLS) by disconnecting loads from the grid, and with Pe, it activates Over Frequency Generator Tripping (OFGT) and Under Frequency Generator Tripping (UFGT) by reducing the power production of generators. The combined use of PF, r, and CB enables the framework to activate overcurrent, under-voltage, and differential pro- tection schemes by disconnecting certain transmission and distribution lines as needed. The framework’s capabilities are structured to ensure immediate response to various attack scenarios, making it suitable for use in Load Dispatch Centers (LDCs) where grid operators have similar access controls. The attack models discussed in section 3 aim to disrupt the grid’s power flow, leading to significant frequency devi- C C CB1 CB2 CB3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 OFGT/UFGT (𝑷𝒆) OFGT/UFGT (𝑷𝒆) OFGT/ UFGT (𝑷𝒆) UFLS UFLS UFLS UFLS UFLS G Generator D Detector reading (r) Circuit breaker with control signal CB C Compensator CB4 CB5 CB6 Power flow sensor reading (PF) Access point Mitigation framework access points: < PF, r, CB, Pe> Load Figure 4: IEEE 14-bus power grid with all existing pro- tection schemes and the access points of the mitigation framework incorporated. ations (f) and potential damage to customer equipment. To stabilize uncontrolled power flow oscillations, our mitigation framework seeks to minimize the difference between the power flow during attack conditions and the power flow during normal grid operations across grid buses. Addition- ally, it aims to maintain the grid frequency (f) within the safe operational range of S ∈[59.5, 60.5] Hz, close to the nominal frequency of 60 Hz, by initiating appropriate protection strategy sequences. Let Pnorm denote the power flow between buses i and j during normal grid operation, and let Patk denote the power flow between the same buses under attack conditions. These power flow values are mathematically described by the following equations. Pnorm = (V 2 Sj −V 2 Si) XLji sin(δj −δi) (1) Patk = (V a Sj 2 −V a Si 2) XLji sin(δj a −δi a) (2) Here, the magnitudes of the voltages at buses i and j during normal grid operation are denoted by VSi and VSj, respectively. The voltage angles at these buses are represented by δi and δj, respectively, and XLji represents the line impedance between the two buses. During an attack scenario, the bus voltages are denoted by V a Si and V a Sj, and their respective voltage angles are represented by δa i and δa j . The objectives of our mitigation framework are mathematically described by the following equation. min ⟨CB,Pe,P F ⟩max θ∈Θ [C(Pnorm, Patkθ, f)] ≈0 (3) Here, C(Pnorm, Patkθ, f) = w1|Pnorm −Patk| + w2(−1 + | |f|−60 0.5 |), is the cost function that quantifies the deviation in grid behavior under attack conditions and w1, w2 are the weight values used to prioritize the components of the cost function. Θ is the set of all potential scenarios, representing different attack vectors, and θ is a specific scenario from the set Θ. Our framework minimizes the deviation in grid behavior from its normal operation against the worst-case attack scenarios by performing the minimization operation depicted in Equation 3 for every possible pair of buses in a grid model. It determines the optimal protection scheme activation sequence (CB, Pe, PF) for every attack scenario. Additionally, we assume that our mitigation framework can- not control certain grid equipment, such as circuit breakers, which have been compromised by the adversary to induce attacks in the grid model. 5.1. Motivating Example In this section, we demonstrate how our attack mitigation framework successfully prevents grid failure against state- of-the-art attack models. We present an example of how the frequency trajectory of the New England (IEEE 39 bus) grid changes when scaling attacks [18] on tie-line power flow measurements are implemented. The green plot in Fig.5 illustrates the average operating frequency of all generators in the IEEE 39 bus grid model under the influence of scaling attacks. 0 5 10 15 20 25 Time (Second) 56 58 60 62 64 66 68 Frequency (Hz) Generators' average frequency Frequency lower safety limit Frequency upper safety limit Equipment damage lower limit Equipment damage upper limit OFGT (100% generator trip) Figure 5: The operating frequency of an IEEE 39-bus grid, assessed under the influence of attack vectors proposed in [18], with traditional protection systems engaged. 0 5 10 15 20 25 Time (Second) 58 60 62 Frequency (Hz) Generators' average frequency Frequency lower safety limit Frequency upper safety limit Equipment damage lower limit Equipment damage upper limit OFGT (15% generator trip) Figure 6: The operating frequency of an IEEE 39-bus grid, assessed under the influence of attack vectors proposed in [18], with our mitiga- tion framework in action. The blue, brown, red, and black plots represent the upper and lower safety limits for operating frequency, as well as the upper and lower safety limits for equipment damage, respectively. The attack pushes the grid operating frequency beyond the safe limit within 1 second. The frequency trajectory continues to deviate and crosses the upper limit for equipment damage D ( [5]) at 3 seconds. The scaling attack successfully causes damage to customer equipment and jeopardizes grid operation safety. Traditional protection mechanism, triggers the Over Frequency Generator Triping (OFGT) method, with 100% generation trip at 2.5 seconds instead of activating it immediately when the frequency exceeds the safe operation limit (S). This delay in the operation of the protection scheme leads to equipment damage for consumers. We now demonstrate how our attack mitigation framework successfully ensures grid operation safety when subjected to scaling attacks. The green plot in Fig.6 depicts the average operating frequency of generators in an IEEE 39 bus grid model under scaling attacks. Similarly, the blue, brown, red, and black plots denote the upper and lower safety limits for operating frequency, as well as the upper and lower safety limits for equipment damage [5], respectively. As observed in Fig.6, the grid frequency surpasses the upper safety limit at 1 second. Subsequently, our mitigation framework activates the OFGT scheme with only a 15% generation trip at 1.1 seconds, thereby constraining the frequency trajectory to return within the safe zone (S). This strategy effectively prevents damage to customer equipment and ensures grid operation safety. Immediate activation of an appropriate protection strategy when the operating frequency becomes unsafe prevents customer equipment damage and ensures grid operation safety, thereby avoiding total generation shutdown. This motivates us to develop an adaptive attack mitigation framework capable of strategically activating the protection schemes at appropriate time intervals to ensure grid operation safety and prevent damage to customer equipment against different classes of cyber-physical attacks. 6. Methodology for Attack Mitigation We consider as input (i) a smart grid model in Simulink, comprising various loads, generators, transmission, and dis- tribution lines, and (ii) a library of different attack scenarios, including FDIA ( [9], [12]), scaling ( [18]), CBT ( [23]) and MaD IoT attacks ( [5], [6], [23]). Our methodology for the attack mitigation framework consists of two components. (i) First, we train a Deep Reinforcement Learning (DRL) based defender agent using various attack scenarios on different standard IEEE grid architectures. The RL defender agent learns to stochastically neutralize the effects of attacks on grid behavior by discovering appropriate activation se- quences for the protection mechanisms (Table 1). (ii) After completing the training process, we perform a set-based ver- ification of the agent’s neural networks (NNs). This verifica- tion computes the reachable set of states [28] of the agent’s NNs and checks their intersection with the unsafe grid states. Our proposed methodology outputs formally verified optimal protection scheme activation strategies against state- of-the-art attack models, which are deployable in safety- critical smart grid environments. 6.1. DRL Defender agent for Grid Protection Following the discussion in section 5 the defender agent’s objective is to make the grid operation safe by optimally triggering a sequence of protection schemes at ap- propriate time instants such that the cost function in equation 3 gets minimized. The defender takes action whenever the input attack vectors make grid operation unsafe and cause equipment damage or when the attack vectors get discovered by the anomaly detection units. Our defender DRL agent’s action space includes: (i) triggering UFLS, UV, and differential protection by adjust- ing the circuit breaker control signals (CB). (ii) Activating OFGT and UFGT by changing the generator output power production (Pe). For synthesizing the best grid protection activation strategy to make grid operation safe, the defender agent observes the following data from the power grid: (i) The operating frequency (f) of each generator unit in the grid, (ii) the transmission line power flow sensor measure- ments (PF), (iii) the residue values of each generator unit (rk), (iv) the threshold values of anomaly detection units (Th), (v) the circuit breaker control signals (CB), and (vi) the output power produced by the generators (Pe). Equation 4 as given below formulates the reward function where w′ 1, w′ 2, and w′ 3 are weight parameters. Rd = −w′ 1 d−1 X k=0 n X i=0 −1 + |fi| −60 0.5 ! | {z } minimize frequency deviation −w′ 2 b X m=1 b X q=1 |Pnormmq −Patkmq | | {z } minimize power flow deviation −w′ 3 d−1 X k=0 n X i=1  T hi −2 max(0, |rik|p −T hi) T hi  | {z } minimize system residue (4) There are three components of the reward function de- signed to ensure grid safety and prevent damage to customer equipment. The first component is maximized when the frequency deviation of all n generators in the grid over d sampling windows remains within the safe operating range (S ∈[59.5, 60.5] Hz). The second component of the reward function is maximized when the power flow deviations be- tween two buses m and q in a b-bus grid are minimized. The third component is maximized when, over a d-length time horizon, the p-th norm of the system residue remains below the threshold (Th). A larger residue value (|rk|p ≥Th) triggers attack detection by the anomaly detectors, indicating that the grid states (see Table 3) are deviating from their normal values. Using these three components, the defender agent is encouraged to activate protection schemes at the correct times to minimize operating frequency deviations and protect customer equipment from damage. To train the DRL defender agent, we use the Deep Deterministic Policy Gradient (DDPG) algorithm [29]. DDPG is an off-policy deep reinforcement learning (DRL) algorithm that combines Q-learning with actor-critic methods to learn both value and policy functions. The agent’s action space is bounded. After each action is taken at a sampling instance, the defender agent receives a reward based on its effectiveness in maintaining safe grid operations (i.e., keeping the grid frequency within the safe zone (S)). This reward is used by the DDPG agent as a performance metric to optimize its actions. During training, the weights and biases of the underlying actor neural networks are updated via backpropagation to maximize reward. 6.2. Formal Verification of Defender Agent On completion of the training process of the DRL de- fender agent, it can synthesize activation sequences of pro- tection schemes that can stochastically make grid operation safe against the considered cyber-physical attack vectors. However, such agents may not always be safely deployable in critical smart grid infrastructures due to their probabilistic approach to taking actions. Therefore, in the next phase of our work, we verify the neural network of the trained DRL-defender agent by performing a set-based execution of the network [28], [30], [31]. The defender agent network is a fully connected feed-forward neural network with ReLU activation functions. We consider the neural network as a function NN: Rni →Rno, where ni is the number of observations and no is the number of actions. The neural network consists of k layers, where each layer i is defined with a weight matrix Wi and a bias vector bi. For an input point y0 ∈Rni, the neural network computes an output point yk ∈Rno as: x(1) = W1y0 + b1, y1 = f(x(1)) x(2) = W2y1 + b2, y2 = f(x(2)) ... ... x(k) = Wkyk−1 + bk, yk = f(x(k)) (5) Generator Transformer Domestic+Industrial load Grid model Observations Actions DRL defender agent For each ith NN layer Compute: 𝑥𝑖= 𝑊𝑖𝑦𝑖−1 + bi yi = ReLU(xi) Observations (input set) Unsafe set: (U ∉ [58, 62]Hz) Check if: yo ∩ U = ∅ YES NO NN: SAFE NN: UNSAFE Output of final NN layer = yo Figure 7: Verification framework for the defender agent neural network In the affine transformation given by Equation 5, yi−1 and yi are the input and output of the i-th neuron layer, respectively. The function f is the ReLU activation function, where f(x) = max(x, 0). The set-based verification process for the neural networks takes as input the function NN and an input set I ⊆Rni comprising of the agents observations. It then gives an output range (Range()) of the network when executed from a point inside the input set, where Range(NN, I) = {yk|yk = NN(y0), y0 ∈I}. The verifi- cation process checks if Range(NN, I)∩U = ∅for the final output layer of the neural network of the defender agent. Here, U is the unsafe set of grid states (U /∈[58, 62] Hz) indicating potential damage to consumer equipment. Fig. 7 demonstrates this process. We represent the input set I with the help of a spatial data structure called a star set [30], [31]. A reachability analysis of the neural network is performed by propagating the input set (observations) through each layer of its neural network, computing the set of possible intermediate values and then the set of possible outputs repeatedly until the output of the final layer is computed and checked for intersection with the unsafe set U. The complete process of neural network verification as adopted from [30] is presented in Algorithm 1. Algorithm 1 Safety Verification of DRL-based Defender Agent 1: Input: Input set: I, Unsafe set: U = {f | f ̸∈ [58, 62] Hz}, Layers: number of neuron layers, Neuron: number of neurons, Empty pending List: W 2: Output: Status (safe or unsafe) 3: s ←⟨layers, neuron: None, θ = star-set(I)⟩ 4: if s.neuron is None then 5: if s.layer = k then ▷Final layer check 6: if s.output ∩U = ∅then 7: return safe 8: else 9: return Unsafe 10: end if 11: else 12: s.layer ←s.layer + 1 13: s ←s.Affine Transformation(Ws.layer, bs.layer) 14: s.neuron ←1 15: end if 16: end if 17: n ←s.neuron 18: s.neuron ←n + 1 19: if s.neuron > length(bs.layer) then 20: s.neuron ←None ▷End of current layer 21: end if 22: activation ←ReLU Activation(s, n) 23: if activation = positive then 24: continue ▷No change for positive activation 25: else if activation = negative then 26: s ←s.reset neuron(n) ▷Assign 0 value 27: else if activation = ambiguous then 28: t ←(s.layer, s.neuron, s) ▷Copy state 29: s ←s.enforce positive(n) ▷Positive branch 30: t ←t.enforce negative(n) ▷Negative branch 31: t ←t.reset neuron(n) 32: W.enqueue(t) 33: end if 34: W.enqueue(s) 35: return safe ▷Continues to be safe The algorithm begins by taking as input the unsafe state U, the input set I which consists of the observations of the RL agent, the number of neuron layers, and the total number of neurons (line 1), as well as an empty list called the pending list. It gives as output the state trajectory of the final layer of the neural network and a status of whether the network is safe or unsafe (line 2). The algorithm then forms a computation tuple s, which is a collection of the number of layers of the NN, the affine transformation value of the current neuron being processed (initially set to None), and the star set representation of I denoted by θ (line 3). If the current neuron’s affine transformation value (s.neuron) is undefined (None), the algorithm checks if it has reached the final layer (s.layer = k). If it is the final layer, the algorithm checks whether the current output value (yk) represented as s.output intersects with the unsafe set (U). If there is no intersection, it concludes that the NN is safe; otherwise, it returns unsafe (lines 4-10). If the neuron is not processed and the current layer is not the final one, the algorithm progresses to the next layer (s.layer + 1), applies an affine transformation using the weights and biases of this new layer (Ws.layer, bs.layer), and resets the neuron index to 1. This reset indicates the initiation of processing at the new layer, preparing for the application of the activation function (lines 11-14). For each neuron in a layer, the algorithm increments the neuron index to move to the next neuron. If the updated neuron index exceeds the number of neurons in the current layer (s.neuron > length(bs.layer)), it resets the neuron index to None, indicating that it has finished processing the current layer (lines 18-21). The algorithm then determines the activation state of the current neuron using the ReLU activation function (ReLU Activation(s, n)) (line 22). De- pending on the result of this activation: (i) if the activation is positive, the algorithm continues without making any changes, effectively skipping further checks for this neuron. (ii) If the activation is negative, the algorithm assigns the current neuron’s state value to zero (s.reset neuron(n)) (lines 24-26). (iii) If the activation is ambiguous (sometimes positive and sometimes negative), the algorithm branches the current state into two: one assuming a positive outcome and the other a negative outcome (lines 27-line31). The algorithm then handles each branch separately as discussed in steps (i) and (ii). Both the branched state (t) and the original state (s) are then enqueued into a pending list (W) (line 34) to loop back to line 6 to check for intersection with the unsafe set U. The algorithm iterates over this process until the safe/unsafe status of the NN final layer has been determined. We have set a maximum frequency limit of 80Hz for the input star-set I, used in Algorithm 1 to verify the defender agent’s NN. This parameter is based on the assumption that the grid operation frequency might rise to 80Hz in the worst-case attack scenarios. Consequently, Algorithm 1 can verify the defender agent’s ability to mitigate such extreme scenarios. Deployment: The execution of our framework operates as follows. The training of the defender agent is an offline process, where various attack scenarios are utilized to train the agent in learning the optimal protection scheme activa- tion sequences. The trained defender agent’s neural network is then formally verified with the help of Algorithm 1. After the formal verification process, the defender agent’s neural networks are converted to the dlnnetwork format [31], en- abling deployment on CUDA-supported GPUs. In the online scenario, when the grid is operational, attack scenarios are launched. The defender agent monitors in real-time the op- erating frequency (f) of each generator unit in the grid, the transmission line power flow sensor measurements (PF), the residue values of each generator unit (rk), the threshold values of anomaly detection units (Th), the circuit breaker control signals (CB), and the output power produced by the generators (Pe). It successively triggers sequences of protection schemes to safeguard grid operations against the attacks. The defender agent continuously monitors grid parameters and activates appropriate protection strategies to ensure safe grid operation throughout its runtime. 7. Experimental Setup and Results We demonstrate our experimental results for IEEE (14, 37, and 39) bus power grid systems designed using Matlab- Simulink (R2022b) and implemented in Opal RT Hardware- in-Loop (HIL) OP4510 setup. These grid architectures are widely accepted models for grid simulations [6], [15], where the IEEE 39 bus system represents the New England grid system [6]. As discussed in sections 3 and 6 we have implemented 5 different attack scenarios, which are: (i) Black IoT [5], (ii) MaD IoT [6], (iii) False Data Injection Attack (FDIA) [9], [12], (iv) Scaling Attacks [18], and (v) Circuit Breaker Takeover (CBT) [23], in the Simulink IEEE grid models for training the DRL defender agent. To design and train the defender agent for each power grid model, we use the Reinforcement Learning (RL) toolbox in Mat- lab. The DRL defender agent was trained using the power grid models along with the attack scenarios (simulated in Simulink) as environments using a high-performance computing setup with a 16-core Intel Xeon CPU with 64 GB of RAM and 16 GB of NVIDIA Quadro 5000 series GPU. We carry out the training process by running 500 episodes, each spanning 50000 iterations with a sampling time of 0.01 s, resulting in a total training time of 9 minutes per episode for each of the bus architectures. In each episode, the defender agent generates optimal activation sequences of the protection schemes to counter each attack scenario in the different grid models. After completing the training of the defender agent, we extracted its Deep Neural Network (DNN), weights (W), and biases (b) using the getActor() and getLearnableParameters() commands in Matlab. These extracted parameters were then input into a Matlab-compatible Neural Network Verification (NNV) toolbox [31]. The toolbox conducts a reachability analysis of the defender agent neural network (NN) layers, assessing for any overlaps with unsafe grid operation con- ditions as discussed in algorithm 1. The verification process using the NNV tool took 20 minutes in our setup. After verification, we converted the DNN’s weights (W) and biases (b) into GPU arrays (dlnnet- work) using Matlab’s parallel computing toolbox, facili- tating the deployment of the defender agent on CUDA- supported GPU systems. Upon successful completion of the agent’s training, verification, and GPU deployment phases, we loaded the IEEE (14, 37, and 39) bus grid models, along with the attack scenario libraries, into the HIL setup. This setup allows for the emulation of the grid models using the OPAL-RT real-time simulation engine, supported by the Artemis solver for advanced real-time simulation. This configuration enables real-time visualization of the impacts of various attack scenarios on grid behavior in Opal-RT. We then loaded the extracted DNN, weights, and biases onto a laptop equipped with a GTX 1650 GPU. An Ethernet connection is established between the laptop and the HIL setup. The grid models and attack scenarios are emulated in the HIL setup, and the observations for the defender agent (discussed in Section 6.1) are transmitted to the DNN running on the GPU via Ethernet. The DNN processes these inputs and generates appropriate actions, by producing activation sequences for the protection schemes to mitigate the attack scenarios. The actions are generated using Equation 5 and sent back to the HIL setup through the Ethernet connection. The plots in Figures. 8-16 demonstrate the efficacy of our defender agent in ensuring safe grid operations and preventing damage to customer equipment under various attack scenarios, through real-time simulation of the IEEE 14-bus model. In Fig.8 the blue, red, green, and pink plots depict the residue computed by the anomaly detector when MaD IoT, FDIA, scaling, and CBT attacks are executed respectively. As can be seen, our anomaly detection unit efficiently detects all classes of attacks when these residue plots cross the black threshold plot of the detector. The impact of the defender agent in maintaining grid safety across different attack scenarios is further visualized by plotting the following grid parameters. (i) Average operating frequency of all generators in the grid: In figures 9-12, we plot the average oper- ating frequency of all the generators under the defender agent’s action (green plot), the average operating frequency of all the generators under traditional protection schemes (black), the upper (orange) and lower (blue) safety limits of grid frequency, and consumer equipment damage thresholds (upper/lower both in red) [5] for an IEEE 14 bus model. These figures illustrate the grid responses for the MaD IoT, FDIA, scaling, and CBT attack scenarios, respectively. Fig. 9 explores a worst-case MaD IoT attack scenario where the adversary uses botnets to manipulate 30% of the grid loads. Traditional protection schemes fail to ensure safe grid operations as the average frequency trajectory of the genera- tors (black plot) falls below the lower safety limit (blue plot) and eventually crosses into the equipment damage lower threshold (red plot). This failure occurs due to a predefined delay in activating existing protection strategies (refer to Table 1) and rigid rules that mandate shedding a fixed amount of load and tripping 100% of generators. Conversely, our defender agent effectively mitigates the MaD IoT attack and maintains safe operational frequencies, as depicted by the green plot in Fig. 9. Despite the frequency trajectory remaining within the safe zone, the defender agent initiates 10% OFGT and 5% load shedding, triggered by the high residue values (Fig. 8) observed during the attack, thus successfully preventing damage to customer equipment. In Fig. 10, we analyze an FDIA attack scenario where 40% of power flow sensor readings are manipulated. Tra- ditional protection measures fail to prevent customer equip- ment damage as the grid frequency trajectory (black plot) exceeds the threshold for equipment damage (red plot). 0 1 2 3 4 5 Time (Sec) 4 5 6 7 8 Residue Threshold residue Residue under Mad IoT Residue under FDIA Residue under Scaling attack Residue under CBT Figure 8: Residue plot of the IEEE 14 bus power grid under different attack models. 0 1 2 3 4 5 Time (Sec) 58 59 60 61 62 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage lower limit 10% OFGT 5% UFLS Figure 9: Average frequency of all the generators under MaD IoT attack. 0 1 2 3 4 5 Time (Sec) 58 60 62 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage lower limit 10% OFGT 5% UFLS Figure 10: Average frequency of all the generators under FDIA attack. 0 1 2 3 4 5 Time (Sec) 58 60 62 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage upper limit 30% UFLS Figure 11: Average frequency of all the generators under scaling attack. 0 1 2 3 4 5 Time (Sec) 58 60 62 64 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage upper limit 25% UFLS 5% OFGT Figure 12: Average frequency of all the generators under CBT attack. 0 1 2 3 4 5 Time (Sec) 0.4 0.6 0.8 1 Power (pu) Avg output power of all generators under defender Avg output power of all generators under traditional protection Figure 13: Average output power of all the generators under MaD IoT attack. 0 1 2 3 4 5 Time (Sec) 0.4 0.6 0.8 1 1.2 Power (pu) Avg output power of all generators under defender Avg output power of all generators under traditional protection Figure 14: Average output power of all the generators under FDIA attack. 0 1 2 3 4 5 Time (Sec) 0.4 0.6 0.8 1 Power (Sec) Avg output power of all generators under defender Avg output power of all generators under traditional protection Figure 15: Average output power of all the generators under scaling attack. 0 1 2 3 4 5 Time (Sec) 0.4 0.6 0.8 1 1.2 Voltage (pu) Avg output power of all generators under defender Avg output power of all generators under traditional protection Figure 16: Average output power of all the generators under CBT attack. However, our defender agent successfully maintains the grid frequency (green plot) within the safe operational zone. Similarly, Fig. 11 demonstrates the impact of scaling attacks on the average operational frequencies of all generators in the IEEE 14 bus grid, considering a scenario where all tie- line power flow sensor measurements are manipulated. Here, traditional protection schemes prove ineffective, allowing the scaling attack to push the frequency trajectory (black plot) beyond the equipment damage upper threshold (red plot). The defender agent effectively mitigates the impact of the scaling attack by implementing 30% load shedding at 0.3 and 0.6 seconds (green plot), respectively. In Fig. 12, we demonstrate the grid frequency trajectories under a Circuit Breaker Takeover (CBT) attack scenario, assuming a worst- case scenario where the adversary compromises 50% of circuit breakers. The defender agent counters this attack effectively, maintaining a safe grid frequency (green plot) by initiating 25% load shedding at 0.4 and 0.7 seconds and 5% generator tripping at 1.7 seconds. Despite its efforts, traditional protection schemes remain ineffective, with the frequency trajectory (black plot) surpassing the upper safety limit (orange plot) and eventually crossing the upper equip- ment damage threshold (red plot). (ii) Average output electrical power of the generator units in the grid: In figures 13-16, we plot the average output power of all the generators under traditional protec- tion schemes (red), and the average output power of all the generators under defender agent operations (blue). These fig- ures illustrate the responses for the MaD IoT, FDIA, scaling, and CBT attack scenarios. Notably, under the operation of our defender agent, the output power (blue plot) stabilizes around a constant per-unit (pu) value of 1, indicating that all generators are effectively supplying power to the loads connected to the grid despite the attacks. In contrast, under traditional protection systems, the power outputs (red plot) exhibit rapid oscillations and decrease to a value of 0.3 pu. These fluctuations result from the alternating increase and decrease of frequencies across all the generators, arising from the inefficient operation of the traditional protection mechanisms. We omit the grid responses for the Black IoT attack in this section as its behavior is similar to that of the MaD IoT attack. We further plot the average frequency waveform of all the generators in: the IEEE 37 bus model under MaD IoT attack, the IEEE 37 bus model under FDIA, the IEEE 39 bus under scaling attack, and the IEEE 39 bus under CBT attack in figures 17, 18, 19, and 20 respectively. The green, black, blue, orange, and red plots in these figures represent the frequency under the operation of the defender agent, traditional protection schemes, lower safety limit, upper 0 5 10 15 20 25 Time (Sec) 58 60 62 64 66 68 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage upper limit 10% OFGT Figure 17: Average frequency of all the generators of IEEE 37 bus under Mad IoT attack 0 5 10 15 20 25 Time (Sec) 58 60 62 64 66 68 Frequency (Hz) Avg freq under defender Avg freq under traditional protection Freq lower safety limit Freq upper safety limit Equipment damage upper limit Offset=0 5% OFGT Figure 18: Average frequency of all the generators of IEEE 37 bus under FDIA. Figure 19: Average frequency of all the generators of IEEE 39 bus under Scal- ing attack. Figure 20: Average frequency of all the generators of IEEE 39 bus under CBT attack. 0 5 10 15 20 25 30 Time (Sec) 0.4 0.6 0.8 1 Power (pu) Avg output power of all generators under defender during MaD IoT Avg output power of all generators under defender during FDIA Avg output of all generators under traditional protection during MaD IoT Avg output of all generators under traditional protection during FDIA Figure 21: Average output power of all the generators of IEEE 37 bus under MaD IoT and FDIA. 0 5 10 15 20 25 30 Time (Sec) 0.4 0.6 0.8 1 Power (pu) Avg output power of all generators under defender during Scaling attack Avg output power of all generators under defender during CBT attack Avg output of all generators under traditional protection during Scaling attack Avg output of all generators under traditional protection during CBT attack Figure 22: Average output power of all the generators of IEEE 39 bus under scaling and CBT attack. safety limit, and equipment damage thresholds (upper/lower both) respectively. Similar to the IEEE 14 bus case, the defender agent successfully mitigated the effects of the different classes of attack on both the IEEE 37 and IEEE 39 bus grid models, ensuring that the grid frequency operated within the safe zone. The traditional protection schemes (Table1) failed to prevent customer equipment damage in all attack cases. The average output electrical power of all the generators in the IEEE 37 and IEEE 39 bus grid models is plotted in figures 21 and 22 respectively, showcasing the MaD IoT, FDIA, scaling, and CBT attack scenarios. In Fig. 21, the plots with colors deep blue and black depict the power output by the generators during the operation of the defender agent and the traditional protection schemes respectively in the MaD IoT attack scenario. The plots with light blue and green colors illustrate the power output of the generators during the operation of the defender agent and traditional protection schemes respectively in the FDIA attack scenario. The efficient operation of the defender agent maintains the power output of the generators at their nominal level even under attack conditions. In Fig. 22, the plots with colors deep blue and black represent the power output of the generators during the operation of the defender agent and traditional protection schemes, respectively, in the scaling attack scenario for the IEEE 39 bus model. The plots with light blue and green colors represent the power output of the generators during the operation of the defender agent and traditional protection schemes, respectively, in the CBT attack scenario. Similar to Fig. 21, the effective activation of protection strategies by the defender agent ensures that the generators maintain their rated power output even when subjected to scaling and CBT attacks. The analysis presented through figures 8-22 under vari- ous attack scenarios demonstrates the superior performance of our defender agent in ensuring the safety and reliability of grid operations. The real-time simulation results of the IEEE (14, 37, and 39) bus models demonstrate that the defender agent not only mitigates all classes of attacks efficiently but also prevents consumer equipment from damage. This is evident as the defender agent consistently manages to keep the grid’s operating frequency and power output within safe thresholds (S ∈[59.5, 60.5]Hz), a feat that traditional protection schemes fail to achieve. 7.1. Evaluation of the DRL defender agent In this section, we demonstrate the effectiveness of our defender agent in ensuring safe grid operations by compar- ing it with existing approaches and methodologies. Strategic Defense Comparison: We compare the defender with the attack mitigation strategies proposed in [6] and [18]. It should be noted that the strategies mentioned in these references are specifically tailored to mitigate MaD IoT and scaling attacks, respectively. Furthermore, the au- thors acknowledge that these schemes cannot be fully relied upon as there is no mathematical foundation guaranteeing their effective operation under real-world grid operation scenarios. The attack mitigation strategy in [6] suggests triggering UFLS at the buses where the rate of change of voltage magnitude is the highest. This strategy helps to identify potential buses where the load has been altered via IoT botnets, and successively shedding an appropriate amount of load prevents customer equipment damage. The strategy proposed in [18] involves triggering 20% OFGT and 20% UFGT immediately when the frequency trajectory goes above 60.5Hz and below 59.5Hz, respectively. If the frequency trajectory becomes safe, it reconnects the tripped generators. MaD IoT FDIA Scaling CBT 0 2 4 6 8 Max freq deviation ( f) Defender agent Proposed mitigation in [6] Proposed mitigation in [18] Figure 23: Comparison between dif- ferent attack mitigation frameworks This strategy effectively mitigates the scaling attack. The green, blue, and red bar plots in Fig. 23 illustrate the maximum average frequency deviation (∆f) from 60Hz for all generators in the New England (IEEE 39 bus) grid model. These deviations are measured under the operations of our defender agent, the mitigation strategy proposed in [6], and the strategy by [18], respectively. Four attack scenarios MaD IoT, FDIA, Scaling, and CBT are depicted in Fig. 23. For the MaD IoT attack, a total of 10% of the loads were considered to be altered by the attacker. The FDIA attack was considered to manipulate 25% of the power flow sensor readings, the scaling attack manipulated three tie-line power flow readings, and 20% of circuit breakers were considered to be under the influence of an adversary for the CBT attack. It can be seen that the grid operating frequency deviates the least under the operation of our defender agent and remains within the safe frequency deviation limit of 0.5Hz. The other attack mitigation strategies are effective in making grid operation safe for the particular scenarios for which they have been designed, but for other scenarios, they fail to ensure safe grid operation. They are unable to protect customer equipment from damage, as evidenced by frequency deviations exceeding the 2Hz threshold that signals potential equipment damage. Our defender agent outperforms the mitigation strategies outlined in [6] and [18]. This advantage stems from incorporating a broad spectrum of attack scenarios during the training phase of our agent. This extensive preparation is complemented by formal verification processes that rigorously evaluate and confirm the efficacy of the defender agent’s actions in maintaining safe grid operations. Performance under natural incidents: We analyzed the capability of our defender agent in managing natural inci- dents, such as transmission line outages due to faults and transformer short circuits, and compared its performance Line Outage Transformer Outage 0 0.5 1 1.5 2 2.5 Max freq deviation ( f) Defender agent Traditional protection Proposed mitigation in [6] Proposed mitigation in [18] Figure 24: Comparison between de- fender and traditional protection scheme under natural grid accident scenarios with traditional protection schemes and the protection strategies proposed in [6], [18], as illustrated in Fig. 24. The bar plots in blue, green, black, and red depict the maximum average frequency deviation (∆f) from 60 Hz of all the generators in an IEEE 39 bus grid under the operation of our defender agent, traditional protection schemes, the strategy proposed by [6], and the mitigation strategy by [18], respectively. For this comparison, we assumed that five transmission lines experienced outages and four transformers were short-circuited. The results indicate that our defender agent performs similarly to traditional protection schemes in handling such natural scenarios, thereby ensuring safe grid operation. However, the strategies of [6] and [18] failed to prevent damage to consumer equipment as frequency deviation exceeds 2Hz [5]. This efficacy in the performance of our defender agent is attributed to its ability to optimally manage power flow variations caused by these disturbances by effectively solving the power flow Equation. 3, which forms the basis of its decision-making process. Performance under the presence of error in grid model parameters: To replicate the real-world uncertainties in modeling the transmission line parameters (reactance, impedance) in our grid setup, we consider scenarios where certain percentages of errors are present in the reactance and impedance values of the transmission lines within an IEEE 39 bus grid model. We then assess the performance of our defender agent in minimizing grid frequency deviations (∆f) from 60 Hz across various attack scenarios, as illus- trated in Fig. 25. The black, blue, green, and red bar plots in Fig.25 represent the average maximum frequency deviation of all the generators in the grid under the operation of our defender agent during CBT attack, FDIA, MaD IoT attack, and Scaling attack scenarios, respectively. 2% 4% 6% 8% 10% Percentage error in transmission line parameters 0 0.2 0.4 0.6 0.8 Max freq deviation ( f) CBT attack FDIA MaD IoT attack Scaling attack Figure 25: Performance of the de- fender agent in the presence of er- rors in grid parameters These attack scenarios have the same adversarial settings as those discussed in Section 7. As can be seen although the grid frequency deviation exceeds the safety threshold of 0.5Hz due to significant errors in the transmission line parameters, the defender agent successfully prevents customer equipment damage by keeping the frequency deviations below the equipment damage threshold of 2Hz ( [5]). Neural Network Verification: The defender agent is trained with the objective of ensuring safe grid operations by main- taining the grid frequency (f) within the designated safe range (S) of [59.5, 60.5] Hz. However, due to the stochastic nature of the agent, there were instances during its verifica- tion process where algorithm 1 could generate counterexam- ples. In these cases, for certain observations (I), the output from the final layer of the trained agent’s neural network indicated unsafe conditions, i.e., f /∈[59.5, 60.5] Hz. It is important to note that deviations from the safe range S do not significantly compromise consumer equipment unless the frequency exceeds 62 Hz or drops below 58 Hz, which results in damage to customer equipment, as discussed in [5], [15]. As outlined in section 3, the primary goal of the attack models is to damage customer equipment. Therefore, we define an unsafe (U) grid operation condition for the defender agent’s verification as f /∈[58, 62] Hz. Under this criterion, algorithm 1 verified the defender agent, and no counterexamples could be generated as the defender always maintained f within the [58,62] Hz range. This criterion ensures that the defender agent’s actions effectively prevent damage to customer equipment under all attack scenarios. With these experimental and comparison results, we demonstrate that our attack mitigation strategy effectively secures grid operations against a vast scenario of sophis- ticated cyber-physical attacks. Additionally, our strategy proficiently handles natural grid outage events, an aspect that is lacking in the existing research works [6], [18]. The effectiveness of our proposed method can be attributed to the extensive array of cyber-physical attack models considered during the training of the defender agent, which is followed by its formal verification. Furthermore, our methodology has proven to scale effectively when applied to real-world grid models, such as the IEEE 39-bus New England model. 8. Related Works In recent years, smart grid security has obtained a no- ticeable amount of attention. Most of the research works in this area focus on vulnerability analysis of the grids and discuss less about discovering robust mechanisms to detect and mitigate the effects of the attack vectors on grid operations. We discuss some related works in this section to understand the gaps in this domain and motivate our contributions. Anomaly detection: Recent works on smart grid security often focus on single state variables such as grid frequency when developing anomaly detection mechanisms [19], [32], [33], [34], [35], [36]. However, the North American Electric Reliability Corporation (NERC) imposes strict reliability standards on the power grid to ensure stability under a va- riety of system conditions and potential contingencies [37]. These standards are designed to prevent cascading failures and have recently been updated to include cybersecurity protections [37], though they do not fully mitigate complex threats that exploit grid transient dynamics [14]. In contrast, our methodology monitors all state variables of the smart grid, thereby enhancing the detection of a broader range of attacks and improving responsiveness to transient dynamics. Attack mitigation: Research studies [6], [18], [38] rec- ommend modifications to the operation of existing grid protection schemes to mitigate the impacts of load alter- ation and scaling attacks. The works in [6], [38] proposed triggering Under Frequency Load Shedding (UFLS) at the buses exhibiting the highest rate of voltage change, aiming to address the power supply-demand imbalance caused by MaD IoT attacks. Meanwhile, [18] suggested activating 20% OFGT/UFGT immediately when the grid operational fre- quency deviates from the safe range of S ∈[59.5, 60.5] Hz. However, these attack mitigation strategies are tailored for specific scenarios and do not guarantee effective mitigation against a wide variety of cyber-physical attacks targeting grids, as discussed in Section 7.1. Additionally, the efficacy of these strategies in ensuring safe grid operation under natural disturbance conditions, such as transformer outages, remains uncertain. Our formally verified attack mitigation framework ef- fectively counters a range of cyber-physical attacks on grid behavior and has also demonstrated effectiveness against natural grid disturbances. The training of the defender agent across various attack scenarios, followed by the validation of the agent’s neural networks, equips it to handle worst- case adversarial attacks even in the presence of errors in grid model parameters. 9. Limitations While our DRL-based defender agent demonstrates ro- bust performance in mitigating various cyber-physical at- tacks, there are inherent limitations in our current method- ology that need to be addressed. A significant limitation is our approach to training the defender agent, where we have considered only one attack scenario at a time. This single-scenario approach may not fully capture the complex dynamics of the grid that can occur when multiple attack vectors are active simultaneously. This omission of mul- tivariate attack scenarios could limit the defender agent’s ability to generalize its response strategies to complex and coordinated attacks that might target multiple surfaces of the grid simultaneously. Such limitations in the training setup could potentially reduce the efficacy of the defender agent under diverse or evolving attack conditions not previously encountered during its training phase. 10. Conclusion and Future Work In this paper, we have proposed and validated a deep reinforcement learning (DRL)-based framework designed to enhance the security of smart grids against state-of-the- art cyber-physical attacks by updating traditional grid pro- tection schemes. Through extensive real-time simulations, we demonstrated that our DRL defender agent significantly outperforms traditional protection schemes in mitigating so- phisticated attacks across various scenarios, including MaD IoT, FDIA, scaling, and CBT attacks. Notably, our formally verified defender agent ensures reliable grid operation and prevents customer equipment from damage. In the future, we intend to train the defender agent by employing com- binations of multiple attack scenarios targeting different surfaces of the smart grids. This will broaden the range of applications of our proposed DRL-based defender. We will also explore other reinforcement learning policies, such as Proximal Policy Optimization (PPO) [39], TD3 [40], etc. to determine which policy best enables the defender agent to mitigate attacks. This approach will allow us to prepare a more comprehensive dataset for the training of the defender agent, thereby enhancing its effectiveness and robustness in real-world settings. References [1] S. Goel, Y. Hong, V. Papakonstantinou, D. Kloza, S. Goel, and Y. Hong, “Security challenges in smart grid implementation,” Smart grid security, pp. 1–39, 2015. [2] S. Liu, S. Mashayekh, D. Kundur, T. Zourntos, and K. Butler-Purry, “A framework for modeling cyber-physical switching attacks in smart grid,” IEEE Transactions on Emerging Topics in Computing, vol. 1, no. 2, pp. 273–285, 2013. [3] G. Liang, J. Zhao, F. Luo, S. R. Weller, and Z. Y. Dong, “A review of false data injection attacks against modern power systems,” IEEE Transactions on Smart Grid, vol. 8, no. 4, pp. 1630–1638, 2016. [4] G. Liang, S. R. Weller, J. Zhao, F. Luo, and Z. Y. Dong, “The 2015 ukraine blackout: Implications for false data injection attacks,” IEEE transactions on power systems, vol. 32, no. 4, pp. 3317–3318, 2016. [5] S. Soltan, P. Mittal, and H. V. Poor, “BlackIoT:IoT botnet of high wattage devices can disrupt the power grid,” in 27th USENIX Security Symposium (USENIX Security 18), pp. 15–32, 2018. [6] T. Shekari, A. A. Cardenas, and R. Beyah, “MaDIoT 2.0: Modern High-Wattage IoT botnet attacks and defenses,” in 31st USENIX Security Symposium (USENIX Security 22), pp. 3539–3556, 2022. [7] D. Deka, R. Baldick, and S. Vishwanath, “One breaker is enough: Hidden topology attacks on power grids,” in 2015 IEEE Power & Energy Society General Meeting, pp. 1–5, IEEE, 2015. [8] X. He, X. Liu, and P. Li, “Coordinated false data injection attacks in agc system and its countermeasure,” IEEE Access, vol. 8, pp. 194640– 194651, 2020. [9] R. Tan, H. H. Nguyen, E. Y. Foo, X. Dong, D. K. Yau, Z. Kalbarczyk, R. K. Iyer, and H. B. Gooi, “Optimal false data injection attack against automatic generation control in power grids,” in 2016 ACM/IEEE 7th International Conference on Cyber-Physical Systems (ICCPS), pp. 1– 10, IEEE, 2016. [10] A. Anwar and A. N. Mahmood, “Stealthy and blind false injection attacks on scada ems in the presence of gross errors,” in 2016 IEEE Power and Energy Society General Meeting (PESGM), pp. 1–5, IEEE, 2016. [11] Y. W. Law, T. Alpcan, and M. Palaniswami, “Security games for risk minimization in automatic generation control,” IEEE Transactions on Power Systems, vol. 30, no. 1, pp. 223–232, 2014. [12] R. Tan, H. H. Nguyen, E. Y. Foo, D. K. Yau, Z. Kalbarczyk, R. K. Iyer, and H. B. Gooi, “Modeling and mitigating impact of false data injection attacks on automatic generation control,” IEEE Transactions on Information Forensics and Security, vol. 12, no. 7, pp. 1609–1624, 2017. [13] R. Tan, V. Badrinath Krishna, D. K. Yau, and Z. Kalbarczyk, “Impact of integrity attacks on real-time pricing in smart grids,” in Proceedings of the 2013 ACM SIGSAC conference on Computer & communica- tions security, pp. 439–450, 2013. [14] Z. Huang, S. Etigowni, L. Garcia, S. Mitra, and S. Zonouz, “Al- gorithmic attack synthesis using hybrid dynamics of power grid critical infrastructures,” in 2018 48th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN), pp. 151– 162, IEEE, 2018. [15] B. Huang, A. A. Cardenas, and R. Baldick, “Not everything is dark and gloomy: Power grid protections against IoT demand attacks,” in 28th USENIX Security Symposium (USENIX Security 19), pp. 1115– 1132, 2019. [16] J. Ospina, X. Liu, C. Konstantinou, and Y. Dvorkin, “On the feasi- bility of load-changing attacks in power systems during the covid-19 pandemic,” IEEE Access, vol. 9, pp. 2545–2563, 2020. [17] B. Singer, A. Pandey, S. Li, L. Bauer, C. Miller, L. Pileggi, and V. Sekar, “Shedding light on inconsistencies in grid cybersecurity: Disconnects and recommendations,” in 2023 IEEE Symposium on Security and Privacy (SP), pp. 38–55, IEEE, 2023. [18] S. Maiti, A. Balabhaskara, S. Adhikary, I. Koley, and S. Dey, “Targeted attack synthesis for smart grid vulnerability analysis,” in Proceedings of the 2023 ACM SIGSAC Conference on Computer and Communications Security, pp. 2576–2590, 2023. [19] S. Amini, F. Pasqualetti, M. Abbaszadeh, and H. Mohsenian-Rad, “Hierarchical location identification of destabilizing faults and attacks in power systems: A frequency-domain approach,” IEEE Transactions on Smart Grid, vol. 10, no. 2, pp. 2036–2045, 2017. [20] P. S. Kundur et al., Power system stability and control. McGraw-Hill Education, 2022. [21] P. K. Mohanty, B. K. Sahu, T. K. Pati, S. Panda, and S. K. Kar, “Design and analysis of fuzzy pid controller with derivative filter for agc in multi-area interconnected power system,” IET Generation, Transmission & Distribution, vol. 10, no. 15, pp. 3764–3776, 2016. [22] Z. A. Obaid, L. M. Cipcigan, L. Abrahim, and M. T. Muhssin, “Frequency control of future power systems: reviewing and evaluating challenges and new control methods,” Journal of Modern Power Systems and Clean Energy, vol. 7, no. 1, pp. 9–25, 2019. [23] D. U. Case, “Analysis of the cyber attack on the ukrainian power grid,” Electricity Information Sharing and Analysis Center (E-ISAC), vol. 388, no. 1-29, p. 3, 2016. [24] T. Shekari, C. Irvene, A. A. Cardenas, and R. Beyah, “Mamiot: Manipulation of energy market leveraging high wattage iot botnets,” in Proceedings of the 2021 ACM SIGSAC Conference on Computer and Communications Security, pp. 1338–1356, 2021. [25] H. Abbas, G. Fainekos, S. Sankaranarayanan, F. Ivanˇci´c, and A. Gupta, “Probabilistic temporal logic falsification of cyber-physical systems,” ACM Transactions on Embedded Computing Systems (TECS), vol. 12, no. 2s, pp. 1–30, 2013. [26] M. I. Ribeiro, “Kalman and extended kalman filters: Concept, deriva- tion and properties,” Institute for Systems and Robotics, vol. 43, no. 46, pp. 3736–3741, 2004. [27] K. Fujii, “Extended kalman filter,” Refernce Manual, vol. 14, p. 41, 2013. [28] S. Bak and P. S. Duggirala, “Hylaa: A tool for computing simulation- equivalent reachability for linear systems,” in Proceedings of the 20th International Conference on Hybrid Systems: Computation and Control, pp. 173–178, 2017. [29] T. P. Lillicrap, J. J. Hunt, A. Pritzel, N. Heess, T. Erez, Y. Tassa, D. Silver, and D. Wierstra, “Continuous control with deep reinforce- ment learning,” arXiv preprint arXiv:1509.02971, 2015. [30] S. Bak, H.-D. Tran, K. Hobbs, and T. T. Johnson, “Improved geomet- ric path enumeration for verifying relu neural networks,” in Computer Aided Verification: 32nd International Conference, CAV 2020, Los Angeles, CA, USA, July 21–24, 2020, Proceedings, Part I 32, pp. 66– 96, Springer, 2020. [31] H.-D. Tran, X. Yang, D. Manzanas Lopez, P. Musau, L. V. Nguyen, W. Xiang, S. Bak, and T. T. Johnson, “Nnv: the neural network verification tool for deep neural networks and learning-enabled cyber- physical systems,” in International Conference on Computer Aided Verification, pp. 3–17, Springer, 2020. [32] E. Handschin, F. C. Schweppe, J. Kohlas, and A. Fiechter, “Bad data analysis for power system state estimation,” IEEE Transactions on Power Apparatus and Systems, vol. 94, no. 2, pp. 329–337, 1975. [33] S. Li, A. Pandey, B. Hooi, C. Faloutsos, and L. Pileggi, “Dynamic graph-based anomaly detection in the electrical grid,” IEEE Transac- tions on Power Systems, vol. 37, no. 5, pp. 3408–3422, 2021. [34] F. F. Wu and W.-H. Liu, “Detection of topology errors by state estimation (power systems),” IEEE Transactions on Power Systems, vol. 4, no. 1, pp. 176–183, 1989. [35] S. Li, A. Pandey, and L. Pileggi, “A convex method of generalized state estimation using circuit-theoretic node-breaker model,” IEEE Transactions on Power Systems, 2023. [36] P. M. Esfahani, M. Vrakopoulou, K. Margellos, J. Lygeros, and G. Andersson, “A robust policy for automatic generation control cyber attack in two area power network,” in 49th IEEE conference on decision and control (CDC), pp. 5973–5978, IEEE, 2010. [37] P. W. Raun, “Fiddling with the switch: Why critical infrastructure protection standard cip-008-6 should be adjusted to achieve its goal of maintaining and promoting a robust american bulk power system,” Iowa L. Rev., vol. 106, p. 2079, 2020. [38] M. Abedini, M. Sanaye-Pasand, and S. Azizi, “Adaptive load shed- ding scheme to preserve the power system stability following large disturbances,” IET Generation, Transmission & Distribution, vol. 8, no. 12, pp. 2124–2133, 2014. [39] Z. Wu, C. Yu, D. Ye, J. Zhang, H. H. Zhuo, et al., “Coordinated proximal policy optimization,” Advances in Neural Information Pro- cessing Systems, vol. 34, pp. 26437–26448, 2021. [40] O. E. Egbomwan, S. Liu, and H. Chaoui, “Twin delayed deep deterministic policy gradient (td3) based virtual inertia control for inverter-interfacing dgs in microgrids,” IEEE Systems Journal, 2022.