Mitigating Moral Hazard in Cyber Insurance Using Risk Preference Design Shutian Liu and Quanyan Zhu Abstractâ€” Cyber insurance is a risk-sharing mechanism that can improve cyber-physical systems (CPS) security and resilience. The risk preference of the insured plays an impor- tant role in cyber insurance markets. With the advances in information technologies, it can be reshaped through nudging, marketing, or other types of information campaigns. In this paper, we propose a framework of risk preference design for a class of principal-agent cyber insurance problems. It creates an additional dimension of freedom for the insurer for designing incentive-compatible and welfare-maximizing cyber insurance contracts. Furthermore, this approach enables a quantitative approach to reduce the moral hazard that arises from information asymmetry between the insured and the insurer. We characterize the conditions under which the optimal contract is monotone in the outcome. This justiï¬es the feasibility of linear contracts in practice. This work establishes a metric to quantify the intensity of moral hazard and create a theo- retic underpinning for controlling moral hazard through risk preference design. We use a linear contract case study to show numerical results and demonstrate its role in strengthening CPS security. I. INTRODUCTION Recent years have witnessed signiï¬cant advances in the development and social impacts of Cyber-Physical System (CPS) technologies, including smart grids, autonomous ve- hicle systems, and implantable medical devices [1]. CPS are complex systems integrating various components and technologies (e.g., Information Technologies and Operational Technologies) to enable mission-critical functions. As a result, CPS inherits vulnerabilities from many sources. These vulnerabilities can be exploited by attackers and inï¬‚ict CPS users signiï¬cant losses, and they are hard to eliminate. There is a crucial need to reduce the risk of CPS users and increase the resiliency in face of attacks. Cyber insurance is a ï¬nancial product that transfers cyber risks between the insurer and the insured. Complementary to cyber protection/defense mechanisms, it aims to improve the cyber resiliency of a system by mitigating the ï¬nancial losses as a result of successful attacks. Cyber insurance involves a contractual agreement that determines the premium and the coverage of the insurance contract. The premium is an amount of fee paid by the insured to the insurer to participate in the insurance program. The coverage speciï¬es the amount of loss the insurer will cover. With a properly designed contract, the security of CPS users can beneï¬t from cyber insurance. One design framework for cyber insurance relies on a class of principal-agent models [2], which capture the information asymmetry between the insurer and the insured. The asymmetry leads to the moral hazard phenomenon [3] in which the insured users tend to behave more recklessly when interacting with the system and result in severe consequences. Risk aversion plays an important role in moral hazard. It is known that risk-averse behaviors of the user can increase the gap between the principalâ€™s proï¬ts obtained from the contract with the full observability of the userâ€™s action and the contract when the userâ€™s action is hidden. This phenomenon is absent when the insurer meets a risk-neutral user [4]. Hence, measuring the level of risk aversion is essential in investigating the effect of moral hazard on cyber insurance. Risk measure [5] provides a convenient way to quantify the risks and model agentsâ€™ risk perception or preferences. Different from the risk described under the expected utility theory, risk measure is richer in capturing individual percep- tions of risks induced by the probabilistic nature of random outcomes. The design of risk measure is a way to control the risk preferences of the agents using exogenous inï¬‚uences such as nudging, marketing, and propaganda [6], [7]. Fig. 1: Risk Preference Design Framework for Cyber In- surance: An insurer aims to reshape the risk perception of the users and design incentive-compatible cyber insurance contracts. The loss from the cyber risks is covered by the insurer after an active defense from the insured user. This work aims to propose, as shown in Fig. 1, a risk preference design framework to shape the usersâ€™ risk pref- erences for high-performance cyber insurance. We consider a class of principle-agent problems in which one principal meets an idiosyncratic individual from a population of agents. Each agent has a risk preference type associated with an idiosyncratic risk measure. The goal of the design aims to optimize the proï¬t of the insurer. We formulate the problem as a bilevel optimization problem. In the upper-level insurerâ€™s problem, the insurer optimizes her proï¬t by offering a contract and performing risk preference design subject to participation constraints. In the lower-level userâ€™s problem, the user follows the claimed contract under the chosen risk preference. Using the risk preference design framework, we charac- terize the solution to the insurerâ€™s problem by imposing the conditions under which the optimal contract exhibits monotonicity. This paves the way for considering linear arXiv:2203.12001v1 [cs.GT] 22 Mar 2022 contracts in practice. We quantify the Intensity of Moral Hazard (IMH) by benchmarking the action of the user from solving his problem with the action obtained from the full-information counterpart of the insurerâ€™s problem. Leveraging the optimality conditions of the contract problems, we quantify how IMH varies according to the change in the risk preference type distributions. This analysis enables the risk preference design for mitigating moral hazard and creates a revenue-compatible design for the principal. In the case study, we use linear contracts as an example to show that risk preference design reduces moral hazard and improves security. Section II provides a brief literature review. Section III introduces risk preference types and formulates the design problem. Section IV analyzes the optimal contract and the proposed approach to quantify moral hazard. Section V contains a case study. Section VI concludes the paper. II. RELATED WORKS One of the classic approaches to model risk perception relies on the expected utility theory of [8], where decisions of the players or the agents are assumed to maximize their utility. The concept is extended in [9] and [10] to the well-known Arrow-Pratt measure of absolute risk aversion. Another related approach is the cumulative prospect theory of [11], where the probability of the random outcomes is weighted. Motivated by the cumulative prospect theory, we use risk measures to capture individual risk preferences. The seminal work [5] has proposed to adopt coherent risk measures (CRMs) for risk quantiï¬cation. The axioms that a CRM satisï¬es not only make it meaningful in practice but also enables the dual representation [5], [12]. This representation shows the robustness of a CRM and connects it with the popular distributionally robust optimization [13]. Risk design is closely related to system robustness [14]. Risk design in cyber insurance elicits human behaviors that have an impact on cyber security and resilience. In [15], the authors have proposed a pre-screening method to increase network security by designing incentive contract which increases usersâ€™ effort levels. In [16], the authors have have shown that an increased level of risk aversion increases the social welfare gain from using cyber insurance for protection. This work aims to consolidate the design of risk preferences of users into cyber insurance to further mitigate cyber risks. III. PROBLEM FORMULATION In this section, we introduce the framework of cyber insurance with risk preference design. We present the concept of risk preference types to model different perceptions of risks in connection with a class of principal-agent problems. A. Risk preference types Consider a mass 1 population of users of networked systems. This population faces uncertainties that arise from cyber risks captured by the probability space (Î,F) with the reference probability measure P. We use Î¾ âˆˆÎ âŠ‚R to denote a sampled outcome. We denote by Z : Î â†’R a random loss, where Z is a measurable function with ï¬nite p-th order moment from the space Z := Lp(Î,F,P). The parameter p lives in [1,+âˆ). Individuals in this population possess different risk preferences toward uncertainty. In particular, each individual is identiï¬ed with a risk preference type Î¸ âˆˆÎ˜ âŠ‚R. A risk preference of type Î¸ determines the way userâ€™s perception of risks, and it is captured by a risk measure ÏÎ¸ : Z â†’R. Let (Î˜,G ) denote the underlying probability space of risk preference types. The risk preference types in the population are distributed according to a probability measure Âµ0 from the set of probability measures Q deï¬ned on (Î˜,G ). Note that, in practice, Âµ0 can be known by collecting information through questionnaires or analyzing historical customer behaviors. The goal of risk preference design is to ï¬nd a distribution Âµ âˆˆQ so that incentive contracts can be created between the users and the insurer to cover potential losses due to usersâ€™ cyber risks. We consider designing the distribution of risk preferences owing to the following three reasons. First, the utility of the insurer is measured by the outcome of a population of users participating in the contract. Hence the expected utility captures the incentives of the insurer. Second, it is difï¬cult to design customized contracts as precise individual userâ€™s risk perception is hard to measure. The collective pattern of the users of the same type can be statistically measured. Third, this distributional perspective can be endowed with an interpretation that the insurer and the same user interact repeatedly for a sufï¬ciently long period of time. We will elaborate this point further in Section III-B. We assume that the risk measures ÏÎ¸ for all Î¸ âˆˆÎ˜ are CRMs [5]. Below is the deï¬nition of coherent risk measures. Deï¬nition 1 (Coherent Risk Measures [5]): A function Ï : Z â†’R is called a Coherent Risk Measure if it satisï¬es (A1) Monotonicity: Ï(Z) â‰¥Ï(Zâ€²) if Z,Zâ€² âˆˆZ and Z âª°Zâ€². (A2) Convexity: Ï(tZ +(1âˆ’t)Zâ€²) â‰¤tÏ(Z)+(1âˆ’t)Ï(Zâ€²) for all Z,Zâ€² âˆˆZ and t âˆˆ[0,1]. (A3) Translation equivariance: If Z âˆˆZ and a âˆˆR, then Ï(Z +a) = Ï(Z)+a. (A4) Positive homogeneity: Ï(tZ) = tÏ(Z) if Z âˆˆZ and t âˆˆR+. One of the most signiï¬cant consequences of CRMs is their dual representation [5], [12]. Let Z âˆ—:= Lq(Î,F,P) for q âˆˆ(1,âˆ] denote the dual space of Z , i.e., 1 p + 1 q = 1. Following [5], [12], the dual representation of ÏÎ¸ is ÏÎ¸[Z(Î¾)] = sup Î¶âˆˆAÎ¸ Z Î Z(Î¾)Î¶(Î¾)dP(Î¾,x), (1) where AÎ¸ âŠ‚Z âˆ—denotes the dual set associated with the risk measure ÏÎ¸. The set AÎ¸ is convex and compact when p âˆˆ[1,+âˆ) [17]. Hence, the maximum of (1) is attained. B. Cyber Insurance with Risk Preference Design We incorporate the risk preference types discussed in Section III-A into a principal-agent problem by specifying the following action-outcome relation. Consider a principal-agent problem with one principal and one agent. Let x âˆˆX denote the agentâ€™s action, which represents the amount of security investment that he spends on his device. We set Î := [Î¾, Â¯Î¾] and identify it as the set of random cyber risks which affect the costs of both the principal and the agent. The parameterized probability measure P(Î¾,x) describes the stochastic relation between the cyber risk and the security investment. We assume that for all x âˆˆX, P(Î¾,x) is absolutely continuous with the reference probability measure P(Î¾), i.e., there is a density function p(Î¾,x) such that dP(Î¾,x) = p(Î¾,x)dP(Î¾). And we assume that p(Â·,x) is differentiable for all x âˆˆX and p(Î¾,Â·) is continuously differentiable for all Î¾ âˆˆÎ. The insurer acts as the principal in the problem. She has the power of claiming a coverage plan of the cyber losses described by the function w(Â·) : Î â†’Î and choosing a distribution of risk preference types Âµ âˆˆQ for the users. For a given cyber risk Î¾, she observes cost (or negative proï¬t) w(Î¾)+Î¾. We assume that the insurer is risk-neutral. Hence, her expected cost from claiming a plan w(Â·) is R Î w(Î¾) + Î¾dP(Î¾,x). The manipulation of risk preferences can come with a cost. We introduce the order-1 Wasserstein distance [18] W1(Âµ,Âµ0) to represent the cost associated with the effort to change the risk preference distribution from Âµ0 to Âµ. The cost of the insurer in designing w(Â·) and Âµ is Z Î w(Î¾)+Î¾dP(Î¾,x)+Î³W1(Âµ,Âµ0), (2) where Î³ > 0 represents the monetary cost of risk manipulation. Consider a user with type Î¸i. If he takes action xi under plan w(Â·), the cyber risk that he perceives is ÏÎ¸i[U(w(Î¾),xi)] with the random cost U âˆˆZ . We assume that U is increasing and convex in w, which indicates that the users exhibit loss aversion. Note that since U can be understood as a disutility function, our assumptions on U are consistent with the assumptions that a utility function is non-decreasing and concave. In the literature, these assumptions are often referred to as â€™risk aversionâ€™ [2]. We use the term loss aversion to distinguish it from risk preferences represented by the risk measures ÏÎ¸. Our treatment of risk is motivated by [11], where the authors combine the loss aversion and the probability weighting to characterize decisions under risk. The agent is assume to be an idiosyncratic individual from the population of users who bears the averaged action x. When the type distribution is Âµ, the cost of the agent is Z Î˜ ÏÎ¸[U(w(Î¾),x)]dÂµ(Î¸). (3) Note that in (3), the randomness is addressed by the risk measures ÏÎ¸; the integral over Î˜ represents an averaging over all the risk preference which generates the averaged action x. Let Â¯U > 0 denote the deterministic cyber risk threshold that the agent can bear. The hidden action cyber insurance problem with risk-preference design is formulated as follows: min w(Â·),Âµ(Â·),x Z Î w(Î¾)+Î¾dP(Î¾,x)+Î³W1(Âµ,Âµ0) s.t. Z Î˜ ÏÎ¸[U(w(Î¾),x)]dÂµ(Î¸) â‰¤Â¯U,(IR), x âˆˆargmin xâ€²âˆˆX Z Î˜ ÏÎ¸[U(w(Î¾),xâ€²)]dÂµ(Î¸),(IC). (4) In (4), (IR) is the individual rationality constraint guaranteeing that participation beneï¬ts the agent; (IC) is the incentive compatibility constraint stating that the agent should minimize his own cost when his action is hidden. The main difference between (4) and the classical principal- agent problems is that the distribution Âµ characterizing the distribution of risk preferences of the users becomes part of the design, offering a new degree of freedom to model the informational inï¬‚uences on the users and create additional control to elicit proper cyber hygiene of the users and, at the meantime, improve the social welfare and the proï¬t. Furthermore, as we will show in Section IV, the risk preference design mitigates the moral hazard issue. IV. ANALYSIS OF THE DESIGN FRAMEWORK A. Characterization of Optimal Contracts In this section, we use the ï¬rst-order approach to charac- terize several properties of the optimal coverage plan for the contract problems deï¬ned in Section III. We obtain conditions for the monotonicity of w(Â·). Consider the ï¬rst-order optimality condition of (IC): âˆ‚ âˆ‚x Z Î˜ ÏÎ¸[U(w(Î¾),x)]dÂµ(Î¸) = 0. (5) We assume that the set of density functions which attains the maximum of (1) is a singleton for all Î¸ âˆˆÎ˜, i.e., âˆ‚ÏÎ¸[U(w(Î¾),x)] = { Â¯Î¶Î¸(Î¾,x)}. Then, (5) leads to 0 = âˆ‚ âˆ‚x Z Î˜ Z ÎU(w(Î¾),x) Â¯Î¶Î¸(Î¾,x)p(Î¾,x)dP(Î¾)dÂµ(Î¸) = âˆ‚ âˆ‚x Z Î Z Î˜ Â¯Î¶Î¸(Î¾,x)dÂµ(Î¸)  U(w(Î¾),x)p(Î¾,x)dP(Î¾). (6) Ignoring the second-order optimality condition of (IC), we ï¬nd (6) as an alternative for the (IC) in (4). The Lagrangian of problem (4) when (IC) is substituted by the ï¬rst-order condition (6) can be expressed as the following: L = Z Î w(Î¾)+Î¾dP(Î¾,x)+Î³W1(Âµ,Âµ0) +Î± Z Î˜ ÏÎ¸[U(w(Î¾),x)]dÂµ(Î¸)âˆ’Â¯U +Î² âˆ‚ âˆ‚x Z Î˜ EÂµ[ Â¯Î¶Î¸(Î¾,x)]U(w(Î¾),x)p(Î¾,x)dP(Î¾)dÂµ(Î¸). (7) Deï¬ne Ï€(Î¾,Î¸,x) = Â¯Î¶Î¸(Î¾,x)p(Î¾,x). Minimizing w(Î¾) point- wise in Î¾, we obtain the ï¬rst-order condition of (7) for Î¾ âˆˆÎ: âˆ’p(Î¾,x) = EÂµ  Î±Ï€(Î¾,Î¸,x) âˆ‚ âˆ‚wU(w(Î¾),x) +Î² âˆ‚ âˆ‚w  Ï€(Î¾,Î¸,x) âˆ‚ âˆ‚xU(w(Î¾),x)+U(w(Î¾),x) âˆ‚ âˆ‚xÏ€(Î¾,Î¸,x)  . (8) Before we proceed, we make the assumption that âˆ‚2 âˆ‚xâˆ‚wU(w(Î¾),x) = 0. Note that this assumption is weaker than the one that the agentâ€™s cost is separable in the security investment and the gain from the coverage plan in the cyber insurance contract. After several steps of algebraic manipulations, (8) leads to âˆ’p(Î¾,x) = EÂµ  Î±Ï€(Î¾,Î¸,x) âˆ‚ âˆ‚wU(w(Î¾),x)+Î² âˆ‚ âˆ‚wU(w(Î¾),x) âˆ‚ âˆ‚xÏ€(Î¾,Î¸,x)  = âˆ‚ âˆ‚wU(w(Î¾),x)Â·EÂµ  Î±Ï€(Î¾,Î¸,x)+Î² âˆ‚ âˆ‚xÏ€(Î¾,Î¸,x)  . (9) Dividing both sides of (9) by p(Î¾,x) âˆ‚ âˆ‚wU(w(Î¾),x), we obtain âˆ’1 âˆ‚ âˆ‚wU(w(Î¾),x) = EÂµ ( Î± Â¯Î¶Î¸(Î¾,x)+Î² âˆ‚ âˆ‚x Â¯Î¶Î¸(Î¾,x)+ Â¯Î¶Î¸(Î¾,x) âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) !) = EÂµ  Â¯Î¶Î¸(Î¾,x) Â· Î± +Î² âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) ! +Î²EÂµ  âˆ‚ âˆ‚x Â¯Î¶Î¸(Î¾,x)  . (10) Differentiating with respect to Î¾ over Â¯Î on both sides of (10), we obtain wâ€²(Î¾)Â· âˆ‚2 âˆ‚w2U(w(Î¾),x)  âˆ‚ âˆ‚wU(w(Î¾),x) 2 = Î² âˆ‚ âˆ‚Î¾ EÂµ  âˆ‚ âˆ‚x Â¯Î¶Î¸(Î¾,x)  + âˆ‚ âˆ‚Î¾ ( EÂµ[ Â¯Î¶Î¸(Î¾,x)]Â· Î± +Î² âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) !) . (11) The above discussions lead to the following result, which characterizes the monotonicity of the optimal coverage plan. Proposition 1: Suppose that the density function Â¯Î¶Î¸(Â·,x) is differentiable on a subset Â¯Î âŠ‚Î. Then, the optimal coverage plan w of (4) is increasing in the cyber risk on Â¯Î, i.e., wâ€²(Î¾) â‰¥0, if the following conditions hold: (C1) The functions p(Î¾,x) and Â¯Î¶Î¸(Î¾,x) satisfy âˆ‚ âˆ‚x R Î p(Î¾,x)dÎ¾ > 0 and âˆ‚ âˆ‚x R Î Â¯Î¶Î¸(Î¾,x)dÎ¾ > 0, respectively; (C2) Severe loss avoidance: âˆ‚ âˆ‚Î¾ EÂµ  âˆ‚ âˆ‚x Â¯Î¶Î¸(Î¾,x)  â‰¥0; (C3) Risk-sensitive monotone likelihood ratio property: âˆ‚ âˆ‚Î¾ ( EÂµ[ Â¯Î¶Î¸(Î¾,x)]Â· Î± +Î² âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) !) â‰¥0. Proof: By combining (C1) with the convexity of U with respect to w, we can show Î² > 0 using the similar arguments as in [3]. When (C2) and (C3) hold, the optimality condition (11) leads to the monotonicity of w. The conditions in Proposition 1 have the following interpre- tations. Condition (C1) implies two facts. First, without taking the userâ€™s risk preference into account, the true likelihood for higher cyber risks to occur decreases when the security investment increases. Second, the perceived likelihood for higher cyber risks to occur of a user with risk preference type Î¸ is decreased when the security investment increases. These two facts are consistent within the cyber insurance context. Before we elaborate on condition (C2), we ï¬rst observe the following fact. Since the coverage plan w is increasing in the cyber risk Î¾ and the cost U is increasing in w, we conclude that U is also increasing in Î¾. In addition, from (1), we know that for all Î¸ the optimal density function Â¯Î¶Î¸(Î¾,x) is increasing in Î¾, i.e., âˆ‚ âˆ‚Î¾ Â¯Î¶Î¸(Î¾,x) > 0. Then, condition (C2) means that an increase in the userâ€™s security investment shows his panic towards the potential occurrences of severer cyber risks. In other words, the user tries to avoid severe losses. Condition (C3) is the risk-sensitive counterpart of the monotone likelihood ratio property: âˆ‚ âˆ‚Î¾ âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) ! â‰¥0. (12) Note that the conditions for proving monotonicity on Â¯Î can reduce to simply (C1) and the standard monotone likelihood ratio property for some commonly used CRMs, such as the mean semideviation measure and the average value-at-risk measure [12]. The reason lies in that the density function Â¯Î¶Î¸(Î¾,x) of these two measures is piecewise constant. It means that the right-hand side of (11) becomes EÂµ[ Â¯Î¶Î¸(Î¾,x)]Â· âˆ‚ âˆ‚Î¾ Î± +Î² âˆ‚ âˆ‚x p(Î¾,x) p(Î¾,x) ! . Then, we can recover (12). B. Mitigation of moral hazard It is well-known from the literature that one of the causes of moral hazard is the issue of hidden action; i.e., the insurer cannot observe the action taken by the insured. In this section, we propose to measure the IMH and provide a method to mitigate moral hazard. For notational simplicity, we consider an n-dimensional ï¬nite risk preference type space Î˜ = {Î¸1,Î¸2,...,Î¸n} with probability measure Âµ = (Âµ1,Âµ2,...,Âµn)T. a) Measuring the IMH: We ï¬rst consider the following full-information benchmark associated with (4) assuming that the risk preference distribution Âµ is given: min w(Â·),x Z Î w(Î¾)+Î¾dP(Î¾,x)+Î³W1(Âµ,Âµ0) s.t. n âˆ‘ i=1 ÏÎ¸i[U(w(Î¾),x)]Â· Âµi â‰¤Â¯U,(IR). (13) Let wâˆ—and xâˆ—denote the optimal solution of (13) given Âµ. The Lagrangian of (13) is Lb = Z Î(w(Î¾)+Î¾)p(Î¾,x)dP(Î¾)+Î³W1(Âµ,Âµ0) +Î± n âˆ‘ i=1 ÏÎ¸i[U(w(Î¾),x)]Â· Âµi âˆ’Â¯U ! . (14) Then, the action xâˆ—solves 0 = âˆ‚ âˆ‚xLb = âˆ‚ âˆ‚x Z Î(wâˆ—(Î¾)+Î¾)p(Î¾,x)dP(Î¾) +Î± âˆ‚ âˆ‚x n âˆ‘ i=1 ÏÎ¸i[U(wâˆ—(Î¾),x)]Â· Âµi. (15) Hidden actions refer to the fact that xâˆ—will not be the real action taken by the agent after receiving wâˆ—announced by the principal. From the agentâ€™s perspective, an action xa optimizing his own objective is superior, i.e., xa such that xa âˆˆargmin xâˆˆX n âˆ‘ i=1 ÏÎ¸i[U(wâˆ—(Î¾),x)]Â· Âµi. (16) Therefore, the deviation from xâˆ—to xa is the result of the moral hazard issue and xâˆ—âˆ’xa is a meaningful metric for measuring the IMH. The value of xâˆ—âˆ’xa is nonnegative because of the assumptions made in Section III. Deï¬nition 2: We refer to the quantity xâˆ—âˆ’xa as the IMH. A high value of xâˆ—âˆ’xa indicates an intense moral hazard. Note that (16) is part of the IC constraint in (4). However, the actions solving (4) and 16 are different in general. b) Mitigation of moral hazard through risk preference design: We study how IMH varies according to the changes in Âµ. From (16), xa satisï¬es the following ï¬rst-order condition: âˆ‚ âˆ‚x n âˆ‘ i=1 ÏÎ¸i[U(wâˆ—(Î¾),x)]Â· Âµi = 0. (17) Deï¬ne H1 : X Ã—Q â†’R and H2 : X Ã—Q â†’R according to H1(x,Âµ) = âˆ‚ âˆ‚xLb, (18) as in (15), and H2(x,Âµ) = âˆ‚ âˆ‚x n âˆ‘ i=1 ÏÎ¸i[U(w(Î¾),x)]Â· Âµi. (19) as in (17), respectively. Then, we obtain from (15) and (17) that, for a given Âµ, H1(xâˆ—,Âµ) = 0 and H2(xa,Âµ) = 0. The next result states how to reduce IMH by designing the distribution of risk preference types. Proposition 2: Let xâˆ—and xa denote the isolated local minima of (13) and (16) given Âµ, respectively. Let JH1,x denote the Jacobian matrix of H1 with respect to the ï¬rst argument; let JH2,x denote the Jacobian matrix of H2 with respect to the ï¬rst argument. Then, in a neighborhood NÂµ âŠ‚Q of Âµ, the IMH can be reduced by changing Âµ to Âµâ€² = Âµ +câˆ†Âµ with c > 0 sufï¬ciently small, if âˆ†Âµ satisï¬es (âˆ†Âµ)T Â·âˆ‡T(Âµ) â‰¤0, (20) where âˆ‡T(Âµ) = ( âˆ‚T âˆ‚Âµ1 (Âµ), âˆ‚T âˆ‚Âµ2 (Âµ),..., âˆ‚T âˆ‚Âµn (Âµ))T with âˆ‚T âˆ‚Âµi (Âµ) =  JH2,x(xa,Âµ) âˆ’1 âˆ‚H2 âˆ‚Âµi (xa,Âµ) âˆ’  JH1,x(xâˆ—,Âµ) âˆ’1 âˆ‚H1 âˆ‚Âµi (xâˆ—,Âµ), (21) for all i = 1,2,...,n. Proof: Consider the optimization problems (13) and (16). Since xâˆ—and xa are local minima, the ï¬rst-order conditions hold, i.e., H1(xâˆ—,Âµ) = 0 and H2(xa,Âµ) = 0. Since the local minima xâˆ—and xa are isolated, the second-order conditions require that âˆ‚2 âˆ‚x2 Lb â‰»0 and âˆ‚2 âˆ‚x2 âˆ‘n i=1 ÏÎ¸i[U(w(Î¾),x)]Â· Âµi â‰»0. Equivalently, we obtain JH1,x(xâˆ—,Âµ) â‰»0 and JH2,x(xa,Âµ) â‰»0. Invoking the implicit function theorem, we know that there exists differentiable functions h1(Â·) and h2(Â·) deï¬ned on neighborhoods Vxâˆ—Ã—V 1 Âµ of (xâˆ—,Âµ) and Vxa Ã—V 2 Âµ of (xa,Âµ), such that h1(Âµ) = xâˆ—and h2(Âµ) = xa. Furthermore, the derivatives of the functions h1(Â·) and h2(Â·) with respect to Âµi for all i = 1,2,...,n are âˆ‚h1 âˆ‚Âµi (Âµ) = âˆ’  JH1,x(h1(Âµ),Âµ) âˆ’1 âˆ‚H1 âˆ‚Âµi (h1(Âµ),Âµ), (22) and âˆ‚h2 âˆ‚Âµi (Âµ) = âˆ’  JH2,x(h2(Âµ),Âµ) âˆ’1 âˆ‚H2 âˆ‚Âµi (h2(Âµ),Âµ), (23) respectively. Let NÂµ = V 1 Âµ âˆ©V 2 Âµ . Deï¬ne T(Âµ) = h1(Âµ) âˆ’ h2(Âµ) with support NÂµ. Then, the quantity xâˆ—âˆ’xa can be represented using T(Âµ) for Âµ âˆˆNÂµ. The gradient âˆ‡T(Âµ) = ( âˆ‚T âˆ‚Âµi (Âµ), âˆ‚T âˆ‚Âµ2 (Âµ),..., âˆ‚T âˆ‚Âµn (Âµ))T follows from (22) and (23) for Âµ âˆˆNÂµ. Next, consider T(Âµâ€²), which represents the IMH when the distribution of risk preference is Âµâ€² = Âµ + câˆ†Âµ. Taylorâ€™s theorem indicates that: T(Âµâ€²) = T(Âµ)+c(âˆ†Âµ)T Â·âˆ‡T(Âµ)+o(c). For sufï¬ciently small c > 0, condition (20) leads to T(Âµâ€²) â‰¤ T(Âµ). This completes the proof. Obtaining the value of IMH relies on solving problems (16) and (13). However, Proposition 2 offers a method to check whether a target distribution of risk preference types mitigates the effect of the moral hazard. c) Design methods: We have shown that the IMH can be mitigated by risk preference design. Next, we show that the direction âˆ†Âµ in 20 can decrease the objective value of (13), making Âµâ€² = Âµ +câˆ†Âµ a favorable design. Before stating the results, we ï¬rst present an equivalent rep- resentation of W1(Âµ,Âµ0). Since we consider ï¬nite probability measures, strong duality holds in the Kantorovich-Rubinstein dual problem [18] of W1(Âµ,Âµ0), i.e., W1(Âµ,Âµ0) = max bâˆˆB n âˆ‘ i=1 biÂµi âˆ’ n âˆ‘ i=1 biÂµ0 i , (24) where B = {b âˆˆRn : |bi âˆ’b j| â‰¤|iâˆ’j|,âˆ€i, j = 1,2,...,n}. Proposition 3: For a given Âµ, let âˆ‡T(Âµ) be deï¬ned as in Proposition 2. Let bâˆ—âˆˆRn denote the solution to (24). Then, there exists âˆ†Âµ, such that by changing Âµ to Âµâ€² = Âµ +câˆ†Âµ, the IMH and the objective cost of (13) decrease, if there does not exist a > 0, such that âˆ’abâˆ—= âˆ‡T(Âµ). (25) Proof: Since in the objective function of (13), the only term depending on Âµ is W1(Âµ,Âµ0), we only need to show that W1(Âµâ€²,Âµ0) â‰¤W1(Âµ,Âµ0) for Âµâ€² = Âµ +câˆ†Âµ. Equivalently, we show that âˆ†Âµ is a descent direction of W1(Âµ,Âµ0). To obtain the descent direction, we compute the gradient of W1(Âµ,Âµ0) using the representation (24). Since (24) is an optimization problem, the envelope theorem indicates that âˆ‡ÂµW1(Âµ,Âµ0) = âˆ‡Âµ n âˆ‘ i=1 bâˆ— i Âµi âˆ’ n âˆ‘ i=1 bâˆ— i Âµ0 i ! = bâˆ—, (26) where bâˆ—solves (24). Then, âˆ†Âµ descends W1(Âµ,Âµ0) if (âˆ†Âµ)T Â·bâˆ—â‰¤0. (27) From Proposition 2, we know that changing Âµ to Âµâ€² mitigates the IMH if âˆ†Âµ satisï¬es condition (20). Hence (20) and (27) lead to the condition (25). This completes the proof. The results in Proposition 2 and Proposition 3 lead to strengthened security for the following reasons. A lower value of the IMH indicates a smaller difference in the action ideal for the insurer and the action the user chooses in reality. It means that there is an increased likelihood to sign a contract where the agreed action generates a reasonable amount of cyber risk that the insurer can bear, and it is not overly challenging for the user to execute. Furthermore, to come up with such a contract, the insurer needs to prepare for the consumption required for shaping the usersâ€™ perceptions. Once the cost of risk design and the cost of coverage do not exceed the payment from the user, a contractual agreement which improves cyber security can be reached. We will elaborate on this point in Section V. V. CASE STUDY: LINEAR CONTRACTS In this section, we use a special case study of linear contracts to show that risk preference design strengthens cyber security. We consider a scenario where an attacker infects a network with ransomware [19]. The network users can defend against the attacker by upgrading their ï¬rewalls to decrease the number of ï¬les locked by the ransomware. This reduces the amount of ransom to pay at a cost of a system upgrade. The users can also buy cyber insurance to cover a portion of their loss by prepaying a premium. Consider two risk preference types where Î¸1 represents the expectation measure, i.e., ÏÎ¸1[Z] = E[Z], and Î¸2 represents the absolute semideviation measure [17] with parameter Îº > 0, i.e., ÏÎ¸2[Z] = E[Z]+ÎºE{[Z âˆ’E[Z]]+}. The original distribu- tion of types is Âµ0 = (Âµ0 1,Âµ0 2). We consider two available system upgrade investments X = {xL,xH} with xL < xH and three possible losses due to the ransomware (Î¾1,Î¾2,Î¾3) = (1,2,3). The probability of (Î¾1,Î¾2,Î¾3) is (0.3,0.4,0.3) under xL and (0.5,0.3,0.2) under xH. Note that this indicates that when the security investment increases, there is a lower likelihood for more severe losses to occur. The insurer offers a linear contract containing a coverage c âˆˆ(0,1) with a premium p > 0. Her expected cost from this contract is E[cÎ¾ âˆ’p]. Since c âˆˆ(0,1), she prefers the high investment xH to the low investment xL from the user. We set the userâ€™s loss aversion to be quadratic; i.e., he perceives Î¾ 2 when the cyber loss is Î¾. The relative cost of investment is m > 0. If the user does not buy insurance, he receives the full cyber loss Î¾ without any coverage from the insurer. The cost for the user is Â¯U(x) = âˆ‘i=1,2 Âµ0 i Â·ÏÎ¸i[Î¾ 2 +mx]. If he purchases the insurance, the cost becomes ËœU(x) = âˆ‘i=1,2 Âµ0 i Â· ÏÎ¸i[((1âˆ’c)Î¾)2 +mx+p]. Suppose m(xH âˆ’xL) > 1.1c2 +0.6Îºc2Âµ0 2. Then, ËœU(xH) > ËœU(xL). From (IC) of (4), we know that the user will only agree on xL in a contract. The moral hazard issue occurs because of the distinction between the insurerâ€™s and userâ€™s preferences over the security investments. Note that participating in the contract is proï¬table if p â‰¤(2câˆ’c2)Â·(3.5+1.25ÎºÂµ0 2). With risk preference design, it is straightforward to observe that as long as we increase the portion of type Î¸2 to Âµ2 such that m(xH âˆ’xL) < 1.1c2 +0.6Îºc2Âµ2, the user prefers xH to xL. It means that by designing the distribution of risk preference types so that more individuals evaluate risk according to the absolute semideviation measure, the moral hazard issue can be mitigated. One of the features of the absolute semideviation measure is that it emphasizes the high impact outcomes in spite of their low possibilities. Hence, a user adopting this perception of risk shows aversion toward severe system losses caused by ransomware. The consequence of this risk preference design is that a reached contract elicits a high-level security effort from the user to protect the system. It not only enables risk sharing between the user and the insurer but also enhances the overall defense against ransomware. VI. CONCLUSION In this paper, we have proposed cyber insurance with a risk preference design framework to provide risk-sharing contracts for cyber-physical systems security. We have deï¬ned risk preference types for users and adopted risk measures to capture their perceptions of cyber losses. We have made the distribution of the types a design parameter in the framework, arming the insurer with an additional dimension of freedom to provide incentive-compatible contracts. Using the proposed measure for moral hazard, we have shown analytically that risk preference design can not only mitigate the moral hazard issue but also enhance the overall security of the system. The structure of our framework is essentially a bilevel programming problem. These problems are hard to solve due to their structural complexity. For future work, we would investigate representations of risk measures to simplify the risk preference design problem. This effort could lead to the equivalents of the agentâ€™s problem, enabling single-level reformulations of the bilevel programming problem. REFERENCES [1] A. Humayed, J. Lin, F. Li, and B. Luo, â€œCyber-physical systems securityâ€”a survey,â€ IEEE Internet of Things Journal, vol. 4, no. 6, pp. 1802â€“1831, 2017. [2] S. J. Grossman and O. D. Hart, â€œAn analysis of the principal-agent problem,â€ in Foundations of insurance economics. Springer, 1992, pp. 302â€“340. [3] B. HolmstrÂ¨om, â€œMoral hazard and observability,â€ The Bell journal of economics, pp. 74â€“91, 1979. [4] H. Chade and V. N. V. De Serio, â€œRisk aversion, moral hazard, and the principalâ€™s loss,â€ Economic Theory, vol. 20, no. 3, pp. 637â€“644, 2002. [5] P. Artzner, F. Delbaen, J.-M. Eber, and D. Heath, â€œCoherent measures of risk,â€ Mathematical ï¬nance, vol. 9, no. 3, pp. 203â€“228, 1999. [6] P. Slovic and E. Peters, â€œRisk perception and affect,â€ Current directions in psychological science, vol. 15, no. 6, pp. 322â€“325, 2006. [7] P. Slovic, â€œThe construction of preference.â€ American psychologist, vol. 50, no. 5, p. 364, 1995. [8] O. Morgenstern and J. Von Neumann, Theory of games and economic behavior. Princeton university press, 1953. [9] K. J. Arrow, â€œThe theory of risk aversion,â€ Essays in the theory of risk-bearing, pp. 90â€“120, 1971. [10] J. W. Pratt, â€œRisk aversion in the small and in the large,â€ in Uncertainty in economics. Elsevier, 1978, pp. 59â€“79. [11] A. Tversky and D. Kahneman, â€œAdvances in prospect theory: Cumu- lative representation of uncertainty,â€ Journal of Risk and uncertainty, vol. 5, no. 4, pp. 297â€“323, 1992. [12] A. RuszczyÂ´nski and A. Shapiro, â€œOptimization of convex risk functions,â€ Mathematics of operations research, vol. 31, no. 3, pp. 433â€“452, 2006. [13] A. Shapiro, â€œDistributionally robust stochastic programming,â€ SIAM Journal on Optimization, vol. 27, no. 4, pp. 2258â€“2275, 2017. [14] S. Liu and Q. Zhu, â€œRobust and stochastic optimization with a hybrid coherent risk measure with an application to supervised learning,â€ IEEE Control Systems Letters, vol. 5, no. 3, pp. 965â€“970, 2020. [15] M. M. Khalili, P. Naghizadeh, and M. Liu, â€œDesigning cyber insurance policies: The role of pre-screening and security interdependence,â€ IEEE Transactions on Information Forensics and Security, vol. 13, no. 9, pp. 2226â€“2239, 2018. [16] D. Kuru and S. Bayraktar, â€œThe effect of cyber-risk insurance to social welfare,â€ Journal of Financial Crime, 2017. [17] A. Shapiro, D. Dentcheva, and A. Ruszczynski, Lectures on stochastic programming: modeling and theory. SIAM, 2021. [18] C. Villani, Optimal transport: old and new. Springer, 2009, vol. 338. [19] Y. Ge and Q. Zhu, â€œAccountability and insurance in iot supply chain,â€ arXiv preprint arXiv:2201.11855, 2022. [20] Q. Zhu, â€œCyber insurance,â€ arXiv preprint arXiv:1810.00290, 2018.