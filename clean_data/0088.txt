1 On Cyber Risk Management of Blockchain Networks: A Game Theoretic Approach Shaohan Feng, Student Member, IEEE, Wenbo Wang, Member, IEEE, Zehui Xiong, Student Member, IEEE, Dusit Niyato, Fellow, IEEE, Ping Wang, Senior Member, IEEE and Shaun Shuxun Wang Abstract—Open-access blockchains based on proof-of-work protocols have gained tremendous popularity for their capabilities of providing decentralized tamper-proof ledgers and platforms for data-driven autonomous organization. Nevertheless, the proof-of-work based consensus protocols are vulnerable to cyber-attacks such as double-spending. In this paper, we propose a novel approach of cyber risk management for blockchain-based service. In particular, we adopt the cyber-insurance as an economic tool for neutralizing cyber risks due to attacks in blockchain networks. We consider a blockchain service market, which is composed of the infrastructure provider, the blockchain provider, the cyber-insurer, and the users. The blockchain provider purchases from the infrastructure provider, e.g., a cloud, the computing resources to maintain the blockchain consensus, and then offers blockchain services to the users. The blockchain provider strategizes its investment in the infrastructure and the service price charged to the users, in order to improve the security of the blockchain and thus optimize its proﬁt. Meanwhile, the blockchain provider also purchases a cyber-insurance from the cyber-insurer to protect itself from the potential damage due to the attacks. In return, the cyber-insurer adjusts the insurance premium according to the perceived risk level of the blockchain service. Based on the assumption of rationality for the market entities, we model the interaction among the blockchain provider, the users, and the cyber-insurer as a two-level Stackelberg game. Namely, the blockchain provider and the cyber-insurer lead to set their pricing/investment strategies, and then the users follow to determine their demand of the blockchain service. Speciﬁcally, we consider the scenario of double-spending attacks and provide a series of analytical results about the Stackelberg equilibrium in the market game. Index Terms—Blockchain service, mining, attack, double-spending, cyber-insurance, game theory. ! 1 INTRODUCTION I N the past few years, blockchain technologies have at- tracted tremendous attention from both industry and academia for distributively providing the irreversible, tamper-evident database of tokenized asset transactions [1]. Furthermore, with the smart contracts [2] enabled on top of the decentralized consensus [1], blockchains are envis- aged to be the “game changer” in various areas ranging from Peer-to-Peer (P2P) resource allocation/trading, e.g., distributed cloud storage [3], to ﬁnancial services, e.g., dig- ital identity management [4] and online markets for crowd- sourcing services [5]. Although with the advantages such as open access, disintermediation, and pure self-organization, open-access/permissionless blockchains rely on the condi- tion of honest majority to guarantee the data integrity and service security, especially when the Nakamoto consensus protocol based on proof-of-work (PoW) is adopted [1]. Since permissionless blockchain networks admit no identity con- trol, they can be vulnerable to a series of insider attacks by malicious consensus nodes [6]. Among different types of attacks, double spending [7] is the most fundamental one and can be executed through various attacks such as goldﬁnger attacks, netsplit attacks and brute-force at- tacks [6]. In brief, a double-spending attacker attempts to simultaneously spend the same set of blockchain tokens in two different transactions. This can be performed by ﬁrst persuading part of the network and the transaction receiver to conﬁrm one transaction, and then persuading the majority of the network to override that transaction with a conﬂicting transaction spending the same set of tokens. In other words, double-spending attacks are executed through intentional blockchain forking. Due to the factors such as randomness in solving the PoW puzzles [1] and information propagation delay, the malicious nodes, i.e., attackers, only need to hold a certain level of PoW computing power to succeed with a high probability in the double-spending attacks. Note here that although the double-spending attack is initially devised for Bitcoin, the attack is also applicable to other blockchain-based resource trading services and sys- tems, for example, energy trading [8], plug-in hybrid electric vehicle (PHEV) charging credit management [9], wireless spectrum trading [10], bandwidth exchange in community networks [11] and cache storage trading [12]. Although a few approaches, e.g., [13], have been intro- duced in blockchains to deter and prevent attacks, due to the inherent characteristics of openness, the PoW-based permis- sionless blockchain networks may not be completely secure. This critically hinders the broader adoption of permission- less blockchains, especially in business services that require high-level service security. Along with the studies on the improvement of blockchain protocols, blockchain service providers are also looking for an alternative means of cyber- risk management. Recently, cyber-insurance has been rec- ognized as a promising approach to efﬁciently manage the cyber risks by transferring them to insurers [14]. Similar to the traditional insurance, the customer of a cyber-insurance product, i.e., a policyholder, is insured once it settles the con- tract with the insurer by paying a premium. If attacks hap- pen and the damage is within the coverage of the insurance policy, the insurer will pay the claim to the customer accord- ingly. To date, a number of cyber-insurance products have been made available in the market [15]. According to the types of target systems, these products can be categorized arXiv:1804.10412v2 [cs.CR] 12 May 2019 2 Server Server Investment Claim Premium Blockchain provider Damage Attacker Legitimate chained blocks Illegitimate block Cyber insurer Users Payment Application Infrastructural computing resource Infrastructure provider Chain of blocks Third-party devices Server Server Server Server Figure 1: An overview of the blockchain service market. into speciﬁc groups designed for service providers such as ISPs and clouds, single mobile/work stations, networks of devices and dedicated cyber-physical/industrial systems. In this paper, we introduce a novel approach of jointly providing the risk management and security enhance- ment to the blockchain users and providers against attacks through the means of the cyber-insurance. As in other insur- able cyber-systems, the market design of cyber-insurance for blockchain networks also has to address a few impor- tant issues. Firstly, from the cyber-insurer’s perspective, the scope and policy of the cyber-insurance have to be clearly deﬁned in regard to what kind of attacks to be covered and how to quantify the risk, the possible damage and thus the insurance premium. Secondly, alongside the reactive risk transfer with the cyber-insurance, rational blockchain providers also have to consider the proactive strategy in security improvement and thus balance the investment in the infrastructure and in the cyber-insurance. To answer these questions, we consider a PoW-based blockchain service market under the threat of double- spending attacks (see Fig. 1). The market is composed of three entities, namely, the users, the blockchain provider, and the cyber-insurer. The users subscribe to a service, e.g., P2P energy trading for smart grids, which is imple- mented on top of the blockchain provided by the blockchain provider. We consider that the blockchain provider is com- posed of a group of individual honest machines which are responsible for maintaining the data consensus in the framework of PoW-based permissionless blockchains. The blockchain provider purchases the computing resource from cloud-based infrastructure providers1 or deploys more com- puting power internally for maintaining the network con- sensus. Meanwhile, in order to lower the cost on infrastruc- ture, third-party devices are encouraged to join the decen- tralized consensus process by dedicating their individual computing resources into the network. Working as a sin- gle blockchain provider, the group of consensus machines make proﬁt by charging the users with the transaction 1. For example, Amazon AWS provides the blockchain infrastruc- tures through its partner ecosystem [16]. processing fees and block mining fees [1]. To neutralize the economic/ﬁnancial loss incurred by double-spending attacks, the blockchain provider purchases the insurance from the cyber-insurer, which adopts an adjustable premium pricing strategy according to its perceived risk level of the blockchain. We propose a two-stage Stackelberg game model to an- alyze the dynamics of the considered market. On the upper stage of the game, the blockchain provider and the cyber- insurer lead to adopt their best-response strategies for proﬁt maximization. On the lower stage, the users adjust their service demands according to the cost and the security level of the blockchain. More speciﬁcally, the major contributions of this paper are summarized as follows: 1) We formulate the mechanisms of blockchain service pricing, blockchain infrastructure investment and cyber-insurance premium adjustment as a joint mar- ket equilibrium problem. We model the interactions among the three parties in the market as a two- level Stackelberg game. We provide and prove a few important theoretical discoveries regarding the properties of the equilibrium in the market game. 2) We incorporate the social externality [17], [18] among blockchain users in our end-user utility model. Also, by modeling the impact of comput- ing power on the blockchain security, we consider the blockchain provider’s strategy to incorporate both dimensions of infrastructure investment and insurance spendings. Furthermore, by adopting the concept of “risk-adjusted premium”, we mathemati- cally capture the impact of attack probability on pre- mium pricing from the cyber-insurer’s perspective. 3) We conduct extensive evaluation to assess the per- formance of the three parties with their equilib- rium strategies at different levels of the attacker- controlled computing power. The proposed market framework introduces a novel incentive-compatible business ecosystem, where the blockchain service users beneﬁt from enjoying more resilient services, and both the blockchain provider and the cyber- insurer are able to gain more proﬁts. In fact, the potential of cyber-insurance for blockchain, Bitcoin speciﬁcally, has been perceived in the market. For example, Petra Insurance Brokers (www.insurewithpetra.com) introduces the concept of insurance for Bitcoin transactions. Likewise, BitCoin Financial Group unveils “BitSecure”, which is a Bitcoin theft insurance policy (www.bitcoinﬁnancialgroup.com). This product covers both external hacking and employee theft. Moreover, more insurance products are emerging in which a few of them focus on general blockchain services. Therefore, our proposed concept and framework of cyber insurance for blockchain services has a clear and direct practical implication. Moreover, from the perspective of market design, the blockchain services are typically highly customized for a certain environment and application. Thus, we consider the mutual trading between single insurer and single provider. The model of a many-to-many market for multiple insurers and providers is likely to be intractable and needs further development, and hence it is beyond the scope of this paper. Finally, the model developed in 3 this paper can be readily extended to blockchains with the emerging consensus protocols based on the generalized proof of concepts [1], where investment in other resources, e.g., stakes, is needed to prevent attacks. The rest of the paper is organized as follows. Section 2 presents the related work. Section 3 describes the prelim- inaries about blockchains and cyber-insurance, the system model, and the formulation of Stackelberg game. Section 4 investigates the existence and uniqueness of the equilib- rium in the proposed Stackelberg game under practical assumptions. Section 5 presents the numerical performance evaluation. Section 6 concludes the paper. 2 RELATED WORKS The permissionless blockchain network was originally con- ceptualized in the famous grassroot cryptocurrency project “Bitcoin” as a decentralized database for tamper-proof recording and trusted timestamping for the transactional data between P2P users. Permissionless blockchains have been widely recognized for the superb consensus scalability, the tamper-evidence data organization and the capability of supporting the distributed, general-purpose virtual ma- chines [1], [19]. For this reason, in recent years there has seen a plethora of emerging application based on blockchains such as Internet ﬁnance and property digitization [20], self- organization for Internet of Things [21] and other non- ﬁnancial applications, e.g., notary documents and anti- counterfeit solutions [22]. Permissionless blockchain networks creatively solve the problems of replicated consensus in open-access networks by introducing the ﬁnancial incentive and cryptical zero- knowledge proof into the consensus process [1]. More speciﬁcally, any node in the blockchain network is allowed to issue digitally signed transactions to other nodes by “broadcasting” the transactions in a gossip manner over the P2P links between the nodes. The consensus nodes pack up an arbitrary subset of unapproved transactions into a cryptographically protected data structure, i.e., the “block”, and rival with each other in a block publishing race (also known as block mining) to acquire the block mining reward [23]. Following the Nakamoto protocol for blockchain state maintenance [1], the consensus nodes only accept the longest chain among all the locally observable candidates of the blockchain state as their canonical view of the blockchain. To determine the winner of a block mining race, the consensus nodes have to perform an exhaustive search for the solutions of the crypto-puzzles built upon their proposed blocks. In other words, the nodes that acquire more computing power will have higher probability of winning the race and hence the more power of controlling the blockchain state [1]. Therefore, the honest consensus nodes have to secure a sufﬁciently large amount of com- puting power to guarantee the well-being of the blockchain services, e.g., data integrity [23]. Grabbing more computing power, on the other hand, is also from which the malicious nodes start to breach the blockchain networks. Cyber-insurance, in the meanwhile, has been recognized as an innovative tool to manage the cyber risks and alleviate the damage of cyber-attacks for the insured customers [24]. Cyber-insurance provides the coverage on losses and lia- bilities from network/information security breaches. This greatly incentivizes the security investments by cyber- physical systems. However, compared with classical insur- ance, cyber-insurance introduces a number of unique issues. For example, due to the interdependence of security systems or lack of statistical data, it is difﬁcult to assess the systems’ vulnerability and hence hard to estimate the risk trans- ferred to the cyber-insurer [15]. For the transaction-oriented cyber services built upon permissionless blokchains, the designer of cyber-insurance also faces the similar issues. Nevertheless, recent studies on the mechanisms of double- spending attacks [25], [26], [27] have shed light upon the possible approaches in analytically assessing the risks of this fundamental threat on the blockchain systems. For example, in [25], the authors proposed a new protocol which requires the consensus nodes, i.e., block miners, to conﬁrm transac- tions only if the inputs of the transactions have not been spent, hence preventing users from double-spending their funds. Based on the characteristics of intentional forking in double-spending attacks, the authors in [26], [27] intro- duced the methods to estimate the probability of successful double-spending attacks by analyzing the investments in computing resource of both the blockchain maintainers and attackers. With these studies, it is now possible to estimate the probability of successful double spending and evaluate the potential risks transferred to the cyber-insurers. Furthermore, under the condition that the probability distribution of risk can be estimated, the authors in [28] proposed a risk-adjusted premium for pricing risks based on the Proportional Hazard (PH) transform, namely, a power transform in the decumulative distribution function of the risks. Since the PH transform satisﬁes the elementary principles of assigning premiums, i.e., scale-invariance and translation-invariance, it has been adopted in a number of works concerning the premium determination. In addition, a class of premium functions which are comonotonicity ad- ditive and stochastic dominance preservative were studied in [29]. Therein, the premium determination method based on the PH transform was generalized with an axiomatic approach, and the principles such as the absolute deviation principle [30] were thoroughly studied and compared. However, to the best of our knowledge, it still remains an open ﬁeld of research to employ the cyber-insurance for alleviating the damage of double-spending attack for the blockchain providers. The aforementioned works inspire a vision of quantifying the risk of double-spending attacks based on the computing resources owned by the blockchain maintainers and attackers. Then, the corresponding insur- ance premium can be determined under the framework based on the PH transform. By transferring the risks caused by double spending to the cyber-insurers, the cyber-physical services residing on the blockchains can be much more robust. This is also the major objective of our studies. 3 SYSTEM DESCRIPTION AND GAME FORMULA- TION In this section, we ﬁrst introduce the model of successful attack probability for double spending and the concept of risk-adjusted premium. After formulating the utilities of the 4 blockchain provider, the users, and the cyber-insurer, we investigate the problem of users’ service demand, service pricing and infrastructure, i.e., computing power, invest- ment by the blockchain provider and premium pricing by the cyber-insurer jointly as a hierarchical market game. The cyber-insurance for blockchain-based service un- der our consideration works as follows. The blockchain provider ﬁrsts pay the premium determined by the cyber- insurer. If the double-spending attack happens, which is detected by the provider or users, the provider ﬁles the claims to the cyber-insurer. The cyber-insurer veriﬁes the claim and makes the payment to the provider to compensate for the damage of the double spending. The methods to detect and verify the double spending attack are available and can be adopted, e.g., by deploying an observer as in [31], and hence they are not the focus of this paper. 3.1 Preliminaries 3.1.1 Successful Attack Probability We consider that the honest consensus nodes work jointly as a single blockchain provider and are responsible for maintaining a permissionless, PoW-based blockchain for service provision. Extending the analysis in [26] and [27], we assume that during a time period of T, the total computing resource of the blockchain network measured by the hash rate is ﬁxed as H. Following the Nakamoto consensus pro- tocol, every consensus node runs an independent Poisson process for puzzle-solving. The average time for a new block to be mined in the blockchain network is T0 [1]. Then, in the time period of T, the expected number of blocks being successfully mined in the network is T T0 . Let h denote the investment in computing resources by the blockchain provider, i.e., the honest nodes, and a denote the investment in computing resources by the attackers. Then, if the computing efﬁciency for hash queries are roughly the same, the blockchain provider and the attackers divide the total computing resource H as ¯hH and ¯aH, respectively, where ¯h = h a+h and ¯a = a a+h are the investment ratios. According to the probabilistic model for winning the PoW- based puzzle solving race [26], the number of blocks that are mined by the blockchain provider and waiting for conﬁrma- tion during T is T T0 ¯hH H = T T0 ¯h. On the other hand, instead of following the Poisson distribution based model, the number of blocks successfully mined by attackers during T can be accurately modeled as a negative binomial variable [26]. Therefore, with the investment ratio ¯h, the probability for attackers to succeed in double spending during T can be expressed as follows (see Theorem 1 in [27]): P  h  = I4(1−¯h)¯h  T T0 ¯h, 1 2  , ¯h ≥1 2 , (1) where Iw (u, v) is the regularized incomplete Beta function: Iw (u, v) = Γ (u + v) Γ (u) Γ (v) Z w 0 tu−1(1 −t)v−1dt (2) with Γ (·) being the gamma function. The model of expo- nential decay in (1) is discovered in [32] and proved in [27]. We consider that the blockchain provider receives pay- ments from the users in the form of transaction fees in a conﬁrmed block. Under double-spending attacks, the blockchain provider has to compensate the loss of the users with a ﬁxed rate for each transaction in the block that is ﬁnally overridden. Assume that the number of transactions included in each block is the same, and hence the transaction fee and compensation rate are ﬁxed for each transaction. Let NT denote the number of transactions in a block, r denote the block mining reward for each block and q de- note the total compensation rate for each block. Then, with the investment ratio ¯h, the blockchain provider’s potential loss is T T0 ¯hNTq under the double-spending attack, and the probability of successful attack is: P  ¯h  =        I4(1−¯h)¯h  T T0 ¯h, 1 2  , ¯h ≥1 2 , 1, ¯h < 1 2 . (3) Here, we only focus on the case where the investment ratio of the blockchain provider is no less than 1/2. The reason is that when ¯h < 1/2, the probability of successful double spending is always equal to 1 as shown in (3), which is trivial and thus not our focus. 3.1.2 Premium Determination The cyber-insurer offers a cyber-insurance service to the blockchain provider and covers its total loss when the attack happens. In other words, after the blockchain provider buys the cyber-insurance, the risk of double-spending at- tack will be transferred to the cyber-insurer. By adopting the concept of risk-adjusted premium in [29], the cyber- insurer dynamically determines the price, i.e., premium, of its cyber-insurance product according to the insurance risk distribution. According to our previous discussion, the cyber-insurer has an insurance risk, i.e., paying the claim of T T0 ¯hNTq with the probability of P  ¯h  given by (3). Then, the expected loss for the cyber-insurer can be formulated as follows: Eloss = Z 1 1/2 T T0 ¯hNTqP  ¯h  d¯h = T T0 NTq Z 1 1/2 ¯hP  ¯h  d¯h = T T0 NTq " ¯hF  ¯h  ¯h=1 ¯h=1/2 − Z 1 1/2 F  ¯h  d¯h # ≤T T0 NTq " 3 4 − Z 1 1/2 F  ¯h  d¯h # = T T0 NTq "Z 1 1/2 3 2 d¯h − Z 1 1/2 F  ¯h  d¯h # = T T0 NTq Z 1 1/2 3 2 −F  ¯h  d¯h = T T0 NTq Z 1 1/2 " 1 − Z ¯h 1/2 P (θ) dθ # d¯h, (4) where F  ¯h  is the cumulative distribution function for P  ¯h 2. Based on the formulated distribution of the insur- ance risk and the concept of risk-adjusted premium, the cyber-insurer can determine the premium as follows: Λ (γ) = T T0 NTq Z 1 1/2 ω 1 − Z ¯h 1/2 P (θ) dθ, γ ! d¯h, (5) where ω (x, γ) is an increasing concave function of x and belongs to the families of elementary transforms given in Section 5 of [29]. Without loss of generality, we adopt the 2. Note here that we assume that the cyber-insurer is considering the worst case. 5 PH transform in our study, i.e., ω (x, γ) = x 1 γ , γ ≥1 in Subsection 5.1 of [29]. Then, the corresponding premium can be expressed as follows: Λ (γ) = T T0 NTq Z 1 1/2 " 1 − Z ¯h 1/2 P (θ) dθ #1/γ d¯h, (6) where γ is the premium coefﬁcient which decides on the insurance policy. Namely, the cyber-insurer adjusts the pre- mium by controlling γ according to the insurance risk. It is worth noting that the term h 1 − R ¯h 1/2 P (θ) dθ i in (6) is smaller than 1. Therefore, the larger γ is, the higher the premium Λ (γ) will be. 3.2 System Model 3.2.1 The User’s Utility We suppose that each user in the blockchain service market has a service demand, which is determined by an intrinsic value θi from the uniform distribution FU over the interval [0, 1]. Here, θi can be interpreted as the probability for user i to buy the blockchain service. We further assume that the intrinsic values of the users are independently distributed. The users also experience social externalities in which the decision of one user can inﬂuence the decisions of the other users. Let Pr [j buys the service] denote the probability that user j subscribes to the service, then, the utility of user i can be expressed as follows [33]: ui = ¯h + θi −pi + α X j∈N gijPr [j buys the service]. (7) In (7), the ﬁrst term, i.e., ¯h, is the investment ratio of the blockchain provider. ¯h represents the positive effect owning to the effort of the blockchain provider in preventing the security breach due to double-spending attacks. According to (1), the larger ¯h is, the lower the successful probability of double-spending attacks is, and consequently the less the users will be affected. The third term, i.e., pi, is the price of the service for user i3. The forth term of (7), i.e., α P j∈N gijPr [j buys the service], represents the positive social externality among the users. gij is the element of the exter- nality matrix G [17], [18] and represents the level of the social externality (inﬂuence) that user j has on user i. We assume that gij ̸= 0, ∀i ̸= j and gii = 0, ∀i ∈N 4. Finally, α is a constant controlling the level of social externality for the entire network. 3.2.2 Proﬁts of the Blockchain Provider and the Cyber- insurer The goals of the blockchain provider and the cyber-insurer are to maximize their individual proﬁts. Based on our 3. Note here that the uniform pricing in which all users are charged with the same price is a special case of the discriminative pricing adopted in this paper. 4. Note here that our model can also be used to analyze the scenario that the users may act independently. For example, if gij = gji = 0, user j has zero level of the social externality (inﬂuence) on user i and vice versa. Hence, users i and j act independently. previous discussion, the payoff functions of the blockchain provider can be expressed as follows: Πp  ¯h, p  = X i∈N pixi − a¯h 1 −¯h + ¯h T T0 NTr −T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ dt | {z } premium , (8) where the ﬁrst term P i∈N pixi is the revenue obtained from the users’ payment for the blockchain service and xi is the probability that user i buys the service deﬁned in (13). The second term, i.e., h = a¯h 1−¯h, is the blockchain provider’s investment in the infrastructure, and we have h= a¯h 1−¯h ⇔¯h= h a+h. The third term, i.e., ¯h T T0 NTr, is the block mining reward received by the blockchain provider for maintaining the ser- vice. The last term, i.e., T T0 NTq R 1 1/2 h 1 − R t 1/2 P (θ) dθ i1/γ dt, is the premium paid by the blockchain provider to the cyber- insurer, and q is the compensation price for one transaction. On the other hand, the premium paid by the blockchain provider is the revenue of the cyber-insurer. Due to the un- certainty of double-spending attacks, we adopt the expected claim as the cyber-insurer’s cost. Then, the cyber-insurer’s payoff function can be expressed as: ΠI (γ) = T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ dt | {z } premium −P  ¯h  ¯h T T0 NTq −σ(¯h, γ), (9) where the ﬁrst term is the premium paid by the blockchain provider. The second term, i.e., P  ¯h  ¯h T T0 NTq, is obtained as the product of the successful attack probability and the total claim paid to the blockchain provider for covering its loss. Finally, since the premium increases as the cyber-insurer’s decision variable γ increases, a rational cyber-insurer will keep γ as high as possible to maximum its revenue. How- ever, when the blockchain provider increases its investment ratio, the successful attack probability will decrease. As a result, the blockchain provider will have less incentive to pay an extremely high premium. Therefore, we introduce the last term in (9) to model the possibly negative impact on the expected payoff of the cyber-insurer as both the values of ¯h and γ increase, which is similar to the concept of the punishment on insurer adopted in [34]. Here, we deﬁne σ  ¯h, γ  = σ1  ¯h  σ2 (γ), where σ1  ¯h  is an increasing convex function of ¯h with the following properties: σ1  ¯h               > 0, ¯h > 1 2 , = 0, ¯h = 1 2 , < 0, ¯h < 1 2 . (10) The conditions in (10) indicates that with ¯h > 1 2, the blockchain provider’s effort in investing the computing resource effectively reduces the successful attack probability. Consequently, the probability of the cyber-insurer paying the claim to the blockchain provider is also reduced. Then, keeping the highest premium has a negative effect on the cyber-insurer’s payoff, e.g., by hurting its reputation or curbing the incentive for the blockchain provider to buy the 6 insurance. Under the other two conditions in (10), the lack of enough investment in infrastructure of the blockchain provider will induce higher probability of being successfully attacked, hence leading to a positive effect on the cyber- insurer’s payoff due to the higher demand of ﬁnancial pro- tection. Additionally, σ2 (γ) is an increasing convex function of γ and σ2 (γ)|γ=1 = 0. As such, when γ = 1, the expected loss in (4) is equal to the premium in (6), and there is no negative effect on the cyber-insurer’s reputation. For tractable analysis, we adopt the following model: σ  ¯h, γ  = σ1  ¯h  σ2 (γ) =  ¯h −1 2 3 | {z } σ1(¯h) (γ −1) γβ | {z } σ2(γ) , β > 1. (11) It is worth noting that the cyber-insurer’s payoff function in (9) may also adopt other models for σ  ¯h, γ  . The selected model in (11) has no effect on our subsequent analysis. 3.3 Stackelberg Game Formulation Considering the payoff functions of the market entities given in (7)-(9), it is natural to model the interactions in the blockchain service market as a two-stage game. In the ﬁrst upper stage, the blockchain provider determines the price of the blockchain service, namely, the levels of acceptable transaction fees for each user pi, and its ratio of investment in computing resources ¯h. Meanwhile, the cyber-insurer decides on the premium coefﬁcient γ by considering the insurance risk transferred from the blockchain provider. In the second lower stage, each user determines whether it will buy the blockchain service or not based on the prices and the investment ratio set by the blockchain provider. Accord- ingly, the interactions among the blockchain provider, the cyber-insurer and the users are formulated as a two-leader- multi-follower Stackelberg game. Speciﬁcally, the mutual interaction between the blockchain provider and cyber- insurer forms a noncooperative two-player leader-level sub- game for achieving the equilibrium of the service price, the investment ratio, and the cyber-insurance policy. Then, the interaction among a number of users forms the follower- level noncooperative subgame for determining the service demand from the blockchain provider5. The Stackelberg game can be formally deﬁned as follows. 1) User-level noncooperative subgame: Given the ﬁxed investment ratio ¯h as well as the price vectors p =  p1, p2, . . . , p|N | ⊤, the user-level (follower) non- cooperative subgame is deﬁned by a four-tuple Gu = {N, x, X, u}, where • N is the set of active users; • X = n x1, x2, . . . x|N | ⊤ xi ∈[0, 1] , i ∈N o ⊂R|N | deﬁnes the domain of x as an M-polyhedron; 5. The reason that the users are in the same level, i.e., lower-level, is that they have the same set of information and make decisions simultaneously. This is different from the blockchain provider that usually invests in the infrastructure and buys the cyber-insurance ﬁrst to improve the security level of its blockchain-based service and then provides the service to the users. The cyber-insurer sells the cyber- insurance to the blockchain provider and forms a noncooperative re- lationship with the blockchain provider. As such, the cyber-insurer and blockchain provider make their decisions simultaneously and hence before the users. As a result, the blockchain provider and cyber-insurer are considered to be the leaders and their problems are deﬁned in the upper-level. • x =  x1, x2, . . . x|N | ⊤is the vector of the users’ decision variables, where xi is the service demand of user i and x ∈X; • u =  u1, u2, . . . , u|N | ⊤is the vector of the users’ utilities with the given strategy x, where ∀i ∈ N, and ui is given in (7). 2) Leader-level noncooperative subgame: Assume that the users’ demand x has been found to be a parametric equilibrium as a function, i.e., mapping, of the lead- ers’ strategies. Then, the blockchain provider and the cyber-insurer form a noncooperative game as a ﬁve-tuple GL = n p⊤, ¯h ⊤, DP, γ, DI, Π o , where •  p⊤, ¯h ⊤=  p1, p2, . . . , p|N |, ¯h ⊤is the strategy vector of the service prices and the investment ratio set by the blockchain provider with pi > 0, ∀i ∈N and ¯h ∈  1 2, 1  ; • DP = n p⊤, ¯h ⊤ pu ≥pi > 0, ∀i ∈N, ¯h ∈  1 2 , 1  is the domain of the prices and investment ratio of the blockchain provider, where pu is the upper bound of the price pi imposed by the government or market regulators; • γ is the cyber-insurer’s premium coefﬁcient for premium determination; • DI = { γ| γu ≥γ > 1} deﬁnes the domain of γ, where γu is the upper bound of γ imposed by the government or regulators; • Π = [Πp, ΠI]⊤is the proﬁt vector for the blockchain provider and the cyber-insurer. 4 GAME EQUILIBRIUM ANALYSIS Based on the formulation of the Stackelberg game in Sec- tion 3.3, we are ready to analyze the market equilibrium using backward induction. We ﬁrst obtain the Nash Equi- librium (NE) of the user-level noncooperative subgame Gu by characterizing a system of interdependent demands. We provide the sufﬁcient conditions for the existence and uniqueness of the NE in the user-level noncooperative subgame Gu by solving the bounded linear complementar- ity problem of the subgame [33]. Then, we substitute the parametric NE of Gu into the leader-level noncooperative subgame GL. Under a reasonable assumption, we show that the Jacobian matrix constructed from the payoff functions of each player in the leader-level noncooperative subgame is negative deﬁnite. Hence, we prove that the Stackelberg Equilibrium (SE) of the market game exists and is unique. 4.1 Equilibrium Analysis for User-Level Noncoopera- tive Subgame Intuitively, user i only buys the service when it has a positive payoff, namely ui > 0. This indicates that there exists a threshold ˜θi for the intrinsic value θi in (7), such 7 that user i will buy the service only when θi > ˜θi. ˜θi can be obtained by setting ui = 0: 0 = ¯h + ˜θi −pi + α X j∈N gijPr [j buys the service] = ¯h + ˜θi −pi + α X j∈N gijPr h θj > ˜θj i = ¯h + ˜θi −pi + α X j∈N gij h 1 −FU  ˜θj i ⇔˜θi = pi −¯h −α X j∈N gij h 1 −FU  ˜θj i , (12) where 1 −FU  ˜θj  denotes the probability that user j draws a valuation above the threshold ˜θj. For ease of exposition, let xi = 1 −FU  ˜θi  denote the probability that user i buys the service, and xi can be further expressed as follows: xi = 1 −FU  ˜θi  = 1 −FU  pi −¯h −α X j∈N gij h 1 −FU  ˜θj i   = 1 −pi + ¯h + α X j∈N gijxj. (13) From (13), we can characterize a system of the users’ interdependent demands as follows: xi =            0, if 1 −pi + ¯h + α P j∈N gijxj < 0, 1, if 1 −pi + ¯h + α P j∈N gijxj > 1, 1 −pi + ¯h + α P j∈N gijxj, otherwise. (14) After subtracting each condition in (14) by the value of its corresponding xi, we convert (14) into the following form: xi =                    0, if 1 −pi + ¯h + α X j∈N gijxj −xi < 0 −xi |{z} =0 = 0, 1, if 1 −pi + ¯h + α X j∈N gijxj −xi > 1 −xi |{z} =1 = 0, 1 −pi + ¯h + α X j∈N gijxj, if 1 −pi + ¯h + α X j∈N gijxj −xi = 0. (15) Furthermore, (15) can be rewritten into the following matrix form: xi =      0, if  1 + ¯h  1 −p −(I −αG) x i < 0, 1, if  1 + ¯h  1 −p −(I −αG) x i > 0,  1 + ¯h  1 −p + αGx i, if  1 + ¯h  1 −p −(I −αG) x i = 0, (16) where I is the identity matrix, 1 = [1, 1, . . . , 1]⊤∈R|N |×1 and {·}i represents the i-th entry of a vector. With (16), we are ready to investigate the properties of the NE in the user- level noncooperative subgame. Assumption 1. αρ (G) < 1, where ρ (·) is the spectral norm of a matrix. The physical meaning of Assumption 1 is illustrated in Fig. 2, where the black area is the feasible area of αρ (G). If αρ (G) exceeds the feasible area, the social externality will be too strong such that every user will buy the service, which is impossible in reality. THEOREM 1. The user-level noncooperative subgame Gu admits a unique NE under Assumption 1. ρ(G) 0 1 2 3 4 α 0 1 2 3 4 Figure 2: An illustration of Assumption 1. Proof. (16) is deﬁned as a bounded linear complementarity problem in [33]. It is a linear instance of the general mixed complementarity problems discussed in [35]. As discussed in [35], the linear instance of a complementarity problem admits a unique solution, i.e., the NE, to the user-level noncooperative subgame Gu, if (I −αG) is a P-matrix6. Since αρ (G) < 1 under Assumption 1, all the eigenvalues of the matrix αG belong to (0, 1) and hence all the eigenval- ues of the matrix (I −αG) belong to (0, 1). Therefore, (I −αG) is a non-singular M-matrix7. Based on Theorem 6.2.3 in [36], “any non-singular M- matrix is a P-matrix”, (I −αG) is a P-matrix and then there exists a unique NE in the user-level noncooperative sub- game Gu. Thereby, the proof is completed. According to the system of interdependent demands (16), the set of users N can be partitioned into three subsets, i.e., S0, S1, and S as follows: • S0 =  i  1 + ¯h  1 −p −(I −αG) x i < 0, ∀i ∈N is the set of users which will not buy the blockchain ser- vice, • S1 =  i  1 + ¯h  1 −p −(I −αG) x i > 0, ∀i ∈N is the set of users which surely will buy the blockchain service, • S = N\ (S0 ∪S1) = {i|{(1 + ¯h)1 −p −(I −αG)x}i = 0, ∀i ∈N} is the set of users which buy the blockchain service with a probability over [0, 1]. Then, we obtain the following theorem: THEOREM 2. The users in the user-level noncooperative subgame Gu only belong to S, i.e., S = N, S0 = ∅, and S1 = ∅. Given the service price vector p, the optimal solution to the system of interdependent demands (16) is x∗= (I −αG)−1  1 + ¯h  1 −p  . (17) Proof. We denote the optimal price by p∗and the optimal demand by x∗. Then, we show that S0 = ∅and S1 = ∅. 1) S0 = ∅: We ﬁrst assume that S0 ̸= ∅. This means that ∃i ∈N, such that xi∗= 0 and {(1 + ¯h)1 −p∗− (I−αG)x∗}i < 0. Because  1 + ¯h  1 −p −(I −αG) x i = 1 + ¯h + α P j∈N gijxj −xi −pi is continuous on pi and 1 + ¯h + α P j∈N gijxj∗> 0, there exists a pi′ where pi′ < pi∗such that 1 + ¯h + α P j∈N gijxj∗−pi′ > 0 and 6. A matrix A is a P-matrix if all its principal minors are positive. 7. A matrix A is a non-singular M-matrix if A = I −B for a positive matrix B with largest eigenvalue ρ (B) < 1. 8 correspondingly xi′ > 0. This indicates that when the service price charged to user i decreases from pi∗ to pi′, user i has an incentive to increase its demand from xi∗= 0 to xi′ > 0. Consequently, the revenue of the blockchain provider will increase since pi∗xi∗= 0 while pi′xi′ > 0. Therefore, xi∗and pi∗cannot be the optimal demand and price for user i, respectively. Hence, i /∈S0, ∀i ∈N and S0 = ∅. 2) S1 = ∅: Similarly, we assume that S1 ̸= ∅. This means that ∃l ∈ N, xl∗ = 1 and  1 + ¯h  1 −p∗−(I −αG) x∗ l > 0. Since  1 + ¯h  1 −p −(I −αG) x l = 1+¯h+α P j∈N gijxj−xl−pl is continuous on pl, there exists an ϵ where ϵ > 0 such that 1 + ¯h + α P j∈N gijxj∗−(pl∗+ ϵ) > 0 and xl∗ = 1. Let ϵ = ¯h + α P j∈N gijxj∗−pl∗, we have 1 + ¯h + α P j∈N gijxj∗−(pl∗+ ϵ) = 0, and here xl∗= 1 −(pl∗+ ϵ) + ¯h + P j∈N gljxj∗= 1. This means that even if the service price of user l increases from pl∗ to (pl∗+ ϵ), the demand of user l is still equal to 1 while the proﬁt of the blockchain provider has been increased from pl∗xl∗= pl∗to (pl∗+ ϵ) xl∗= pl∗+ ϵ. Moreover, since  1 + ¯h  1 −p∗−(I −αG) x∗ l −ϵ =1 + ¯h −(pl∗+ ϵ) −xl∗ |{z} 1 +α X j∈N gljxj∗= 0, (18) user l belongs to S instead of S1. Therefore, pl∗and xl∗are not the optimal price and demand for user l, respectively. Hence, l /∈S1, ∀l ∈N and S1 = ∅. To conclude, given any price vector p of the blockchain service, the condition  1 + ¯h  1 −p −(I −αG) x∗ i = 0 (19) will be satisﬁed for all user i ∈N . Therefore,  1 + ¯h  1 −p −(I −αG) x∗= 0, (20) (I −αG) x∗=  1 + ¯h  1 −p. (21) Since we have already shown that the matrix (I −αG) is a non-singular matrix in Theorem 1, the inverse of (I −αG) exists. Multiply both sides of (21) by (I −αG)−1, then, the optimal solution to the system of interdependent demands, or equivalently, the NE to the user-level noncooperative subgame Gu, is x∗= (I −αG)−1  1 + ¯h  1 −p  . (22) The proof is completed. 4.2 Equilibrium Analysis for Leader-Level Noncooper- ative Subgame After deriving the equilibrium demand of the users, we investigate the leader-level noncooperative subgame GL for the blockchain provider and the cyber-insurer. At the NE, no player can increase its proﬁt by choosing a different strategy provided that the other player’ strategy is unchanged [37]. In what follows, we ﬁrst prove that an NE exists in the leader-level noncooperative subgame GL. Then, we prove that this NE is unique. Algorithm 1 Iterative best-response for searching leader noncooperative subgame NE Initialization: Select any feasible initial strategies as sI(0) = γ(0), sP(0) = [p(0), h(0)]⊤and set t = 0. 1: while p(0), h(0), γ(0) do not satisfy the termination condition do 2: for all k = {P, I} do 3: Set the adversary joint strategies as sk(t + 1) = arg max sk Πk(sk, s−k(t)) s.t. sk ∈Dk, (26) where s−k represents the adversary’s strategy. 4: end for 5: Set t ←t + 1. 6: end while Substituting the optimal demand of the users derived in (22) into the proﬁt function of the blockchain provider, we can rewrite (8) into a matrix form as follows: Πp  ¯h, p  =p⊤(I −αG)−1  1 + ¯h  1 −p  − a¯h 1 −¯h + ¯h T T0 NTr −T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ dt. (23) The ﬁrst-order partial derivative of the proﬁt of blockchain provider as well as that of the cyber-insurer are shown in (24), and the second-order partial derivatives of the blockchain provider and cyber-insurer are shown in (25). Then, we can obtain the following theorem regarding the NE of the leader-level noncooperative subgame. THEOREM 3. There exists at least one NE in the leader-level noncooperative subgame GL if and only if a > 1 8 1⊤(I −αG)−11. Then, the Stackbelberg equilibrium of the market game exists. Proof. Please refer to Appendix A for the proof. Next, we show the uniqueness of the NE in the leader- level noncooperative subgame in Theorem 4, and hence the Stackbelberg equilibrium is unique. THEOREM 4. The NE in the leader-level noncooperative subgame GL is unique if and only if a > 9(β+1)2(γu)β+1 128β and hence the Stackbelberg equilibrium is unique. Proof. Please refer to Appendix B for the proof. 4.3 Equilibrium Searching for Leader-Level Noncoop- erative Subgame Since in our previous discussion we have provided the closed-form NE to the user-level noncooperative subgame Gu in (22), we only have to focus on the derivation of the NE in the leader-level noncooperative subgame GL. Given (22), the search for the SE is reduced to the search of the NE of a two-player noncooperative game. By Theorem 3, we know that GL is a concave game with the convex and compact strategy space (see also the proof to Theorem 3). By Theorem 4, we know that GL admits a unique NE when the condition given therein is satisﬁed. This suggests the use of the iterative best response to solve for the NE in GL. The iterative best-response algorithm is described in Algorithm 1, and its convergence property is guaranteed by Theorem 5. 9                    ∂Πp ∂¯h =p⊤(I −αG)−11 − a  1 −¯h 2 + 1 γ T T0 NTr, ∂ΠP ∂p =(I −αG)−1  1 + ¯h  1 −p  , ∂ΠI ∂γ = −1 γ2 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt −  h −1 2 3 h (β + 1) γβ −βγβ−1i , (24)                                                ∂2ΠP ∂p2 = −(I −αG)−1, ∂2ΠP ∂p∂¯h = (I −αG)−11, ∂2ΠP ∂p∂γ =  ∂2ΠI ∂γ∂p ⊤ = 0, ∂2ΠP ∂¯h∂p = 1⊤(I −αG)−1, ∂2ΠP ∂¯h2 = − 2a  1 −¯h 3 , ∂2ΠP ∂¯h∂γ = 0,                                  ∂2ΠI ∂γ∂¯h = −3  h −1 2 2 h (β + 1) γβ −βγβ−1i , ∂2ΠI ∂γ2 = 2 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt + 1 γ4 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln2 " 1 − Z t 1/2 P (θ) dθ # dt −  h −1 2 3 h β (β + 1) γβ−1 −β (β −1) γβ−2i . (25) THEOREM 5. If the condition in Theorem 4 is satisﬁed, Algo- rithm 1 converges to the unique SE from anywhere of the strategy domains of the blockchain provider and cyber-insurer. Proof. With the concavity of the payoff functions ΠP and ΠI proved in Appendix A and the negative deﬁnite Jacobian matrix J proved in Appendix B, Theorem 5 immediately follows Theorem 10 in [38]. 5 PERFORMANCE EVALUATION In this section, we conduct extensive numerical simulations to evaluate the performance of the market entities at the equilibrium in each stage. We consider a group of |N| users in the blockchain service market. The off-diagonal elements of social externality matrix G, i.e., gij, ∀i ̸= j, is generated following the uniform distribution over the interval of [0, 10]. The domain of deﬁnition for α is set as 5 × 10−4, 8 × 10−4 according to the parameter setting in [33]. The other default coefﬁcients are given as follows: β = 10, pu = 1, γu = 2, T = 100, T0 = 10, NT = 100, r = 10, q = 10 and a = 100. Note that the price that we present in the ﬁgures of simulation results is the mean value of the discriminatory prices. The triple integral in the premium-related term in the proﬁt functions of the blockchain provider and the cyber-insurer, i.e., (8) and (9), is calculated using the method of rectangular integral with 100 as the number of intervals. Note that our proposed concept of cyber-insurer and blockchain service is the ﬁrst in the literature. There is no similar work with which we can compare on a reasonably fair basis. For example, the authors in [39] formulated a bilevel game to investigate the interactions among the attackers, users, and cyber-insurer in computer networks. However, since we incorporate the speciﬁc and unique feature of the blockchain technology, i.e., successful attack probability in (1), reasonable comparison is therefore not applicable. Premium coefficient γ 1.665 1.67 1.675 Profit of insurer 1645 1645.1 1645.2 1645.3 1645.4 1645.5 1645.6 1645.7 (a) Social externaltiy α=6.5×10-4 Social externaltiy α=7×10-4 Social externaltiy α=7.5×10-4 Best response Best response Best response Investment of provider h 710 700 690 (b) 680 0.9 Average price of service 0.92 0.94 3059.4 3059.2 3059.6 3059 3059.8 3060 0.96 Profit of provider Social externaltiy α=6.5×10-4 Best response Investment of provider h 710 700 690 (c) 680 0.9 Average price of service 0.92 0.94 3099.8 3100 3100.2 3100.4 3100.6 0.96 Profit of provider Social externaltiy α=7×10-4 Best response Investment of provider h 710 700 690 (d) 680 0.9 Average price of service 0.92 0.94 3156.2 3156 3156.4 3155.8 3156.6 3156.8 0.96 Profit of provider Social externaltiy α=7.5×10-4 Best response Figure 3: Best response 5.1 Numerical Results 5.1.1 Demonstration of best response and NE Figure 3 demonstrates the NE obtained from interative best responses with the given simulation parameters. In Fig. 3(a), the proﬁt of the cyber-insurer changes with the different premium charged to the blockchain provider. According to our previous discussion, the proﬁt of the cyber-insurer is controlled by the value of γ. For a given weak level of the social externality, e.g., α = 6.5 × 10−4, there is a corresponding strategy where the cyber-insurer’s proﬁt is maximized. The strategy is marked by the arrowhead of “Best response” and constitutes the NE strategy of the cyber-insurer under the given social externality setting. We observe from Fig. 3(a) that as a function of the premium coefﬁcient γ, the proﬁt is unimodal, and thus the optimal solution can be obtained analytically. Similarly, there exists 10 Premium coefficient γ 1.6726 1.6726 1.6726 Investment of provider h 673.91 673.92 673.93 673.94 673.95 673.96 Investment of provider h with social externaltiy α=6.5×10-4 Investment of provider h with social externaltiy α=7×10-4 Investment of provider h with social externaltiy α=7.5×10-4 Premium coefficient γ with social externaltiy α=6.5×10-4 Premium coefficient γ with social externaltiy α=7×10-4 Premium coefficient γ with social externaltiy α=7.5×10-4 NE with social externality α=7×10-4 NE with social externality α=6.5×10-4 NE with social externality α=7.5×10-4 Figure 4: Nash equilibrium Number of users 60 80 100 120 Profit of provider 2800 3000 3200 3400 3600 3800 (a) Number of users 60 80 100 120 Profit of Insurer 1640 1645 1650 (b) Number of users 60 80 100 120 Average price of service 0.936 0.938 0.94 (c) Number of users 60 80 100 120 Total demand of users 0 500 1000 (d) Number of users 60 80 100 120 Investment of provider h 680 700 720 740 (e) Number of users 60 80 100 120 Premium coefficient γ 1.66 1.665 1.67 1.675 (f) Social externaltiy α=6.5×10-4 Social externaltiy α=7×10-4 Social externaltiy α=7.5×10-4 Figure 5: The results with increasing number of users. the optimal point in each of Figs. 3(b), (c), and (d) for the blockchain provider. The optimal points are marked by the arrowhead of “Best response” and constitute the NE strategy of the blockchain provider under different levels of social externality. Note that all the results shown in the ﬁgures are obtained given that the users play the NE in the user-level game. Figure 4 illustrates the equilibrium strategies for the investment of the blockchain provider and the premium coefﬁcient γ for the cyber-insurer under different levels of social externality. The NE is the point at which the best responses for the blockchain provider and cyber-insurer in- tersect. Again, this is given that the users play the NE in the user-level game. Under different levels of social externality, different NE are observed. As the level of social externality grows higher, i.e., a decision of one user has stronger effect to the decisions of other users, the other users are more likely to buy the same service if one user buys the service. As expected, when the level of social externality grows higher, the users are more likely to also buy the service, the blockchain provider has more money and more incentives to invest in the infrastructure and accordingly the premium coefﬁcient γ decreases (see Fig. 4). The reason for this result is explained in the subsequent discussions. 5.1.2 The impact of the number of users We ﬁrst evaluate the impacts by the number of users on the payoff of the market entities in Fig. 5, where the number of users increases from 50 to 120. Then, we evaluate the Social externality α×10-4 5 6 7 8 Profit of provider 2500 3000 3500 (a) Social externality α×10-4 5 6 7 8 Profit of Insurer 1620 1630 1640 1650 1660 (b) Social externality α×10-4 5 6 7 8 Average price of service 0.92 0.93 0.94 0.95 0.96 (c) Social externality α×10-4 5 6 7 8 Total demand of users 200 300 400 (d) Social externality α×10-4 5 6 7 8 Investment of provider h 500 600 700 800 (e) Social externality α×10-4 5 6 7 8 Premium coefficient γ 1.64 1.66 1.68 1.7 (f) Low attacker's investment a=50 Medium attacker's investment a=100 High attacker's investment a=150 Figure 6: The results with increasing social externality. performance under three levels of social externality, e.g., 6.5 × 10−4, 7 × 10−4, and 7.5 × 10−4 which represent weak, medium, and strong levels of social externality, re- spectively. As expected, the proﬁt of the blockchain provider increases signiﬁcantly when the social externality becomes stronger. As the number of users increases, the proﬁt of the blockchain provider also increases under the given social externality settings. Moreover, the increase of the proﬁt of the blockchain provider becomes larger when the social ex- ternality is stronger. Intuitively, the reason is that the social externality stimulates the demand of each user. In return, the blockchain provider can raise the price of service ac- cordingly and hence improves its proﬁt. Meanwhile, as the social externality becomes stronger, the blockchain provider also achieves greater proﬁt. This indicates that the attack may incur more loss to the blockchain provider. Therefore, the blockchain provider has a higher incentive to invest in the infrastructure to prevent double-spending attack. This explains the result that the investment by the blockchain provider increases at a higher rate with α = 7.5×10−4 than with α = 6.5 × 10−4. As a result, the stronger social exter- nality reduces the successful attack probability at a higher rate. Correspondingly, as shown in Fig. 5(f), the premium coefﬁcient γ decreases at a higher rate with the stronger social externality. This result indicates that the premium also decreases at a higher rate with stronger social externality. Thus, the cyber-insurer’s proﬁt decreases at a higher rate when the social externality becomes stronger as shown in Fig. 5(b). 5.1.3 The impact of social externality Figure 6 illustrates the impact of social externality on the payoffs of the three market entities with 100 users. As expected, the users’ total service demand increases as the social externality becomes stronger (see Fig. 6(d)). From Figs. 6(a) and (b), we observe that the proﬁt of the blockchain provider increases while the proﬁt of the cyber- insurer decreases. The reason is that the users with stronger social externality are more sensitive to the security level of the blockchain service, and the security level depends on the investment ratio of the blockchain provider. Therefore, the blockchain provider will raise its investment as the social externality increases, which decreases the probability of successful double-spending attacks. Accordingly, the cyber- insurer reduces its premium as shown in Fig. 6(f), and 11 Attacker's investment a 50 60 70 80 90 100 Profit of provider 0 5000 10000 15000 (a) Attacker's investment a 50 60 70 80 90 100 Profit of Insurer 0 2000 4000 6000 (b) Attacker's investment a 50 60 70 80 90 100 Average price of service 0.92 0.94 0.96 0.98 (c) Attacker's investment a 50 60 70 80 90 100 Total demand of users 300 305 310 315 320 (d) Attacker's investment a 50 60 70 80 90 100 Investment of provider h 500 1000 1500 (e) Attacker's investment a 50 60 70 80 90 100 Premium coefficient γ 1.6 1.65 1.7 1.75 (f) Small number of transactions in one block NT=100 Medium number of transactions in one block NT=200 Large number of transactions in one block NT=300 Figure 7: The result with increasing attacker’s computing resource. this will lead to the decrease of the cyber-insurer’s proﬁt. Moreover, since the investment by the blockchain provider increases, the security level of the blockchain service is im- proved, and thus the service demand of users increases. This situation results in the increase of the blockchain provider’s proﬁt. Additionally, recall that the investment ratio of the blockchain provider depends on not only the investment from the blockchain provider, but also the computing re- source owned by the attackers. For this reason, in our performance evaluation, we also vary the attacker’s invest- ment in computing resource by considering three cases with a = 50, a = 100 and a = 150, respectively. From Fig. 6(f), we observe that the decreasing rate of the curves becomes higher as the attacker’s investment increases, which means that decreasing rate of the premium becomes higher as the attacker’s investment increases. The reason is that the increasing rate of the investment by the blockchain provider becomes faster as the attacker’s investment increases, and this also results in a higher decreasing rate of the successful attack probability. Consequently, the decreasing rate of the probability of paying claim is the highest with a = 150 which is the largest attacker’s investment. 5.1.4 The impact of attacker’s computing resource Finally, we evaluate in Fig. 7 the impact of the attackers’ computing resource on the performance of the users, the blockchain provider and the cyber-insurer. We consider three different situations with different sizes of a block, i.e., the number of transactions included in that block, with NT = 100, NT = 200 and NT = 300. We observe from Figs. 7(a) and (b) that as the attacker’s computing resource increases, the proﬁt of the blockchain provider decreases and the proﬁt of the cyber-insurer remains unchanged. The reason is that the blockchain provider needs to increase its infrastructure investment when the attacker’s computing resource increases (see Fig. 7(e)). Otherwise, the successful attack probability will signiﬁcantly increase, and it results in the increase in the cost of the blockchain provider. With an increasing computing resource controlled by the attackers, the investment ratio of the blockchain provider cannot remain as high as before. This result is illustrated in Fig. 7(e) with h∗ a+h∗ a=50 ≈ 18 19 > h∗ a+h∗ a=100 ≈ 12 13 when NT = 300. Therefore, as the attackers’ computing resource increases, the successful attack probability and consequently the probability of the cyber-insurer paying the claim increases accordingly. Then, as shown in Fig. 7(f), the cyber-insurer increases the premium to keep its proﬁt unchanged. Ultimately, the cost of the blockchain provider also increases. Moreover, as the attackers’ computing re- source increases, even when the blockchain provider re- duces the price of its service to attract more users, the total demand from the users still decreases (see Figs. 7(c) and (d)). Consequently, this reduces the revenue and proﬁt of the blockchain provider. Furthermore, we show that the impact of the attackers’ computing resource on the other parties in the market is subject to the number of transactions in one block NT. With the ﬁxed transaction fee and compensation rate, the more transactions in a single block is, the more reward that the blockchain provider obtains from mining a block. Moreover, since the compensation price of one block increases as the number of transactions in one block increases, the more compensation it will pay to the users once the attacks happen. Then, the blockchain provider has more incentive to invest in the computing resource. This is consistent with Fig. 7(e), where the increasing rate of the investment by the blockchain provider is higher with NT = 300 than that with NT = 100. On the other hand, as the attacker’s computing resource increases, the increasing rate of the successful attack probability is lower with NT = 300 than that with NT = 100. Consequently, the increasing rate of the premium is lower with NT = 300 than that with NT = 100 (see Fig. 7(f)). Moreover, as NT increases, the increasing rate of the successful attack probability will decrease, and the users’ demand will be less affected. This is consistent with Figs. 7(c) and (d), where the decreasing rates of both the total user demand and the service price shrink as NT increases. 6 CONCLUSION In this paper, we have proposed a risk management frame- work of the blockchain service market by introducing the cyber-insurance as a mean for protecting ﬁnancially the blockchain provider from double-spending attacks. We have modeled the interaction among the blockchain provider, the cyber-insurer and the users in the market as a two-stage Stackelberg game. For the blockchain provider, we have considered the problem of balancing between the proactive protection strategy, i.e., investing in computing power, and the reactive protection strategy, i.e., purchasing the cyber- insurance. For the users, we have considered the impact of both the social externality and the service security on the users’ valuation of the blockchain service. In particu- lar, for the cyber-insurer, we have incorporated the risk- adjusted pricing mechanism for premium adaptation. We have studied the equilibrium strategies of the three parties in the market using backward induction. We have analyti- cally examined the conditions for the Stackelberg game to exist and to be unique. Furthermore, we have conducted extensive simulations to evaluate the performance of the market entities at the equilibrium. For the future work, we will investigate the long-run competition between the blockchain provider and cyber-insurer. 12 REFERENCES [1] D. T. T. Anh, M. Zhang, B. C. Ooi and G. Chen, “Untangling blockchain: A data processing view of blockchain systems,” IEEE Transactions on Knowledge and Data Engineering, vol. PP, no. 99, pp. 1–1, 2018. [2] M. Bartoletti and L. Pompianu, “An empirical analysis of smart contracts: platforms, applications, and design patterns,” arXiv preprint arXiv:1703.06322, 2017. [3] H. Kopp, D. Mdinger, F. Hauck, F. Kargl and C. Bsch, “Design of a privacy-preserving decentralized ﬁle storage with ﬁnancial incentives,” in 2017 IEEE European Symposium on Security and Privacy Workshops (EuroS PW), Paris, France, 2017. [4] K. Toyoda, P. T. Mathiopoulos, I. Sasase and T. Ohtsuki, “A novel blockchain-based product ownership management system (poms) for anti-counterfeits in the post supply chain,” IEEE Access, vol. 5, pp. 17465–17477, 2017. [5] J. Zou, b. ye, L. Qu, Y. Wang, M. A. Orgun and L. Li, “A proof-of-trust consensus protocol for enhancing accountability in crowdsourcing services,” IEEE Transactions on Services Computing, pp. 1–1, 2018. [6] M. Conti, C. Lal, S. Ruj et al., “A survey on security and privacy issues of bitcoin,” arXiv preprint arXiv:1706.00916, 2017. [7] G. O. Karame, E. Androulaki and S. Capkun, “Double-spending fast payments in bitcoin,” in Proceedings of the 2012 ACM Conference on Computer and Communications Security, Raleigh, NC, USA, Oct. 2012, CCS ’12, pp. 906–917, ACM. [8] Z. Li, J. Kang, R. Yu, D. Ye, Q. Deng and Y. Zhang, “Consortium blockchain for secure energy trading in industrial internet of things,” IEEE Transactions on Industrial Informatics, vol. PP, no. 99, pp. 1–1, 2017. [9] X. Huang, C. Xu, P. Wang and H. Liu, “Lnsc: A security model for electric vehicle and charging pile management based on blockchain ecosystem,” IEEE Access, vol. PP, no. 99, pp. 1–1, 2018. [10] K. Kotobi and S. G. Biln, “Blockchain-enabled spectrum access in cognitive radio networks,” in 2017 Wireless Telecommunications Symposium (WTS), April 2017, pp. 1–6. [11] L. Ghiro, L. Maccari and R. L. Cigno, “Proof of networking: Can blockchains boost the next generation of distributed networks?,” in 2018 14th Annual Conference on Wireless On-demand Network Systems and Services (WONS), Feb. 2018, pp. 29–32. [12] W. Wang, D. Niyato, P. Wang and A. Leshem, “Decentralized caching for content delivery based on blockchain: A game theo- retic perspective,” in IEEE ICC 2018 Next Generation Networking and Internet Symposium, Kansas City, USA, May 2018. [13] S. Muhammad, M. Aziz, K. Charles, K. Kevin and N. Laurent, “Countering double spending in next-generation blockchains,” in IEEE ICC 2018, Kansas City, USA, May 2018. [14] R. Pal, L. Golubchik, K. Psounis and P. Hui, “On a way to improve cyber-insurer proﬁts when a security vendor becomes the cyber- insurer,” in IFIP Networking Conference, 2013. IEEE, 2013, pp. 1–9. [15] A. Marotta, F. Martinelli, S. Nanni, A. Orlando and A. Yautsiukhin, “Cyber-insurance survey,” Computer Science Review, vol. 24, pp. 35 – 61, 2017. [16] AWS, “Aws blockchain partners,” https://aws.amazon.com/cn/ partners/blockchain/. [17] X. Gong, L. Duan, X. Chen and J. Zhang, “When social network effect meets congestion effect in wireless networks: Data usage equilibrium and optimal pricing,” IEEE Journal on Selected Areas in Communications, vol. 35, no. 2, pp. 449–462, 2017. [18] Z. Xiong, S. Feng, D. Niyato, P. Wang and Y. Zhang, “Economic analysis of network effects on sponsored content: A hierarchical game theoretic approach,” in 2017 IEEE Global Communications Conference, Singapore, Dec. 2017, pp. 1–6. [19] F. Tschorsch and B. Scheuermann, “Bitcoin and beyond: A techni- cal survey on decentralized digital currencies,” IEEE Communica- tions Surveys Tutorials, vol. 18, no. 3, pp. 2084–2123, third quarter 2016. [20] J. L. Zhao, S. Fan and J. Yan, “Overview of business innovations and research opportunities in blockchain and introduction to the special issue,” Financial Innovation, vol. 2, no. 1, pp. 28, 2016. [21] K. Christidis and M. Devetsikiotis, “Blockchains and smart con- tracts for the internet of things,” IEEE Access, vol. 4, pp. 2292–2303, May 2016. [22] H. Wang, K. Chen and D. Xu, “A maturity model for blockchain adoption,” Financial Innovation, vol. 2, no. 1, pp. 12, 2016. [23] J. Garay, A. Kiayias and N. Leonardos, “The bitcoin backbone protocol: Analysis and applications,” in Advances in Cryptology - EUROCRYPT 2015: 34th Annual International Conference on the Theory and Applications of Cryptographic Techniques, Part II, Soﬁa, Bulgaria, Apr. 2015, pp. 281–310. [24] S. Feng, Z. Xiong, N. Dusit, P. Wang and S. Wang, “Joint pricing and security investment for cloud-insurance: A security interdependency perspective,” in IEEE Wireless Communications and Networking Conference, Barcelona, Spain, Apr. 2018, IEEE. [25] I. Eyal, A. E. Gencer, E. G. Sirer and R. Van Renesse, “Bitcoin-ng: A scalable blockchain protocol.,” in NSDI, 2016, pp. 45–59. [26] M. Rosenfeld, “Analysis of hashrate-based double spending,” arXiv preprint arXiv:1402.2009, 2014. [27] C. Grunspan and R. P´erez-Marco, “Double spend races,” arXiv preprint arXiv:1702.02867, 2017. [28] S. Wang, “Insurance pricing and increased limits ratemaking by proportional hazards transforms,” Insurance: Mathematics and Economics, vol. 17, no. 1, pp. 43–54, 1995. [29] S. Wang, “Premium calculation by transforming the layer pre- mium density,” ASTIN Bulletin: The Journal of the IAA, vol. 26, no. 1, pp. 71–92, 1996. [30] D. Denneberg, “Premium calculation: Why standard deviation should be replaced by absolute deviation,” ASTIN Bulletin: The Journal of the IAA, vol. 20, no. 2, pp. 181–190, 1990. [31] G. O. Karame, E. Androulaki and S. Capkun, “Double-spending fast payments in bitcoin,” in Proceedings of the 2012 ACM conference on Computer and communications security. ACM, 2012, pp. 906–917. [32] S. Nakamoto, “Bitcoin: A peer-to-peer electronic cash system. bitcoin,” 2009. [33] F. Bloch and N. Qu´erou, “Pricing in social networks,” Games and economic behavior, vol. 80, pp. 243–261, 2013. [34] F. Bloch, G. Genicot and D. Ray, “Informal insurance in social networks,” Journal of Economic Theory, vol. 143, no. 1, pp. 36–58, 2008. [35] A. Simsek, A. Ozdaglar and D. Acemoglu, “On the uniqueness of solutions for nonlinear and mixed complementarity problems,” Tech. Rep., Massachusetts Institute of Technology, 2005. [36] A. Berman and R. J. Plemmons, Nonnegative matrices in the mathematical sciences, SIAM, 1994. [37] M. J. Osborne, An introduction to game theory, vol. 3, Oxford university press New York, 2004. [38] G. Scutari, F. Facchinei, J.-S. Pang and D. P. Palomar, “Real and complex monotone communication games,” IEEE Transactions on Information Theory, vol. 60, no. 7, pp. 4197–4231, 2014. [39] R. Zhang, Q. Zhu and Y. Hayel, “A bi-level game approach to attack-aware cyber insurance of computer networks,” IEEE Journal on Selected Areas in Communications, vol. 35, no. 3, pp. 779–794, 2017. [40] G. Debreu, “A social equilibrium existence theorem,” Proceedings of the National Academy of Sciences, vol. 38, no. 10, pp. 886–893, 1952. [41] P. Shi, “Summary of whats known about convergence in concave games,” April 10, 2009. 13 APPENDIX A PROOF OF THEOREM 3 Proof. Substituting the second partial derivatives of ΠP in (25), the Hessian matrix of the blockchain provider’s payoff is HP =   ∂2ΠP ∂p2 ∂2ΠP ∂p∂¯h ∂2ΠP ∂¯h∂p ∂2ΠP ∂¯h2  =   −(I −αG)−1 (I −αG)−11 1⊤(I −αG)−1 − 2a  1 −¯h 3  . (27) We can partition the Hessian matrix in (27) into two matrices as follows: HP =   −(I −αG)−1 (I −αG)−11 1⊤(I −αG)−1 − a  1 −¯h 3   | {z } HP1 + " O 0 0⊤ − a (1−¯h)3 # | {z } HP2 = HP1 + HP2, (28) where HP2 is obviously a negative semideﬁnite matrix. Let QP =  I 1 0⊤ 1  . The congruent matrix of HP1 is: QP⊤HP1QP = " −(I −αG)−1 0 0⊤ − a (1−¯h)3 + 1⊤(I −αG)−11 # . (29) Therefore, the negative deﬁniteness of HP1 depends on the negative deﬁniteness of (29). According to the proof of Theorem 1, all the eigenvalues of (I −αG)−1 belong to (0, 1). This means that −(I −αG)−1 in (29) is a negative deﬁnite matrix. We know that the domain of ¯h is  1 2 , 1 , and the inequality equation in (30) will be satisﬁed. − a  1 −¯h 3 + 1⊤(I −αG)−11 < − a  1 −1 2 3 + 1⊤(I −αG)−11 = −8a + 1⊤(I −αG)−11. (30) −8a + 1⊤(I −αG)−11 < 0 is satisﬁed according to Theo- rem 3 and hence the second block in (29), i.e., − a (1−¯h)3 + 1⊤(I −αG)−11, is also negative. With the two negative def- inite blocks on the diagonal positions and zero blocks on the off-diagonal positions, the matrix in (29) is a negative deﬁnite matrix. Therefore, HP1 is a negative deﬁnite matrix. Then, as the sum of one negative deﬁnite matrix and one negative semideﬁnite matrix, i.e., HP1 and HP2, respectively, the Hessian matrix HP in (27) is a negative deﬁnite matrix. Therefore, ΠP is a strictly concave function of  p⊤, ¯h ⊤. In what follows, we prove that ΠI is also a concave function of its own decision variable γ. Recall the second partial derivative of ΠI on γ in (25) as follows: ∂2ΠI ∂γ2 = 2 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt + 1 γ4 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln2 " 1 − Z t 1/2 P (θ) dθ # dt −  h −1 2 3 h β (β + 1) γβ−1 −β (β −1) γβ−2i = 1 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ | {z } >0 ln " 1 − Z t 1/2 P (θ) dθ # | {z } <0 dt + 1 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ | {z } >0 ln " 1 − Z t 1/2 P (θ) dθ # | {z } <0 × ( 1 + 1 γ ln " 1 − Z t 1/2 P (θ) dθ #) dt −  h −1 2 3 | {z } >0 [(β + 1) γ −(β −1)] | {z } >0 βγβ−2. (31) To ensure the concavity of ΠI with respect to γ, we need the following inequality to be satisﬁed: ( 1 + 1 γ ln " 1 − Z t 1/2 P (θ) dθ #) ≥0. (32) From (32), we have ( 1 + 1 γ ln " 1 − Z t 1/2 P (θ) dθ #) ≥0 ⇔1 γ ln " 1 − Z t 1/2 P (θ) dθ # ≥−1 ⇔1 γ ln " 1 − Z t 1/2 P (θ) dθ # ≥1 γ ln "Z 1 0 P (θ) dθ − Z 1 1/2 P (θ) dθ # ≥−1 ⇒1 γ ln "Z 1/2 0 P (θ) dθ # ≥−1 ⇔1 γ ln 1 2 ≥−1 ⇔γ ≥ln 2 (33) From (33) we learn that the sufﬁcient condition to ensure the inequality in (32) is γ ≥ln 2. Such a condition holds on (1, γu]. Therefore, ΠI is a concave function on γ. Then, the proﬁt functions of the blockchain provider and the cyber-insurer, i.e., ΠP and ΠI, are concave with respect to their own de- cision variables, i.e.,  p⊤, ¯h ⊤and γ, respectively. According to [40], the NE in the leader-level game GL exists hence the Stackbelberg equilibrium exists. The proof is completed. APPENDIX B PROOF OF THEOREM 4 Proof. According to Theorem 3.1 (Rosen’s Theorem) in [41], the uniqueness of the NE in GL holds if the Jacobian matrix constructed from the proﬁt functions of the two players, i.e., J given in (34), is negative deﬁnite. After substituting the relevant second partial derivatives given in (25) into (34), we are able to rewrite (34) as in (35). Then, we partition the Jacobian matrix (34) into two matrices as shown in (36). In J1 given by (36), we have " −2(I −αG)−1 2(I −αG)−11 21⊤(I −αG)−1 − 2a (1−¯h)3 # = 2HP1, where HP1 is the 14 J =   ∂2Πp ∂p2 ∂2Πp ∂p∂¯h ∂2Πp ∂p∂γ ∂2Πp ∂¯h∂p ∂2Πp ∂¯h2 ∂2Πp ∂¯h∂γ ∂2ΠI ∂γ∂p ∂2ΠI ∂γ∂¯h ∂2ΠI ∂γ2   +   ∂2Πp ∂p2 ∂2Πp ∂p∂¯h ∂2Πp ∂p∂γ ∂2Πp ∂¯h∂p ∂2Πp ∂¯h2 ∂2Πp ∂¯h∂γ ∂2ΠI ∂γ∂p ∂2ΠI ∂γ∂¯h ∂2ΠI ∂γ2   ⊤ =   2 ∂2Πp ∂p2 ∂2Πp ∂p∂¯h +  ∂2Πp ∂¯h∂p ⊤ ∂2Πp ∂p∂γ +  ∂2ΠI ∂γ∂p ⊤ ∂2Πp ∂¯h∂p +  ∂2Πp ∂p∂¯h ⊤ 2 ∂2Πp ∂¯h2 ∂2Πp ∂¯h∂γ + ∂2ΠI ∂γ∂¯h ∂2ΠI ∂γ∂p +  ∂2Πp ∂p∂¯h ⊤ ∂2ΠI ∂γ∂¯h + ∂2Πp ∂¯h∂γ 2 ∂2ΠI ∂γ2   (34) =   −2(I −αG)−1 2(I −αG)−11 0 21⊤(I −αG)−1 − 4a (1−¯h)3 −3  h −1 2 2 × h (β + 1) γβ −βγβ−1i 0⊤ −3  h −1 2 2 × h (β + 1) γβ −βγβ−1i 4 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt + 2 γ4 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt −2  h −1 2 3 h β (β + 1) γβ−1 −β (β −1) γβ−2i   . (35) J =   −2(I −αG)−1 2(I −αG)−11 0 21⊤(I −αG)−1 − 2a (1−¯h) 3 0 0⊤ 0 4 γ3 T T0 NTq Z 1 1/2  1 − Z t 1/2 P (θ) dθ 1/γ ln  1 − Z t 1/2 P (θ) dθ  dt + 2 γ4 T T0 NTq Z 1 1/2  1 − Z t 1/2 P (θ) dθ 1/γ ln  1 − Z t 1/2 P (θ) dθ  dt   | {z } J1 +   O 0 0 0⊤ − 2a (1−¯h)3 −3  h −1 2 2 × h (β + 1) γβ −βγβ−1i 0⊤ −3  h −1 2 2 × h (β + 1) γβ −βγβ−1i −2  h −1 2 3  β (β + 1) γβ−1 −β (β −1) γβ−2   | {z } J2 . (36) R1J2R1⊤=   O 0 0 0⊤ − 2a  1 −¯h 3 + 9  h −1 2 4 (β + 1) γβ −βγβ−12 2  h −1 2 3  β (β + 1) γβ−1 −β (β −1) γβ−2 0 0⊤ 0 −2  h −1 2 3 [(β + 1) γ −(β −1)] βγβ−2   . (37) matrix in (28). As shown in the proof to Theorem 3, HP1 is a negative deﬁnite matrix, and thus the ﬁrst block in the matrix J1 of (36), i.e., " −2(I −αG)−1 2(I −αG)−11 21⊤(I −αG)−1 − 2a (1−¯h)3 # , is a negative deﬁnite matrix. For the second non-zero block in J1, the condition to ensure negative deﬁniteness is 0 > 4 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt + 2 γ4 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln2 " 1 − Z t 1/2 P (θ) dθ # dt = 2 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ ln " 1 − Z t 1/2 P (θ) dθ # dt + 2 γ3 T T0 NTq Z 1 1/2 " 1 − Z t 1/2 P (θ) dθ #1/γ × ln " 1 − Z t 1/2 P (θ) dθ # ( 1 + 1 γ " 1 − Z t 1/2 P (θ) dθ #) dt. (38) 15 Following the same procedure in the proof to Theorem 3, from (38) we obtain the condition of negative deﬁniteness as γ ≥ln 2. Therefore, with the two negative deﬁnite blocks on the diagonal positions and all-zero blocks on the off- diagonal positions, J1 in (36) is a negative deﬁnite matrix. After deﬁning R1 =   I 0 0 0⊤ 1 −3  h −1 2 2 h (β + 1) γβ −βγβ−1i × ( −2  h −1 2 3)−1 × h β (β + 1) γβ−1 −β (β −1) γβ−2i−1 0⊤ 0 1   , (39) we can obtain the congruent matrix of J2 in (36) as shown in (37). In (37), we observe that −2  h −1 2 3 [(β + 1) γ −(β −1)] βγβ−2 < 0. Then, to ensure the negative semideﬁniteness of J2, we need the following inequality to hold: − 2a  1 −¯h 3 + 9  h −1 2 4 (β + 1) γβ −βγβ−12 2  h −1 2 3  β (β + 1) γβ−1 −β (β −1) γβ−2 ≤0. (40) Then, we can determine the upper bound for (40) as follows: − 2a  1 −¯h 3 + 9  ¯h −1 2 4 (β + 1) γβ −βγβ−12 2  ¯h −1 2 3  β (β + 1) γβ−1 −β (β −1) γβ−2 = − 2a  1 −¯h 3 + 9  ¯h −1 2  [(β + 1) γ −β]2γβ 2 [β (β + 1) γ −β (β −1)] < − 2a  1 −¯h 3 + 9  ¯h −1 2  (β + 1)2γβ+2 2 [β (β + 1) γ −β (β −1)] < − 2a  1 −¯h 3 + 9  ¯h −1 2  (β + 1)2γβ+2 2 [β (β + 1) γ −β (β −1) γ] = − 2a  1 −¯h 3 + 9  ¯h −1 2  (β + 1)2γβ+2 2βγ (β + 1 −β + 1) = − 2a  1 −¯h 3 + 9  ¯h −1 2  (β + 1)2γβ+1 4β (41) Since ¯h ∈  1 2 , 1 , the last equation in (41), i.e., − 2a (1−¯h)3 + 9(¯h−1 2)(β+1)2γβ+1 4β , is smaller than − 2a (1−1 2)3 + 9(1−1 2)(β+1)2γβ+1 4β = −16a + 9(β+1)2(γu)β+1 8β . −16a + 9(β+1)2(γu)β+1 8β < 0 is satisﬁed according to Theorem 4 and hence the matrix in (37) has zero and negative deﬁnite blocks on its diagonal positions and zero blocks on the off-diagonal positions. This means that the matrix (37) is a negative semi-deﬁnite matrix. Since J2 is congruent with the matrix (37), J2 is also a negative semideﬁnite matrix. To summarize, as the sum of a negative deﬁnite matrix J1 and a negative semideﬁnite matrix J2, the Jacobian matrix in (34), i.e., J, is a negative deﬁnite matrix. Thus, the NE in the leader-level noncooperative subgame GL is unique and the Stackbelberg equilibrium is unique. The proof is completed.